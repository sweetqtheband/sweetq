(self.webpackChunksweetq=self.webpackChunksweetq||[]).push([[279],{3713:(ne,yt,z)=>{"use strict";z.d(yt,{Z:()=>G,y:()=>X});var K=z(8274),ct=z(1481);let X=(()=>{const S=class{constructor(m){this.sanitizer=m}transform(m){return this.sanitizer.bypassSecurityTrustResourceUrl(m)}};let D=S;return S.\u0275fac=function(J){return new(J||S)(K.Y36(ct.H7,16))},S.\u0275pipe=K.Yjl({name:"safe",type:S,pure:!0}),D})(),G=(()=>{const S=class{};let D=S;return S.\u0275fac=function(J){return new(J||S)},S.\u0275mod=K.oAB({type:S}),S.\u0275inj=K.cJS({}),D})()},9698:(ne,yt,z)=>{"use strict";z.d(yt,{Z:()=>K});const K={listen:{hash:"U2FsdGVkX18u3a/kwz5awtnhPAK/z0ffjH31VzXrQOYmB/kw6lVtSUuplRUUMstq",chunk1:"U2FsdGVkX1+9PAAaso9C5apmE+AfyGuysske2FIMV/B7SL6ILzDNLLSnyAwtkAdM",chunk2:"U2FsdGVkX1+J/c0NjDeWmLHLQjMlxTyH6tt2+3NI9rI=",artistId:"74Vs2gSCwnlCiV4yjaFIMb",trackId:"4N8LvpnnHhwwBJ5xobXYvr"},track:{ley:"U2FsdGVkX19Sb1m01jh3uhEUh58HS9Ao9%2Fpjod4uEvE%3D",fiesta:"U2FsdGVkX1%2FrKv2bU9NnftdBaRRbRmgMxCD0ezKQV8w%3D",yaesnavidad:"U2FsdGVkX1%2FwRkUZ922wbzCat2AjSUbyMnw195dLZWg%3D"},spotify:{clientId:"MDExNzEzNDkwZDY4NGYyNmFmOWRhYjRiNzc4OWI1YzU=",clientSecret:"OTc5YTM2NTZiNWJmNGY0OGIzNzA2ZDA2OGM2OTY3NTU=",nextRelease:null},appleMusic:{nextRealease:null}}},5072:(ne,yt,z)=>{"use strict";z.d(yt,{s:()=>Jr});var K=z(5861),ct=z(529),X=z(9698),G=z(3172);const D=typeof globalThis<"u"?globalThis:typeof self<"u"?self:typeof window<"u"?window:global,S=Object.keys,$=Array.isArray;function m(e,t){return"object"!=typeof t||S(t).forEach(function(n){e[n]=t[n]}),e}typeof Promise>"u"||D.Promise||(D.Promise=Promise);const J=Object.getPrototypeOf,Q={}.hasOwnProperty;function q(e,t){return Q.call(e,t)}function lt(e,t){"function"==typeof t&&(t=t(J(e))),(typeof Reflect>"u"?S:Reflect.ownKeys)(t).forEach(n=>{M(e,n,t[n])})}const N=Object.defineProperty;function M(e,t,n,i){N(e,t,m(n&&q(n,"get")&&"function"==typeof n.get?{get:n.get,set:n.set,configurable:!0}:{value:n,configurable:!0,writable:!0},i))}function Y(e){return{from:function(t){return e.prototype=Object.create(t.prototype),M(e.prototype,"constructor",e),{extend:lt.bind(null,e.prototype)}}}}const ht=Object.getOwnPropertyDescriptor;function mt(e,t){let n;return ht(e,t)||(n=J(e))&&mt(n,t)}const st=[].slice;function dt(e,t,n){return st.call(e,t,n)}function Ct(e,t){return t(e)}function ft(e){if(!e)throw new Error("Assertion Failed")}function Pt(e){D.setImmediate?setImmediate(e):setTimeout(e,0)}function fe(e,t){return e.reduce((n,i,s)=>{var u=t(i,s);return u&&(n[u[0]]=u[1]),n},{})}function Ft(e,t){if("string"==typeof t&&q(e,t))return e[t];if(!t)return e;if("string"!=typeof t){for(var n=[],i=0,s=t.length;i<s;++i){var u=Ft(e,t[i]);n.push(u)}return n}var c=t.indexOf(".");if(-1!==c){var f=e[t.substr(0,c)];return null==f?void 0:Ft(f,t.substr(c+1))}}function Bt(e,t,n){if(e&&void 0!==t&&(!("isFrozen"in Object)||!Object.isFrozen(e)))if("string"!=typeof t&&"length"in t){ft("string"!=typeof n&&"length"in n);for(var i=0,s=t.length;i<s;++i)Bt(e,t[i],n[i])}else{var u=t.indexOf(".");if(-1!==u){var c=t.substr(0,u),f=t.substr(u+1);if(""===f)void 0===n?$(e)&&!isNaN(parseInt(c))?e.splice(c,1):delete e[c]:e[c]=n;else{var h=e[c];h&&q(e,c)||(h=e[c]={}),Bt(h,f,n)}}else void 0===n?$(e)&&!isNaN(parseInt(t))?e.splice(t,1):delete e[t]:e[t]=n}}function Oe(e){var t={};for(var n in e)q(e,n)&&(t[n]=e[n]);return t}const on=[].concat;function De(e){return on.apply([],e)}const Ke="BigUint64Array,BigInt64Array,Array,Boolean,String,Date,RegExp,Blob,File,FileList,FileSystemFileHandle,FileSystemDirectoryHandle,ArrayBuffer,DataView,Uint8ClampedArray,ImageBitmap,ImageData,Map,Set,CryptoKey".split(",").concat(De([8,16,32,64].map(e=>["Int","Uint","Float"].map(t=>t+e+"Array")))).filter(e=>D[e]),sn=Ke.map(e=>D[e]);fe(Ke,e=>[e,!0]);let St=null;function Nt(e){St=typeof WeakMap<"u"&&new WeakMap;const t=de(e);return St=null,t}function de(e){if(!e||"object"!=typeof e)return e;let t=St&&St.get(e);if(t)return t;if($(e)){t=[],St&&St.set(e,t);for(var n=0,i=e.length;n<i;++n)t.push(de(e[n]))}else if(sn.indexOf(e.constructor)>=0)t=e;else{const u=J(e);for(var s in t=u===Object.prototype?{}:Object.create(u),St&&St.set(e,t),e)q(e,s)&&(t[s]=de(e[s]))}return t}const{toString:an}={};function pe(e){return an.call(e).slice(8,-1)}const ye=typeof Symbol<"u"?Symbol.iterator:"@@iterator",un="symbol"==typeof ye?function(e){var t;return null!=e&&(t=e[ye])&&t.apply(e)}:function(){return null},rt={};function it(e){var t,n,i,s;if(1===arguments.length){if($(e))return e.slice();if(this===rt&&"string"==typeof e)return[e];if(s=un(e)){for(n=[];!(i=s.next()).done;)n.push(i.value);return n}if(null==e)return[e];if("number"==typeof(t=e.length)){for(n=new Array(t);t--;)n[t]=e[t];return n}return[e]}for(t=arguments.length,n=new Array(t);t--;)n[t]=arguments[t];return n}const re=typeof Symbol<"u"?e=>"AsyncFunction"===e[Symbol.toStringTag]:()=>!1;var kt=typeof location<"u"&&/^(http|https):\/\/(localhost|127\.0\.0\.1)/.test(location.href);function me(e,t){kt=e,ge=t}var ge=()=>!0;const Ue=!new Error("").stack;function xt(){if(Ue)try{throw new Error}catch(e){return e}return new Error}function Vt(e,t){var n=e.stack;return n?(t=t||0,0===n.indexOf(e.name)&&(t+=(e.name+e.message).split("\n").length),n.split("\n").slice(t).filter(ge).map(i=>"\n"+i).join("")):""}var we=["Unknown","Constraint","Data","TransactionInactive","ReadOnly","Version","NotFound","InvalidState","InvalidAccess","Abort","Timeout","QuotaExceeded","Syntax","DataClone"],be=["Modify","Bulk","OpenFailed","VersionChange","Schema","Upgrade","InvalidTable","MissingAPI","NoSuchDatabase","InvalidArgument","SubTransaction","Unsupported","Internal","DatabaseClosed","PrematureCommit","ForeignAwait"].concat(we),je={VersionChanged:"Database version changed by other database connection",DatabaseClosed:"Database has been closed",Abort:"Transaction aborted",TransactionInactive:"Transaction has already completed or failed",MissingAPI:"IndexedDB API missing. Please visit https://tinyurl.com/y2uuvskb"};function It(e,t){this._e=xt(),this.name=e,this.message=t}function Mt(e,t){return e+". Errors: "+Object.keys(t).map(n=>t[n].toString()).filter((n,i,s)=>s.indexOf(n)===i).join("\n")}function ie(e,t,n,i){this._e=xt(),this.failures=t,this.failedKeys=i,this.successCount=n,this.message=Mt(e,t)}function Gt(e,t){this._e=xt(),this.name="BulkError",this.failures=Object.keys(t).map(n=>t[n]),this.failuresByPos=t,this.message=Mt(e,t)}Y(It).from(Error).extend({stack:{get:function(){return this._stack||(this._stack=this.name+": "+this.message+Vt(this._e,2))}},toString:function(){return this.name+": "+this.message}}),Y(ie).from(It),Y(Gt).from(It);var Yt=be.reduce((e,t)=>(e[t]=t+"Error",e),{});const cn=It;var j=be.reduce((e,t)=>{var n=t+"Error";function i(s,u){this._e=xt(),this.name=n,s?"string"==typeof s?(this.message=`${s}${u?"\n "+u:""}`,this.inner=u||null):"object"==typeof s&&(this.message=`${s.name} ${s.message}`,this.inner=s):(this.message=je[t]||n,this.inner=null)}return Y(i).from(cn),e[t]=i,e},{});j.Syntax=SyntaxError,j.Type=TypeError,j.Range=RangeError;var ve=we.reduce((e,t)=>(e[t+"Error"]=j[t],e),{}),Tt=be.reduce((e,t)=>(-1===["Syntax","Type","Range"].indexOf(t)&&(e[t+"Error"]=j[t]),e),{});function W(){}function Ot(e){return e}function ln(e,t){return null==e||e===Ot?t:function(n){return t(e(n))}}function gt(e,t){return function(){e.apply(this,arguments),t.apply(this,arguments)}}function hn(e,t){return e===W?t:function(){var n=e.apply(this,arguments);void 0!==n&&(arguments[0]=n);var i=this.onsuccess,s=this.onerror;this.onsuccess=null,this.onerror=null;var u=t.apply(this,arguments);return i&&(this.onsuccess=this.onsuccess?gt(i,this.onsuccess):i),s&&(this.onerror=this.onerror?gt(s,this.onerror):s),void 0!==u?u:n}}function a(e,t){return e===W?t:function(){e.apply(this,arguments);var n=this.onsuccess,i=this.onerror;this.onsuccess=this.onerror=null,t.apply(this,arguments),n&&(this.onsuccess=this.onsuccess?gt(n,this.onsuccess):n),i&&(this.onerror=this.onerror?gt(i,this.onerror):i)}}function r(e,t){return e===W?t:function(n){var i=e.apply(this,arguments);m(n,i);var s=this.onsuccess,u=this.onerror;this.onsuccess=null,this.onerror=null;var c=t.apply(this,arguments);return s&&(this.onsuccess=this.onsuccess?gt(s,this.onsuccess):s),u&&(this.onerror=this.onerror?gt(u,this.onerror):u),void 0===i?void 0===c?void 0:c:m(i,c)}}function o(e,t){return e===W?t:function(){return!1!==t.apply(this,arguments)&&e.apply(this,arguments)}}function l(e,t){return e===W?t:function(){var n=e.apply(this,arguments);if(n&&"function"==typeof n.then){for(var i=this,s=arguments.length,u=new Array(s);s--;)u[s]=arguments[s];return n.then(function(){return t.apply(i,u)})}return t.apply(this,arguments)}}Tt.ModifyError=ie,Tt.DexieError=It,Tt.BulkError=Gt;var d={};const b=100,[x,L,nt]=typeof Promise>"u"?[]:(()=>{let e=Promise.resolve();if(typeof crypto>"u"||!crypto.subtle)return[e,J(e),e];const t=crypto.subtle.digest("SHA-512",new Uint8Array([0]));return[t,J(t),e]})(),tt=L&&L.then,et=x&&x.constructor,H=!!nt;var fn=!1,_r=nt?()=>{nt.then(Le)}:D.setImmediate?setImmediate.bind(null,Le):D.MutationObserver?()=>{var e=document.createElement("div");new MutationObserver(()=>{Le(),e=null}).observe(e,{attributes:!0}),e.setAttribute("i","1")}:()=>{setTimeout(Le,0)},_e=function(e,t){xe.push([e,t]),Ne&&(_r(),Ne=!1)},dn=!0,Ne=!0,Ht=[],Me=[],pn=null,yn=Ot,oe={id:"global",global:!0,ref:0,unhandleds:[],onunhandled:er,pgp:!1,env:{},finalize:function(){this.unhandleds.forEach(e=>{try{er(e[0],e[1])}catch{}})}},U=oe,xe=[],Zt=0,$e=[];function R(e){if("object"!=typeof this)throw new TypeError("Promises must be constructed via new");this._listeners=[],this.onuncatched=W,this._lib=!1;var t=this._PSD=U;if(kt&&(this._stackHolder=xt(),this._prev=null,this._numPrev=0),"function"!=typeof e){if(e!==d)throw new TypeError("Not a function");return this._state=arguments[1],this._value=arguments[2],void(!1===this._state&&gn(this,this._value))}this._state=null,this._value=null,++t.ref,Gn(this,e)}const mn={get:function(){var e=U,t=ze;function n(i,s){var u=!e.global&&(e!==U||t!==ze);const c=u&&!Dt();var f=new R((h,g)=>{wn(this,new Vn(Ge(i,e,u,c),Ge(s,e,u,c),h,g,e))});return kt&&Zn(f,this),f}return n.prototype=d,n},set:function(e){M(this,"then",e&&e.prototype===d?mn:{get:function(){return e},set:mn.set})}};function Vn(e,t,n,i,s){this.onFulfilled="function"==typeof e?e:null,this.onRejected="function"==typeof t?t:null,this.resolve=n,this.reject=i,this.psd=s}function Gn(e,t){try{t(n=>{if(null===e._state){if(n===e)throw new TypeError("A promise cannot be resolved with itself.");var i=e._lib&&Ee();n&&"function"==typeof n.then?Gn(e,(s,u)=>{n instanceof R?n._then(s,u):n.then(s,u)}):(e._state=!0,e._value=n,Yn(e)),i&&Be()}},gn.bind(null,e))}catch(n){gn(e,n)}}function gn(e,t){if(Me.push(t),null===e._state){var n=e._lib&&Ee();t=yn(t),e._state=!1,e._value=t,kt&&null!==t&&"object"==typeof t&&!t._promise&&function(i,s,u){try{(()=>{var i=mt(t,"stack");t._promise=e,M(t,"stack",{get:()=>fn?i&&(i.get?i.get.apply(t):i.value):e.stack})}).apply(null,void 0)}catch(c){}}(),i=e,Ht.some(s=>s._value===i._value)||Ht.push(i),Yn(e),n&&Be()}var i}function Yn(e){var t=e._listeners;e._listeners=[];for(var n=0,i=t.length;n<i;++n)wn(e,t[n]);var s=e._PSD;--s.ref||s.finalize(),0===Zt&&(++Zt,_e(()=>{0==--Zt&&bn()},[]))}function wn(e,t){if(null!==e._state){var n=e._state?t.onFulfilled:t.onRejected;if(null===n)return(e._state?t.resolve:t.reject)(e._value);++t.psd.ref,++Zt,_e(xr,[n,e,t])}else e._listeners.push(t)}function xr(e,t,n){try{pn=t;var i,s=t._value;t._state?i=e(s):(Me.length&&(Me=[]),i=e(s),-1===Me.indexOf(s)&&function(u){for(var c=Ht.length;c;)if(Ht[--c]._value===u._value)return void Ht.splice(c,1)}(t)),n.resolve(i)}catch(u){n.reject(u)}finally{pn=null,0==--Zt&&bn(),--n.psd.ref||n.psd.finalize()}}function Hn(e,t,n){if(t.length===n)return t;var i="";if(!1===e._state){var s,u,c=e._value;null!=c?(s=c.name||"Error",u=c.message||c,i=Vt(c,0)):(s=c,u=""),t.push(s+(u?": "+u:"")+i)}return kt&&((i=Vt(e._stackHolder,2))&&-1===t.indexOf(i)&&t.push(i),e._prev&&Hn(e._prev,t,n)),t}function Zn(e,t){var n=t?t._numPrev+1:0;n<100&&(e._prev=t,e._numPrev=n)}function Le(){Ee()&&Be()}function Ee(){var e=dn;return dn=!1,Ne=!1,e}function Be(){var e,t,n;do{for(;xe.length>0;)for(e=xe,xe=[],n=e.length,t=0;t<n;++t){var i=e[t];i[0].apply(null,i[1])}}while(xe.length>0);dn=!0,Ne=!0}function bn(){var e=Ht;Ht=[],e.forEach(i=>{i._PSD.onunhandled.call(null,i._value,i)});for(var t=$e.slice(0),n=t.length;n;)t[--n]()}function qe(e){return new R(d,!1,e)}function ot(e,t){var n=U;return function(){var i=Ee(),s=U;try{return Lt(n,!0),e.apply(this,arguments)}catch(u){t&&t(u)}finally{Lt(s,!1),i&&Be()}}}lt(R.prototype,{then:mn,_then:function(e,t){wn(this,new Vn(null,null,e,t,U))},catch:function(e){if(1===arguments.length)return this.then(null,e);var t=arguments[0],n=arguments[1];return this.then(null,"function"==typeof t?i=>i instanceof t?n(i):qe(i):i=>i&&i.name===t?n(i):qe(i))},finally:function(e){return this.then(t=>(e(),t),t=>(e(),qe(t)))},stack:{get:function(){if(this._stack)return this._stack;try{fn=!0;var e=Hn(this,[],20).join("\nFrom previous: ");return null!==this._state&&(this._stack=e),e}finally{fn=!1}}},timeout:function(e,t){return e<1/0?new R((n,i)=>{var s=setTimeout(()=>i(new j.Timeout(t)),e);this.then(n,i).finally(clearTimeout.bind(null,s))}):this}}),typeof Symbol<"u"&&Symbol.toStringTag&&M(R.prototype,Symbol.toStringTag,"Dexie.Promise"),oe.env=Xn(),lt(R,{all:function(){var e=it.apply(null,arguments).map(Ve);return new R(function(t,n){0===e.length&&t([]);var i=e.length;e.forEach((s,u)=>R.resolve(s).then(c=>{e[u]=c,--i||t(e)},n))})},resolve:e=>{if(e instanceof R)return e;if(e&&"function"==typeof e.then)return new R((n,i)=>{e.then(n,i)});var t=new R(d,!0,e);return Zn(t,pn),t},reject:qe,race:function(){var e=it.apply(null,arguments).map(Ve);return new R((t,n)=>{e.map(i=>R.resolve(i).then(t,n))})},PSD:{get:()=>U,set:e=>U=e},totalEchoes:{get:()=>ze},newPSD:$t,usePSD:ae,scheduler:{get:()=>_e,set:e=>{_e=e}},rejectionMapper:{get:()=>yn,set:e=>{yn=e}},follow:(e,t)=>new R((n,i)=>$t((s,u)=>{var c=U;c.unhandleds=[],c.onunhandled=u,c.finalize=gt(function(){var f;f=()=>{0===this.unhandleds.length?s():u(this.unhandleds[0])},$e.push(function h(){f(),$e.splice($e.indexOf(h),1)}),++Zt,_e(()=>{0==--Zt&&bn()},[])},c.finalize),e()},t,n,i))}),et&&(et.allSettled&&M(R,"allSettled",function(){const e=it.apply(null,arguments).map(Ve);return new R(t=>{0===e.length&&t([]);let n=e.length;const i=new Array(n);e.forEach((s,u)=>R.resolve(s).then(c=>i[u]={status:"fulfilled",value:c},c=>i[u]={status:"rejected",reason:c}).then(()=>--n||t(i)))})}),et.any&&typeof AggregateError<"u"&&M(R,"any",function(){const e=it.apply(null,arguments).map(Ve);return new R((t,n)=>{0===e.length&&n(new AggregateError([]));let i=e.length;const s=new Array(i);e.forEach((u,c)=>R.resolve(u).then(f=>t(f),f=>{s[c]=f,--i||n(new AggregateError(s))}))})}));const wt={awaits:0,echoes:0,id:0};var Er=0,We=[],vn=0,ze=0,Br=0;function $t(e,t,n,i){var s=U,u=Object.create(s);u.parent=s,u.ref=0,u.global=!1,u.id=++Br;var c=oe.env;u.env=H?{Promise:R,PromiseProp:{value:R,configurable:!0,writable:!0},all:R.all,race:R.race,allSettled:R.allSettled,any:R.any,resolve:R.resolve,reject:R.reject,nthen:Qn(c.nthen,u),gthen:Qn(c.gthen,u)}:{},t&&m(u,t),++s.ref,u.finalize=function(){--this.parent.ref||this.parent.finalize()};var f=ae(u,e,n,i);return 0===u.ref&&u.finalize(),f}function se(){return wt.id||(wt.id=++Er),++wt.awaits,wt.echoes+=b,wt.id}function Dt(){return!!wt.awaits&&(0==--wt.awaits&&(wt.id=0),wt.echoes=wt.awaits*b,!0)}function Ve(e){return wt.echoes&&e&&e.constructor===et?(se(),e.then(t=>(Dt(),t),t=>(Dt(),pt(t)))):e}function kr(e){++ze,wt.echoes&&0!=--wt.echoes||(wt.echoes=wt.id=0),We.push(U),Lt(e,!0)}function Ir(){var e=We[We.length-1];We.pop(),Lt(e,!1)}function Lt(e,t){var n=U;if((t?!wt.echoes||vn++&&e===U:!vn||--vn&&e===U)||Jn(t?kr.bind(null,e):Ir),e!==U&&(U=e,n===oe&&(oe.env=Xn()),H)){var i=oe.env.Promise,s=e.env;L.then=s.nthen,i.prototype.then=s.gthen,(n.global||e.global)&&(Object.defineProperty(D,"Promise",s.PromiseProp),i.all=s.all,i.race=s.race,i.resolve=s.resolve,i.reject=s.reject,s.allSettled&&(i.allSettled=s.allSettled),s.any&&(i.any=s.any))}}function Xn(){var e=D.Promise;return H?{Promise:e,PromiseProp:Object.getOwnPropertyDescriptor(D,"Promise"),all:e.all,race:e.race,allSettled:e.allSettled,any:e.any,resolve:e.resolve,reject:e.reject,nthen:L.then,gthen:e.prototype.then}:{}}function ae(e,t,n,i,s){var u=U;try{return Lt(e,!0),t(n,i,s)}finally{Lt(u,!1)}}function Jn(e){tt.call(x,e)}function Ge(e,t,n,i){return"function"!=typeof e?e:function(){var s=U;n&&se(),Lt(t,!0);try{return e.apply(this,arguments)}finally{Lt(s,!1),i&&Jn(Dt)}}}function Qn(e,t){return function(n,i){return e.call(this,Ge(n,t),Ge(i,t))}}-1===(""+tt).indexOf("[native code]")&&(se=Dt=W);const tr="unhandledrejection";function er(e,t){var n;try{n=t.onuncatched(e)}catch{}if(!1!==n)try{var i,s={promise:t,reason:e};if(D.document&&document.createEvent?((i=document.createEvent("Event")).initEvent(tr,!0,!0),m(i,s)):D.CustomEvent&&m(i=new CustomEvent(tr,{detail:s}),s),i&&D.dispatchEvent&&(dispatchEvent(i),!D.PromiseRejectionEvent&&D.onunhandledrejection))try{D.onunhandledrejection(i)}catch{}kt&&i&&!i.defaultPrevented&&console.warn(`Unhandled rejection: ${e.stack||e}`)}catch{}}var pt=R.reject;function _n(e,t,n,i){if(e.idbdb&&(e._state.openComplete||U.letThrough||e._vip)){var s=e._createTransaction(t,n,e._dbSchema);try{s.create(),e._state.PR1398_maxLoop=3}catch(u){return u.name===Yt.InvalidState&&e.isOpen()&&--e._state.PR1398_maxLoop>0?(console.warn("Dexie: Need to reopen db"),e._close(),e.open().then(()=>_n(e,t,n,i))):pt(u)}return s._promise(t,(u,c)=>$t(()=>(U.trans=s,i(u,c,s)))).then(u=>s._completion.then(()=>u))}if(e._state.openComplete)return pt(new j.DatabaseClosed(e._state.dbOpenError));if(!e._state.isBeingOpened){if(!e._options.autoOpen)return pt(new j.DatabaseClosed);e.open().catch(W)}return e._state.dbReadyPromise.then(()=>_n(e,t,n,i))}const Xt=String.fromCharCode(65535),xn=-1/0,Kt="Invalid key provided. Keys must be of type string, number, Date or Array<string | number | Date>.",rr="String expected.",ke=[],Ye=typeof navigator<"u"&&/(MSIE|Trident|Edge)/.test(navigator.userAgent),Ar=Ye,Fr=Ye,ir=e=>!/(dexie\.js|dexie\.min\.js)/.test(e),He="__dbnames",En="readonly",Bn="readwrite";function Jt(e,t){return e?t?function(){return e.apply(this,arguments)&&t.apply(this,arguments)}:e:t}const or={type:3,lower:-1/0,lowerOpen:!1,upper:[[]],upperOpen:!1};function Ze(e){return"string"!=typeof e||/\./.test(e)?t=>t:t=>(void 0===t[e]&&e in t&&delete(t=Nt(t))[e],t)}class Cr{_trans(t,n,i){const s=this._tx||U.trans,u=this.name;function c(h,g,p){if(!p.schema[u])throw new j.NotFound("Table "+u+" not part of transaction");return n(p.idbtrans,p)}const f=Ee();try{return s&&s.db===this.db?s===U.trans?s._promise(t,c,i):$t(()=>s._promise(t,c,i),{trans:s,transless:U.transless||U}):_n(this.db,t,[this.name],c)}finally{f&&Be()}}get(t,n){return t&&t.constructor===Object?this.where(t).first(n):this._trans("readonly",i=>this.core.get({trans:i,key:t}).then(s=>this.hook.reading.fire(s))).then(n)}where(t){if("string"==typeof t)return new this.db.WhereClause(this,t);if($(t))return new this.db.WhereClause(this,`[${t.join("+")}]`);const n=S(t);if(1===n.length)return this.where(n[0]).equals(t[n[0]]);const i=this.schema.indexes.concat(this.schema.primKey).filter(g=>{if(g.compound&&n.every(p=>g.keyPath.indexOf(p)>=0)){for(let p=0;p<n.length;++p)if(-1===n.indexOf(g.keyPath[p]))return!1;return!0}return!1}).sort((g,p)=>g.keyPath.length-p.keyPath.length)[0];if(i&&this.db._maxKey!==Xt){const g=i.keyPath.slice(0,n.length);return this.where(g).equals(g.map(p=>t[p]))}!i&&kt&&console.warn(`The query ${JSON.stringify(t)} on ${this.name} would benefit of a compound index [${n.join("+")}]`);const{idxByName:s}=this.schema,u=this.db._deps.indexedDB;function c(g,p){try{return 0===u.cmp(g,p)}catch{return!1}}const[f,h]=n.reduce(([g,p],w)=>{const y=s[w],_=t[w];return[g||y,g||!y?Jt(p,y&&y.multi?k=>{const B=Ft(k,w);return $(B)&&B.some(I=>c(_,I))}:k=>c(_,Ft(k,w))):p]},[null,null]);return f?this.where(f.name).equals(t[f.keyPath]).filter(h):i?this.filter(h):this.where(n).equals("")}filter(t){return this.toCollection().and(t)}count(t){return this.toCollection().count(t)}offset(t){return this.toCollection().offset(t)}limit(t){return this.toCollection().limit(t)}each(t){return this.toCollection().each(t)}toArray(t){return this.toCollection().toArray(t)}toCollection(){return new this.db.Collection(new this.db.WhereClause(this))}orderBy(t){return new this.db.Collection(new this.db.WhereClause(this,$(t)?`[${t.join("+")}]`:t))}reverse(){return this.toCollection().reverse()}mapToClass(t){this.schema.mappedClass=t;const n=i=>{if(!i)return i;const s=Object.create(t.prototype);for(var u in i)if(q(i,u))try{s[u]=i[u]}catch{}return s};return this.schema.readHook&&this.hook.reading.unsubscribe(this.schema.readHook),this.schema.readHook=n,this.hook("reading",n),t}defineClass(){return this.mapToClass(function(t){m(this,t)})}add(t,n){const{auto:i,keyPath:s}=this.schema.primKey;let u=t;return s&&i&&(u=Ze(s)(t)),this._trans("readwrite",c=>this.core.mutate({trans:c,type:"add",keys:null!=n?[n]:null,values:[u]})).then(c=>c.numFailures?R.reject(c.failures[0]):c.lastResult).then(c=>{if(s)try{Bt(t,s,c)}catch{}return c})}update(t,n){if("object"!=typeof t||$(t))return this.where(":id").equals(t).modify(n);{const i=Ft(t,this.schema.primKey.keyPath);if(void 0===i)return pt(new j.InvalidArgument("Given object does not contain its primary key"));try{"function"!=typeof n?S(n).forEach(s=>{Bt(t,s,n[s])}):n(t,{value:t,primKey:i})}catch{}return this.where(":id").equals(i).modify(n)}}put(t,n){const{auto:i,keyPath:s}=this.schema.primKey;let u=t;return s&&i&&(u=Ze(s)(t)),this._trans("readwrite",c=>this.core.mutate({trans:c,type:"put",values:[u],keys:null!=n?[n]:null})).then(c=>c.numFailures?R.reject(c.failures[0]):c.lastResult).then(c=>{if(s)try{Bt(t,s,c)}catch{}return c})}delete(t){return this._trans("readwrite",n=>this.core.mutate({trans:n,type:"delete",keys:[t]})).then(n=>n.numFailures?R.reject(n.failures[0]):void 0)}clear(){return this._trans("readwrite",t=>this.core.mutate({trans:t,type:"deleteRange",range:or})).then(t=>t.numFailures?R.reject(t.failures[0]):void 0)}bulkGet(t){return this._trans("readonly",n=>this.core.getMany({keys:t,trans:n}).then(i=>i.map(s=>this.hook.reading.fire(s))))}bulkAdd(t,n,i){const s=Array.isArray(n)?n:void 0,u=(i=i||(s?void 0:n))?i.allKeys:void 0;return this._trans("readwrite",c=>{const{auto:f,keyPath:h}=this.schema.primKey;if(h&&s)throw new j.InvalidArgument("bulkAdd(): keys argument invalid on tables with inbound keys");if(s&&s.length!==t.length)throw new j.InvalidArgument("Arguments objects and keys must have the same length");const g=t.length;let p=h&&f?t.map(Ze(h)):t;return this.core.mutate({trans:c,type:"add",keys:s,values:p,wantResults:u}).then(({numFailures:w,results:y,lastResult:_,failures:k})=>{if(0===w)return u?y:_;throw new Gt(`${this.name}.bulkAdd(): ${w} of ${g} operations failed`,k)})})}bulkPut(t,n,i){const s=Array.isArray(n)?n:void 0,u=(i=i||(s?void 0:n))?i.allKeys:void 0;return this._trans("readwrite",c=>{const{auto:f,keyPath:h}=this.schema.primKey;if(h&&s)throw new j.InvalidArgument("bulkPut(): keys argument invalid on tables with inbound keys");if(s&&s.length!==t.length)throw new j.InvalidArgument("Arguments objects and keys must have the same length");const g=t.length;let p=h&&f?t.map(Ze(h)):t;return this.core.mutate({trans:c,type:"put",keys:s,values:p,wantResults:u}).then(({numFailures:w,results:y,lastResult:_,failures:k})=>{if(0===w)return u?y:_;throw new Gt(`${this.name}.bulkPut(): ${w} of ${g} operations failed`,k)})})}bulkDelete(t){const n=t.length;return this._trans("readwrite",i=>this.core.mutate({trans:i,type:"delete",keys:t})).then(({numFailures:i,lastResult:s,failures:u})=>{if(0===i)return s;throw new Gt(`${this.name}.bulkDelete(): ${i} of ${n} operations failed`,u)})}}function Ie(e){var t={},n=function(c,f){if(f){for(var h=arguments.length,g=new Array(h-1);--h;)g[h-1]=arguments[h];return t[c].subscribe.apply(null,g),e}if("string"==typeof c)return t[c]};n.addEventType=u;for(var i=1,s=arguments.length;i<s;++i)u(arguments[i]);return n;function u(c,f,h){if("object"!=typeof c){var g;f||(f=o),h||(h=W);var p={subscribers:[],fire:h,subscribe:function(w){-1===p.subscribers.indexOf(w)&&(p.subscribers.push(w),p.fire=f(p.fire,w))},unsubscribe:function(w){p.subscribers=p.subscribers.filter(function(y){return y!==w}),p.fire=p.subscribers.reduce(f,h)}};return t[c]=n[c]=p,p}S(g=c).forEach(function(w){var y=g[w];if($(y))u(w,g[w][0],g[w][1]);else{if("asap"!==y)throw new j.InvalidArgument("Invalid event config");var _=u(w,Ot,function(){for(var k=arguments.length,B=new Array(k);k--;)B[k]=arguments[k];_.subscribers.forEach(function(I){Pt(function(){I.apply(null,B)})})})}})}}function Ae(e,t){return Y(t).from({prototype:e}),t}function ue(e,t){return!(e.filter||e.algorithm||e.or)&&(t?e.justLimit:!e.replayFilter)}function kn(e,t){e.filter=Jt(e.filter,t)}function In(e,t,n){var i=e.replayFilter;e.replayFilter=i?()=>Jt(i(),t()):t,e.justLimit=n&&!i}function Xe(e,t){if(e.isPrimKey)return t.primaryKey;const n=t.getIndexByKeyPath(e.index);if(!n)throw new j.Schema("KeyPath "+e.index+" on object store "+t.name+" is not indexed");return n}function sr(e,t,n){const i=Xe(e,t.schema);return t.openCursor({trans:n,values:!e.keysOnly,reverse:"prev"===e.dir,unique:!!e.unique,query:{index:i,range:e.range}})}function Je(e,t,n,i){const s=e.replayFilter?Jt(e.filter,e.replayFilter()):e.filter;if(e.or){const u={},c=(f,h,g)=>{if(!s||s(h,g,y=>h.stop(y),y=>h.fail(y))){var p=h.primaryKey,w=""+p;"[object ArrayBuffer]"===w&&(w=""+new Uint8Array(p)),q(u,w)||(u[w]=!0,t(f,h,g))}};return Promise.all([e.or._iterate(c,n),ar(sr(e,i,n),e.algorithm,c,!e.keysOnly&&e.valueMapper)])}return ar(sr(e,i,n),Jt(e.algorithm,s),t,!e.keysOnly&&e.valueMapper)}function ar(e,t,n,i){var s=ot(i?(u,c,f)=>n(i(u),c,f):n);return e.then(u=>{if(u)return u.start(()=>{var c=()=>u.continue();t&&!t(u,f=>c=f,f=>{u.stop(f),c=W},f=>{u.fail(f),c=W})||s(u.value,u,f=>c=f),c()})})}function vt(e,t){try{const n=ur(e),i=ur(t);if(n!==i)return"Array"===n?1:"Array"===i?-1:"binary"===n?1:"binary"===i?-1:"string"===n?1:"string"===i?-1:"Date"===n?1:"Date"!==i?NaN:-1;switch(n){case"number":case"Date":case"string":return e>t?1:e<t?-1:0;case"binary":return function(s,u){const c=s.length,f=u.length,h=c<f?c:f;for(let g=0;g<h;++g)if(s[g]!==u[g])return s[g]<u[g]?-1:1;return c===f?0:c<f?-1:1}(cr(e),cr(t));case"Array":return function(s,u){const c=s.length,f=u.length,h=c<f?c:f;for(let g=0;g<h;++g){const p=vt(s[g],u[g]);if(0!==p)return p}return c===f?0:c<f?-1:1}(e,t)}}catch{}return NaN}function ur(e){const t=typeof e;if("object"!==t)return t;if(ArrayBuffer.isView(e))return"binary";const n=pe(e);return"ArrayBuffer"===n?"binary":n}function cr(e){return e instanceof Uint8Array?e:ArrayBuffer.isView(e)?new Uint8Array(e.buffer,e.byteOffset,e.byteLength):new Uint8Array(e)}class Sr{_read(t,n){var i=this._ctx;return i.error?i.table._trans(null,pt.bind(null,i.error)):i.table._trans("readonly",t).then(n)}_write(t){var n=this._ctx;return n.error?n.table._trans(null,pt.bind(null,n.error)):n.table._trans("readwrite",t,"locked")}_addAlgorithm(t){var n=this._ctx;n.algorithm=Jt(n.algorithm,t)}_iterate(t,n){return Je(this._ctx,t,n,this._ctx.table.core)}clone(t){var n=Object.create(this.constructor.prototype),i=Object.create(this._ctx);return t&&m(i,t),n._ctx=i,n}raw(){return this._ctx.valueMapper=null,this}each(t){var n=this._ctx;return this._read(i=>Je(n,t,i,n.table.core))}count(t){return this._read(n=>{const i=this._ctx,s=i.table.core;if(ue(i,!0))return s.count({trans:n,query:{index:Xe(i,s.schema),range:i.range}}).then(c=>Math.min(c,i.limit));var u=0;return Je(i,()=>(++u,!1),n,s).then(()=>u)}).then(t)}sortBy(t,n){const i=t.split(".").reverse(),s=i[0],u=i.length-1;function c(g,p){return p?c(g[i[p]],p-1):g[s]}var f="next"===this._ctx.dir?1:-1;function h(g,p){var w=c(g,u),y=c(p,u);return w<y?-f:w>y?f:0}return this.toArray(function(g){return g.sort(h)}).then(n)}toArray(t){return this._read(n=>{var i=this._ctx;if("next"===i.dir&&ue(i,!0)&&i.limit>0){const{valueMapper:s}=i,u=Xe(i,i.table.core.schema);return i.table.core.query({trans:n,limit:i.limit,values:!0,query:{index:u,range:i.range}}).then(({result:c})=>s?c.map(s):c)}{const s=[];return Je(i,u=>s.push(u),n,i.table.core).then(()=>s)}},t)}offset(t){var n=this._ctx;return t<=0||(n.offset+=t,ue(n)?In(n,()=>{var i=t;return(s,u)=>0===i||(1===i?(--i,!1):(u(()=>{s.advance(i),i=0}),!1))}):In(n,()=>{var i=t;return()=>--i<0})),this}limit(t){return this._ctx.limit=Math.min(this._ctx.limit,t),In(this._ctx,()=>{var n=t;return function(i,s,u){return--n<=0&&s(u),n>=0}},!0),this}until(t,n){return kn(this._ctx,function(i,s,u){return!t(i.value)||(s(u),n)}),this}first(t){return this.limit(1).toArray(function(n){return n[0]}).then(t)}last(t){return this.reverse().first(t)}filter(t){var n;return kn(this._ctx,function(s){return t(s.value)}),(n=this._ctx).isMatch=Jt(n.isMatch,t),this}and(t){return this.filter(t)}or(t){return new this.db.WhereClause(this._ctx.table,t,this)}reverse(){return this._ctx.dir="prev"===this._ctx.dir?"next":"prev",this._ondirectionchange&&this._ondirectionchange(this._ctx.dir),this}desc(){return this.reverse()}eachKey(t){var n=this._ctx;return n.keysOnly=!n.isMatch,this.each(function(i,s){t(s.key,s)})}eachUniqueKey(t){return this._ctx.unique="unique",this.eachKey(t)}eachPrimaryKey(t){var n=this._ctx;return n.keysOnly=!n.isMatch,this.each(function(i,s){t(s.primaryKey,s)})}keys(t){var n=this._ctx;n.keysOnly=!n.isMatch;var i=[];return this.each(function(s,u){i.push(u.key)}).then(function(){return i}).then(t)}primaryKeys(t){var n=this._ctx;if("next"===n.dir&&ue(n,!0)&&n.limit>0)return this._read(s=>{var u=Xe(n,n.table.core.schema);return n.table.core.query({trans:s,values:!1,limit:n.limit,query:{index:u,range:n.range}})}).then(({result:s})=>s).then(t);n.keysOnly=!n.isMatch;var i=[];return this.each(function(s,u){i.push(u.primaryKey)}).then(function(){return i}).then(t)}uniqueKeys(t){return this._ctx.unique="unique",this.keys(t)}firstKey(t){return this.limit(1).keys(function(n){return n[0]}).then(t)}lastKey(t){return this.reverse().firstKey(t)}distinct(){var t=this._ctx,n=t.index&&t.table.schema.idxByName[t.index];if(!n||!n.multi)return this;var i={};return kn(this._ctx,function(s){var u=s.primaryKey.toString(),c=q(i,u);return i[u]=!0,!c}),this}modify(t){var n=this._ctx;return this._write(i=>{var s;if("function"==typeof t)s=t;else{var u=S(t),c=u.length;s=function(B){for(var I=!1,E=0;E<c;++E){var v=u[E],F=t[v];Ft(B,v)!==F&&(Bt(B,v,F),I=!0)}return I}}const f=n.table.core,{outbound:h,extractKey:g}=f.schema.primaryKey,p=this.db._options.modifyChunkSize||200,w=[];let y=0;const _=[],k=(B,I)=>{const{failures:E,numFailures:v}=I;y+=B-v;for(let F of S(E))w.push(E[F])};return this.clone().primaryKeys().then(B=>{const I=E=>{const v=Math.min(p,B.length-E);return f.getMany({trans:i,keys:B.slice(E,E+v),cache:"immutable"}).then(F=>{const T=[],O=[],P=h?[]:null,A=[];for(let C=0;C<v;++C){const at=F[C],Z={value:Nt(at),primKey:B[E+C]};!1!==s.call(Z,Z.value,Z)&&(null==Z.value?A.push(B[E+C]):h||0===vt(g(at),g(Z.value))?(O.push(Z.value),h&&P.push(B[E+C])):(A.push(B[E+C]),T.push(Z.value)))}const V=ue(n)&&n.limit===1/0&&("function"!=typeof t||t===An)&&{index:n.index,range:n.range};return Promise.resolve(T.length>0&&f.mutate({trans:i,type:"add",values:T}).then(C=>{for(let at in C.failures)A.splice(parseInt(at),1);k(T.length,C)})).then(()=>(O.length>0||V&&"object"==typeof t)&&f.mutate({trans:i,type:"put",keys:P,values:O,criteria:V,changeSpec:"function"!=typeof t&&t}).then(C=>k(O.length,C))).then(()=>(A.length>0||V&&t===An)&&f.mutate({trans:i,type:"delete",keys:A,criteria:V}).then(C=>k(A.length,C))).then(()=>B.length>E+v&&I(E+p))})};return I(0).then(()=>{if(w.length>0)throw new ie("Error modifying one or more objects",w,y,_);return B.length})})})}delete(){var t=this._ctx,n=t.range;return ue(t)&&(t.isPrimKey&&!Fr||3===n.type)?this._write(i=>{const{primaryKey:s}=t.table.core.schema,u=n;return t.table.core.count({trans:i,query:{index:s,range:u}}).then(c=>t.table.core.mutate({trans:i,type:"deleteRange",range:u}).then(({failures:f,numFailures:p})=>{if(p)throw new ie("Could not delete some values",Object.keys(f).map(w=>f[w]),c-p);return c-p}))}):this.modify(An)}}const An=(e,t)=>t.value=null;function Pr(e,t){return e<t?-1:e===t?0:1}function Rr(e,t){return e>t?-1:e===t?0:1}function At(e,t,n){var i=e instanceof hr?new e.Collection(e):e;return i._ctx.error=n?new n(t):new TypeError(t),i}function ce(e){return new e.Collection(e,()=>lr("")).limit(0)}function Tr(e,t,n,i,s,u){for(var c=Math.min(e.length,i.length),f=-1,h=0;h<c;++h){var g=t[h];if(g!==i[h])return s(e[h],n[h])<0?e.substr(0,h)+n[h]+n.substr(h+1):s(e[h],i[h])<0?e.substr(0,h)+i[h]+n.substr(h+1):f>=0?e.substr(0,f)+t[f]+n.substr(f+1):null;s(e[h],g)<0&&(f=h)}return c<i.length&&"next"===u?e+n.substr(e.length):c<e.length&&"prev"===u?e.substr(0,n.length):f<0?null:e.substr(0,f)+i[f]+n.substr(f+1)}function Qe(e,t,n,i){var s,u,c,f,h,g,p,w=n.length;if(!n.every(B=>"string"==typeof B))return At(e,rr);function y(B){s="next"===B?v=>v.toUpperCase():v=>v.toLowerCase(),u="next"===B?v=>v.toLowerCase():v=>v.toUpperCase(),c="next"===B?Pr:Rr;var I=n.map(function(E){return{lower:u(E),upper:s(E)}}).sort(function(E,v){return c(E.lower,v.lower)});f=I.map(function(E){return E.upper}),h=I.map(function(E){return E.lower}),g=B,p="next"===B?"":i}y("next");var _=new e.Collection(e,()=>qt(f[0],h[w-1]+i));_._ondirectionchange=function(B){y(B)};var k=0;return _._addAlgorithm(function(B,I,E){var v=B.key;if("string"!=typeof v)return!1;var F=u(v);if(t(F,h,k))return!0;for(var T=null,O=k;O<w;++O){var P=Tr(v,F,f[O],h[O],c,g);null===P&&null===T?k=O+1:(null===T||c(T,P)>0)&&(T=P)}return I(null!==T?function(){B.continue(T+p)}:E),!1}),_}function qt(e,t,n,i){return{type:2,lower:e,upper:t,lowerOpen:n,upperOpen:i}}function lr(e){return{type:1,lower:e,upper:e}}class hr{get Collection(){return this._ctx.table.db.Collection}between(t,n,i,s){i=!1!==i,s=!0===s;try{return this._cmp(t,n)>0||0===this._cmp(t,n)&&(i||s)&&(!i||!s)?ce(this):new this.Collection(this,()=>qt(t,n,!i,!s))}catch{return At(this,Kt)}}equals(t){return null==t?At(this,Kt):new this.Collection(this,()=>lr(t))}above(t){return null==t?At(this,Kt):new this.Collection(this,()=>qt(t,void 0,!0))}aboveOrEqual(t){return null==t?At(this,Kt):new this.Collection(this,()=>qt(t,void 0,!1))}below(t){return null==t?At(this,Kt):new this.Collection(this,()=>qt(void 0,t,!1,!0))}belowOrEqual(t){return null==t?At(this,Kt):new this.Collection(this,()=>qt(void 0,t))}startsWith(t){return"string"!=typeof t?At(this,rr):this.between(t,t+Xt,!0,!0)}startsWithIgnoreCase(t){return""===t?this.startsWith(t):Qe(this,(n,i)=>0===n.indexOf(i[0]),[t],Xt)}equalsIgnoreCase(t){return Qe(this,(n,i)=>n===i[0],[t],"")}anyOfIgnoreCase(){var t=it.apply(rt,arguments);return 0===t.length?ce(this):Qe(this,(n,i)=>-1!==i.indexOf(n),t,"")}startsWithAnyOfIgnoreCase(){var t=it.apply(rt,arguments);return 0===t.length?ce(this):Qe(this,(n,i)=>i.some(s=>0===n.indexOf(s)),t,Xt)}anyOf(){const t=it.apply(rt,arguments);let n=this._cmp;try{t.sort(n)}catch{return At(this,Kt)}if(0===t.length)return ce(this);const i=new this.Collection(this,()=>qt(t[0],t[t.length-1]));i._ondirectionchange=u=>{n="next"===u?this._ascending:this._descending,t.sort(n)};let s=0;return i._addAlgorithm((u,c,f)=>{const h=u.key;for(;n(h,t[s])>0;)if(++s,s===t.length)return c(f),!1;return 0===n(h,t[s])||(c(()=>{u.continue(t[s])}),!1)}),i}notEqual(t){return this.inAnyRange([[xn,t],[t,this.db._maxKey]],{includeLowers:!1,includeUppers:!1})}noneOf(){const t=it.apply(rt,arguments);if(0===t.length)return new this.Collection(this);try{t.sort(this._ascending)}catch{return At(this,Kt)}const n=t.reduce((i,s)=>i?i.concat([[i[i.length-1][1],s]]):[[xn,s]],null);return n.push([t[t.length-1],this.db._maxKey]),this.inAnyRange(n,{includeLowers:!1,includeUppers:!1})}inAnyRange(t,n){const i=this._cmp,s=this._ascending,u=this._descending,c=this._min,f=this._max;if(0===t.length)return ce(this);if(!t.every(v=>void 0!==v[0]&&void 0!==v[1]&&s(v[0],v[1])<=0))return At(this,"First argument to inAnyRange() must be an Array of two-value Arrays [lower,upper] where upper must not be lower than lower",j.InvalidArgument);const h=!n||!1!==n.includeLowers,g=n&&!0===n.includeUppers;let p,w=s;function y(v,F){return w(v[0],F[0])}try{p=t.reduce(function(v,F){let T=0,O=v.length;for(;T<O;++T){const P=v[T];if(i(F[0],P[1])<0&&i(F[1],P[0])>0){P[0]=c(P[0],F[0]),P[1]=f(P[1],F[1]);break}}return T===O&&v.push(F),v},[]),p.sort(y)}catch{return At(this,Kt)}let _=0;const k=g?v=>s(v,p[_][1])>0:v=>s(v,p[_][1])>=0,B=h?v=>u(v,p[_][0])>0:v=>u(v,p[_][0])>=0;let I=k;const E=new this.Collection(this,()=>qt(p[0][0],p[p.length-1][1],!h,!g));return E._ondirectionchange=v=>{"next"===v?(I=k,w=s):(I=B,w=u),p.sort(y)},E._addAlgorithm((v,F,T)=>{for(var O=v.key;I(O);)if(++_,_===p.length)return F(T),!1;return!((k(P=O)||B(P))&&(0===this._cmp(O,p[_][1])||0===this._cmp(O,p[_][0])||F(()=>{v.continue(w===s?p[_][0]:p[_][1])}),1));var P}),E}startsWithAnyOf(){const t=it.apply(rt,arguments);return t.every(n=>"string"==typeof n)?0===t.length?ce(this):this.inAnyRange(t.map(n=>[n,n+Xt])):At(this,"startsWithAnyOf() only works with strings")}}function Rt(e){return ot(function(t){return Fe(t),e(t.target.error),!1})}function Fe(e){e.stopPropagation&&e.stopPropagation(),e.preventDefault&&e.preventDefault()}const Ce="storagemutated",Wt="x-storagemutated-1",zt=Ie(null,Ce);class Or{_lock(){return ft(!U.global),++this._reculock,1!==this._reculock||U.global||(U.lockOwnerFor=this),this}_unlock(){if(ft(!U.global),0==--this._reculock)for(U.global||(U.lockOwnerFor=null);this._blockedFuncs.length>0&&!this._locked();){var t=this._blockedFuncs.shift();try{ae(t[1],t[0])}catch{}}return this}_locked(){return this._reculock&&U.lockOwnerFor!==this}create(t){if(!this.mode)return this;const n=this.db.idbdb,i=this.db._state.dbOpenError;if(ft(!this.idbtrans),!t&&!n)switch(i&&i.name){case"DatabaseClosedError":throw new j.DatabaseClosed(i);case"MissingAPIError":throw new j.MissingAPI(i.message,i);default:throw new j.OpenFailed(i)}if(!this.active)throw new j.TransactionInactive;return ft(null===this._completion._state),(t=this.idbtrans=t||(this.db.core?this.db.core.transaction(this.storeNames,this.mode,{durability:this.chromeTransactionDurability}):n.transaction(this.storeNames,this.mode,{durability:this.chromeTransactionDurability}))).onerror=ot(s=>{Fe(s),this._reject(t.error)}),t.onabort=ot(s=>{Fe(s),this.active&&this._reject(new j.Abort(t.error)),this.active=!1,this.on("abort").fire(s)}),t.oncomplete=ot(()=>{this.active=!1,this._resolve(),"mutatedParts"in t&&zt.storagemutated.fire(t.mutatedParts)}),this}_promise(t,n,i){if("readwrite"===t&&"readwrite"!==this.mode)return pt(new j.ReadOnly("Transaction is readonly"));if(!this.active)return pt(new j.TransactionInactive);if(this._locked())return new R((u,c)=>{this._blockedFuncs.push([()=>{this._promise(t,n,i).then(u,c)},U])});if(i)return $t(()=>{var u=new R((c,f)=>{this._lock();const h=n(c,f,this);h&&h.then&&h.then(c,f)});return u.finally(()=>this._unlock()),u._lib=!0,u});var s=new R((u,c)=>{var f=n(u,c,this);f&&f.then&&f.then(u,c)});return s._lib=!0,s}_root(){return this.parent?this.parent._root():this}waitFor(t){var n=this._root();const i=R.resolve(t);if(n._waitingFor)n._waitingFor=n._waitingFor.then(()=>i);else{n._waitingFor=i,n._waitingQueue=[];var s=n.idbtrans.objectStore(n.storeNames[0]);!function c(){for(++n._spinCount;n._waitingQueue.length;)n._waitingQueue.shift()();n._waitingFor&&(s.get(-1/0).onsuccess=c)}()}var u=n._waitingFor;return new R((c,f)=>{i.then(h=>n._waitingQueue.push(ot(c.bind(null,h))),h=>n._waitingQueue.push(ot(f.bind(null,h)))).finally(()=>{n._waitingFor===u&&(n._waitingFor=null)})})}abort(){this.active&&(this.active=!1,this.idbtrans&&this.idbtrans.abort(),this._reject(new j.Abort))}table(t){const n=this._memoizedTables||(this._memoizedTables={});if(q(n,t))return n[t];const i=this.schema[t];if(!i)throw new j.NotFound("Table "+t+" not part of transaction");const s=new this.db.Table(t,i,this);return s.core=this.db.core.table(t),n[t]=s,s}}function Fn(e,t,n,i,s,u,c){return{name:e,keyPath:t,unique:n,multi:i,auto:s,compound:u,src:(n&&!c?"&":"")+(i?"*":"")+(s?"++":"")+fr(t)}}function fr(e){return"string"==typeof e?e:e?"["+[].join.call(e,"+")+"]":""}function dr(e,t,n){return{name:e,primKey:t,indexes:n,mappedClass:null,idxByName:fe(n,i=>[i.name,i])}}let Se=e=>{try{return e.only([[]]),Se=()=>[[]],[[]]}catch{return Se=()=>Xt,Xt}};function Cn(e){return null==e?()=>{}:"string"==typeof e?1===(t=e).split(".").length?i=>i[t]:i=>Ft(i,t):t=>Ft(t,e);var t}function pr(e){return[].slice.call(e)}let Dr=0;function Pe(e){return null==e?":id":"string"==typeof e?e:`[${e.join("+")}]`}function Kr(e,t,n){function i(h){if(3===h.type)return null;if(4===h.type)throw new Error("Cannot convert never type to IDBKeyRange");const{lower:g,upper:p,lowerOpen:w,upperOpen:y}=h;return void 0===g?void 0===p?null:t.upperBound(p,!!y):void 0===p?t.lowerBound(g,!!w):t.bound(g,p,!!w,!!y)}const{schema:s,hasGetAll:u}=function(h,g){const p=pr(h.objectStoreNames);return{schema:{name:h.name,tables:p.map(w=>g.objectStore(w)).map(w=>{const{keyPath:y,autoIncrement:_}=w,k=$(y),I={},E={name:w.name,primaryKey:{name:null,isPrimaryKey:!0,outbound:null==y,compound:k,keyPath:y,autoIncrement:_,unique:!0,extractKey:Cn(y)},indexes:pr(w.indexNames).map(v=>w.index(v)).map(v=>{const{name:F,unique:T,multiEntry:O,keyPath:P}=v,A={name:F,compound:$(P),keyPath:P,unique:T,multiEntry:O,extractKey:Cn(P)};return I[Pe(P)]=A,A}),getIndexByKeyPath:v=>I[Pe(v)]};return I[":id"]=E.primaryKey,null!=y&&(I[Pe(y)]=E.primaryKey),E})},hasGetAll:p.length>0&&"getAll"in g.objectStore(p[0])&&!(typeof navigator<"u"&&/Safari/.test(navigator.userAgent)&&!/(Chrome\/|Edge\/)/.test(navigator.userAgent)&&[].concat(navigator.userAgent.match(/Safari\/(\d*)/))[1]<604)}}(e,n),c=s.tables.map(h=>function(g){const p=g.name;return{name:p,schema:g,mutate:function({trans:w,type:y,keys:_,values:k,range:B}){return new Promise((I,E)=>{I=ot(I);const v=w.objectStore(p),F=null==v.keyPath,T="put"===y||"add"===y;if(!T&&"delete"!==y&&"deleteRange"!==y)throw new Error("Invalid operation type: "+y);const{length:O}=_||k||{length:1};if(_&&k&&_.length!==k.length)throw new Error("Given keys array must have same length as given values array.");if(0===O)return I({numFailures:0,failures:{},results:[],lastResult:void 0});let P;const A=[],V=[];let C=0;const at=_t=>{++C,Fe(_t)};if("deleteRange"===y){if(4===B.type)return I({numFailures:C,failures:V,results:[],lastResult:void 0});A.push(P=3===B.type?v.clear():v.delete(i(B)))}else{const[_t,bt]=T?F?[k,_]:[k,null]:[_,null];if(T)for(let ut=0;ut<O;++ut)A.push(P=bt&&void 0!==bt[ut]?v[y](_t[ut],bt[ut]):v[y](_t[ut])),P.onerror=at;else for(let ut=0;ut<O;++ut)A.push(P=v[y](_t[ut])),P.onerror=at}const Z=_t=>{const bt=_t.target.result;A.forEach((ut,le)=>null!=ut.error&&(V[le]=ut.error)),I({numFailures:C,failures:V,results:"delete"===y?_:A.map(ut=>ut.result),lastResult:bt})};P.onerror=_t=>{at(_t),Z(_t)},P.onsuccess=Z})},getMany:({trans:w,keys:y})=>new Promise((_,k)=>{_=ot(_);const B=w.objectStore(p),I=y.length,E=new Array(I);let v,F=0,T=0;const O=A=>{const V=A.target;E[V._pos]=V.result,++T===F&&_(E)},P=Rt(k);for(let A=0;A<I;++A)null!=y[A]&&(v=B.get(y[A]),v._pos=A,v.onsuccess=O,v.onerror=P,++F);0===F&&_(E)}),get:({trans:w,key:y})=>new Promise((_,k)=>{_=ot(_);const B=w.objectStore(p).get(y);B.onsuccess=I=>_(I.target.result),B.onerror=Rt(k)}),query:(w=u,y=>new Promise((_,k)=>{_=ot(_);const{trans:B,values:I,limit:E,query:v}=y,F=E===1/0?void 0:E,{index:T,range:O}=v,P=B.objectStore(p),A=T.isPrimaryKey?P:P.index(T.name),V=i(O);if(0===E)return _({result:[]});if(w){const C=I?A.getAll(V,F):A.getAllKeys(V,F);C.onsuccess=at=>_({result:at.target.result}),C.onerror=Rt(k)}else{let C=0;const at=I||!("openKeyCursor"in A)?A.openCursor(V):A.openKeyCursor(V),Z=[];at.onsuccess=_t=>{const bt=at.result;return bt?(Z.push(I?bt.value:bt.primaryKey),++C===E?_({result:Z}):void bt.continue()):_({result:Z})},at.onerror=Rt(k)}})),openCursor:function({trans:w,values:y,query:_,reverse:k,unique:B}){return new Promise((I,E)=>{I=ot(I);const{index:v,range:F}=_,T=w.objectStore(p),O=v.isPrimaryKey?T:T.index(v.name),P=k?B?"prevunique":"prev":B?"nextunique":"next",A=y||!("openKeyCursor"in O)?O.openCursor(i(F),P):O.openKeyCursor(i(F),P);A.onerror=Rt(E),A.onsuccess=ot(V=>{const C=A.result;if(!C)return void I(null);C.___id=++Dr,C.done=!1;const at=C.continue.bind(C);let Z=C.continuePrimaryKey;Z&&(Z=Z.bind(C));const _t=C.advance.bind(C),bt=()=>{throw new Error("Cursor not stopped")};C.trans=w,C.stop=C.continue=C.continuePrimaryKey=C.advance=()=>{throw new Error("Cursor not started")},C.fail=ot(E),C.next=function(){let ut=1;return this.start(()=>ut--?this.continue():this.stop()).then(()=>this)},C.start=ut=>{const le=new Promise((Et,ee)=>{Et=ot(Et),A.onerror=Rt(ee),C.fail=ee,C.stop=Te=>{C.stop=C.continue=C.continuePrimaryKey=C.advance=bt,Et(Te)}}),he=()=>{if(A.result)try{ut()}catch(Et){C.fail(Et)}else C.done=!0,C.start=()=>{throw new Error("Cursor behind last entry")},C.stop()};return A.onsuccess=ot(Et=>{A.onsuccess=he,he()}),C.continue=at,C.continuePrimaryKey=Z,C.advance=_t,he(),le},I(C)},E)})},count({query:w,trans:y}){const{index:_,range:k}=w;return new Promise((B,I)=>{const E=y.objectStore(p),v=_.isPrimaryKey?E:E.index(_.name),F=i(k),T=F?v.count(F):v.count();T.onsuccess=ot(O=>B(O.target.result)),T.onerror=Rt(I)})}};var w}(h)),f={};return c.forEach(h=>f[h.name]=h),{stack:"dbcore",transaction:e.transaction.bind(e),table(h){if(!f[h])throw new Error(`Table '${h}' not found`);return f[h]},MIN_KEY:-1/0,MAX_KEY:Se(t),schema:s}}function Sn({_novip:e},t){const i=function(s,u,{IDBKeyRange:c},h){return{dbcore:(p=Kr(u,c,h),w=s.dbcore,w.reduce((y,{create:_})=>({...y,..._(y)}),p))};var p,w}(e._middlewares,t.db,e._deps,t);e.core=i.dbcore,e.tables.forEach(s=>{const u=s.name;e.core.schema.tables.some(c=>c.name===u)&&(s.core=e.core.table(u),e[u]instanceof e.Table&&(e[u].core=s.core))})}function tn({_novip:e},t,n,i){n.forEach(s=>{const u=i[s];t.forEach(c=>{const f=mt(c,s);(!f||"value"in f&&void 0===f.value)&&(c===e.Transaction.prototype||c instanceof e.Transaction?M(c,s,{get(){return this.table(s)},set(h){N(this,s,{value:h,writable:!0,configurable:!0,enumerable:!0})}}):c[s]=new e.Table(s,u))})})}function Pn({_novip:e},t){t.forEach(n=>{for(let i in n)n[i]instanceof e.Table&&delete n[i]})}function Ur(e,t){return e._cfg.version-t._cfg.version}function yr(e,t){const n={del:[],add:[],change:[]};let i;for(i in e)t[i]||n.del.push(i);for(i in t){const s=e[i],u=t[i];if(s){const c={name:i,def:u,recreate:!1,del:[],add:[],change:[]};if(""+(s.primKey.keyPath||"")!=""+(u.primKey.keyPath||"")||s.primKey.auto!==u.primKey.auto&&!Ye)c.recreate=!0,n.change.push(c);else{const f=s.idxByName,h=u.idxByName;let g;for(g in f)h[g]||c.del.push(g);for(g in h){const p=f[g],w=h[g];p?p.src!==w.src&&c.change.push(w):c.add.push(w)}(c.del.length>0||c.add.length>0||c.change.length>0)&&n.change.push(c)}}else n.add.push([i,u])}return n}function Rn(e,t,n,i){const s=e.db.createObjectStore(t,n.keyPath?{keyPath:n.keyPath,autoIncrement:n.auto}:{autoIncrement:n.auto});return i.forEach(u=>Tn(s,u)),s}function Tn(e,t){e.createIndex(t.name,t.keyPath,{unique:t.unique,multiEntry:t.multi})}function On(e,t,n){const i={};return dt(t.objectStoreNames,0).forEach(s=>{const u=n.objectStore(s);let c=u.keyPath;const f=Fn(fr(c),c||"",!1,!1,!!u.autoIncrement,c&&"string"!=typeof c,!0),h=[];for(let p=0;p<u.indexNames.length;++p){const w=u.index(u.indexNames[p]);c=w.keyPath;var g=Fn(w.name,c,!!w.unique,!!w.multiEntry,!1,c&&"string"!=typeof c,!1);h.push(g)}i[s]=dr(s,f,h)}),i}function Dn({_novip:e},t,n){const i=n.db.objectStoreNames;for(let s=0;s<i.length;++s){const u=i[s],c=n.objectStore(u);e._hasGetAll="getAll"in c;for(let f=0;f<c.indexNames.length;++f){const h=c.indexNames[f],g=c.index(h).keyPath,p="string"==typeof g?g:"["+dt(g).join("+")+"]";if(t[u]){const w=t[u].idxByName[p];w&&(w.name=h,delete t[u].idxByName[p],t[u].idxByName[h]=w)}}}typeof navigator<"u"&&/Safari/.test(navigator.userAgent)&&!/(Chrome\/|Edge\/)/.test(navigator.userAgent)&&D.WorkerGlobalScope&&D instanceof D.WorkerGlobalScope&&[].concat(navigator.userAgent.match(/Safari\/(\d*)/))[1]<604&&(e._hasGetAll=!1)}class Nr{_parseStoresSpec(t,n){S(t).forEach(i=>{if(null!==t[i]){var s=t[i].split(",").map((c,f)=>{const h=(c=c.trim()).replace(/([&*]|\+\+)/g,""),g=/^\[/.test(h)?h.match(/^\[(.*)\]$/)[1].split("+"):h;return Fn(h,g||null,/\&/.test(c),/\*/.test(c),/\+\+/.test(c),$(g),0===f)}),u=s.shift();if(u.multi)throw new j.Schema("Primary key cannot be multi-valued");s.forEach(c=>{if(c.auto)throw new j.Schema("Only primary key can be marked as autoIncrement (++)");if(!c.keyPath)throw new j.Schema("Index must have a name and cannot be an empty string")}),n[i]=dr(i,u,s)}})}stores(t){const n=this.db;this._cfg.storesSource=this._cfg.storesSource?m(this._cfg.storesSource,t):t;const s={};let u={};return n._versions.forEach(c=>{m(s,c._cfg.storesSource),u=c._cfg.dbschema={},c._parseStoresSpec(s,u)}),n._dbSchema=u,Pn(n,[n._allTables,n,n.Transaction.prototype]),tn(n,[n._allTables,n,n.Transaction.prototype,this._cfg.tables],S(u),u),n._storeNames=S(u),this}upgrade(t){return this._cfg.contentUpgrade=l(this._cfg.contentUpgrade||W,t),this}}function Kn(e,t){let n=e._dbNamesDB;return n||(n=e._dbNamesDB=new Qt(He,{addons:[],indexedDB:e,IDBKeyRange:t}),n.version(1).stores({dbnames:"name"})),n.table("dbnames")}function Un(e){return e&&"function"==typeof e.databases}function jn(e){return $t(function(){return U.letThrough=!0,e()})}function Mr(){var e;return!navigator.userAgentData&&/Safari\//.test(navigator.userAgent)&&!/Chrom(e|ium)\//.test(navigator.userAgent)&&indexedDB.databases?new Promise(function(t){var n=function(){return indexedDB.databases().finally(t)};e=setInterval(n,100),n()}).finally(function(){return clearInterval(e)}):Promise.resolve()}function Nn(e){var t=u=>e.next(u),n=s(t),i=s(u=>e.throw(u));function s(u){return c=>{var f=u(c),h=f.value;return f.done?h:h&&"function"==typeof h.then?h.then(n,i):$(h)?Promise.all(h).then(n,i):n(h)}}return s(t)()}function Lr(e,t,n){var i=arguments.length;if(i<2)throw new j.InvalidArgument("Too few arguments");for(var s=new Array(i-1);--i;)s[i-1]=arguments[i];return n=s.pop(),[e,De(s),n]}function mr(e,t,n,i,s){return R.resolve().then(()=>{const u=U.transless||U,c=e._createTransaction(t,n,e._dbSchema,i),f={trans:c,transless:u};if(i)c.idbtrans=i.idbtrans;else try{c.create(),e._state.PR1398_maxLoop=3}catch(w){return w.name===Yt.InvalidState&&e.isOpen()&&--e._state.PR1398_maxLoop>0?(console.warn("Dexie: Need to reopen db"),e._close(),e.open().then(()=>mr(e,t,n,null,s))):pt(w)}const h=re(s);let g;h&&se();const p=R.follow(()=>{if(g=s.call(c,c),g)if(h){var w=Dt.bind(null,null);g.then(w,w)}else"function"==typeof g.next&&"function"==typeof g.throw&&(g=Nn(g))},f);return(g&&"function"==typeof g.then?R.resolve(g).then(w=>c.active?w:pt(new j.PrematureCommit("Transaction committed too early. See http://bit.ly/2kdckMn"))):p.then(()=>g)).then(w=>(i&&c._resolve(),c._completion.then(()=>w))).catch(w=>(c._reject(w),pt(w)))})}function en(e,t,n){const i=$(e)?e.slice():[e];for(let s=0;s<n;++s)i.push(t);return i}const qr={stack:"dbcore",name:"VirtualIndexMiddleware",level:1,create:function(e){return{...e,table(t){const n=e.table(t),{schema:i}=n,s={},u=[];function c(p,w,y){const _=Pe(p),k=s[_]=s[_]||[],B=null==p?0:"string"==typeof p?1:p.length,I=w>0,E={...y,isVirtual:I,keyTail:w,keyLength:B,extractKey:Cn(p),unique:!I&&y.unique};return k.push(E),E.isPrimaryKey||u.push(E),B>1&&c(2===B?p[0]:p.slice(0,B-1),w+1,y),k.sort((v,F)=>v.keyTail-F.keyTail),E}const f=c(i.primaryKey.keyPath,0,i.primaryKey);s[":id"]=[f];for(const p of i.indexes)c(p.keyPath,0,p);function h(p){const w=p.query.index;return w.isVirtual?{...p,query:{index:w,range:(y=p.query.range,_=w.keyTail,{type:1===y.type?2:y.type,lower:en(y.lower,y.lowerOpen?e.MAX_KEY:e.MIN_KEY,_),lowerOpen:!0,upper:en(y.upper,y.upperOpen?e.MIN_KEY:e.MAX_KEY,_),upperOpen:!0})}}:p;var y,_}return{...n,schema:{...i,primaryKey:f,indexes:u,getIndexByKeyPath:function(p){const w=s[Pe(p)];return w&&w[0]}},count:p=>n.count(h(p)),query:p=>n.query(h(p)),openCursor(p){const{keyTail:w,isVirtual:y,keyLength:_}=p.query.index;return y?n.openCursor(h(p)).then(k=>{return k&&(B=k,Object.create(B,{continue:{value:function(E){null!=E?B.continue(en(E,p.reverse?e.MAX_KEY:e.MIN_KEY,w)):p.unique?B.continue(B.key.slice(0,_).concat(p.reverse?e.MIN_KEY:e.MAX_KEY,w)):B.continue()}},continuePrimaryKey:{value(E,v){B.continuePrimaryKey(en(E,e.MAX_KEY,w),v)}},primaryKey:{get:()=>B.primaryKey},key:{get(){const E=B.key;return 1===_?E[0]:E.slice(0,_)}},value:{get:()=>B.value}}));var B}):n.openCursor(p)}}}}}};function Mn(e,t,n,i){return n=n||{},i=i||"",S(e).forEach(s=>{if(q(t,s)){var u=e[s],c=t[s];if("object"==typeof u&&"object"==typeof c&&u&&c){const f=pe(u);f!==pe(c)?n[i+s]=t[s]:"Object"===f?Mn(u,c,n,i+s+"."):u!==c&&(n[i+s]=t[s])}else u!==c&&(n[i+s]=t[s])}else n[i+s]=void 0}),S(t).forEach(s=>{q(e,s)||(n[i+s]=t[s])}),n}const Wr={stack:"dbcore",name:"HooksMiddleware",level:2,create:e=>({...e,table(t){const n=e.table(t),{primaryKey:i}=n.schema;return{...n,mutate(u){const c=U.trans,{deleting:f,creating:h,updating:g}=c.table(t).hook;switch(u.type){case"add":if(h.fire===W)break;return c._promise("readwrite",()=>p(u),!0);case"put":if(h.fire===W&&g.fire===W)break;return c._promise("readwrite",()=>p(u),!0);case"delete":if(f.fire===W)break;return c._promise("readwrite",()=>p(u),!0);case"deleteRange":if(f.fire===W)break;return c._promise("readwrite",()=>{return w((y=u).trans,y.range,1e4);var y},!0)}return n.mutate(u);function p(y){const _=U.trans,k=y.keys||("delete"===(I=y).type?I.keys:I.keys||I.values.map(i.extractKey));var I;if(!k)throw new Error("Keys missing");return"delete"!==(y="add"===y.type||"put"===y.type?{...y,keys:k}:{...y}).type&&(y.values=[...y.values]),y.keys&&(y.keys=[...y.keys]),function(B,I,E){return"add"===I.type?Promise.resolve([]):B.getMany({trans:I.trans,keys:E,cache:"immutable"})}(n,y,k).then(B=>{const I=k.map((E,v)=>{const F=B[v],T={onerror:null,onsuccess:null};if("delete"===y.type)f.fire.call(T,E,F,_);else if("add"===y.type||void 0===F){const O=h.fire.call(T,E,y.values[v],_);null==E&&null!=O&&(y.keys[v]=E=O,i.outbound||Bt(y.values[v],i.keyPath,E))}else{const O=Mn(F,y.values[v]),P=g.fire.call(T,O,E,F,_);if(P){const A=y.values[v];Object.keys(P).forEach(V=>{q(A,V)?A[V]=P[V]:Bt(A,V,P[V])})}}return T});return n.mutate(y).then(({failures:E,results:v,numFailures:F,lastResult:T})=>{for(let O=0;O<k.length;++O){const P=v?v[O]:k[O],A=I[O];null==P?A.onerror&&A.onerror(E[O]):A.onsuccess&&A.onsuccess("put"===y.type&&B[O]?y.values[O]:P)}return{failures:E,results:v,numFailures:F,lastResult:T}}).catch(E=>(I.forEach(v=>v.onerror&&v.onerror(E)),Promise.reject(E)))})}function w(y,_,k){return n.query({trans:y,values:!1,query:{index:i,range:_},limit:k}).then(({result:B})=>p({type:"delete",keys:B,trans:y}).then(I=>I.numFailures>0?Promise.reject(I.failures[0]):B.length<k?{failures:[],numFailures:0,lastResult:void 0}:w(y,{..._,lower:B[B.length-1],lowerOpen:!0},k)))}}}}})};function gr(e,t,n){try{if(!t||t.keys.length<e.length)return null;const i=[];for(let s=0,u=0;s<t.keys.length&&u<e.length;++s)0===vt(t.keys[s],e[u])&&(i.push(n?Nt(t.values[s]):t.values[s]),++u);return i.length===e.length?i:null}catch{return null}}const zr={stack:"dbcore",level:-1,create:e=>({table:t=>{const n=e.table(t);return{...n,getMany:i=>{if(!i.cache)return n.getMany(i);const s=gr(i.keys,i.trans._cache,"clone"===i.cache);return s?R.resolve(s):n.getMany(i).then(u=>(i.trans._cache={keys:i.keys,values:"clone"===i.cache?Nt(u):u},u))},mutate:i=>("add"!==i.type&&(i.trans._cache=null),n.mutate(i))}}})};function $n(e){return!("from"in e)}const Ut=function(e,t){if(!this){const n=new Ut;return e&&"d"in e&&m(n,e),n}m(this,arguments.length?{d:1,from:e,to:arguments.length>1?t:e}:{d:0})};function Re(e,t,n){const i=vt(t,n);if(isNaN(i))return;if(i>0)throw RangeError();if($n(e))return m(e,{from:t,to:n,d:1});const s=e.l,u=e.r;if(vt(n,e.from)<0)return s?Re(s,t,n):e.l={from:t,to:n,d:1,l:null,r:null},wr(e);if(vt(t,e.to)>0)return u?Re(u,t,n):e.r={from:t,to:n,d:1,l:null,r:null},wr(e);vt(t,e.from)<0&&(e.from=t,e.l=null,e.d=u?u.d+1:1),vt(n,e.to)>0&&(e.to=n,e.r=null,e.d=e.l?e.l.d+1:1);const c=!e.r;s&&!e.l&&nn(e,s),u&&c&&nn(e,u)}function nn(e,t){$n(t)||function n(i,{from:s,to:u,l:c,r:f}){Re(i,s,u),c&&n(i,c),f&&n(i,f)}(e,t)}function Ln(e){let t=$n(e)?null:{s:0,n:e};return{next(n){const i=arguments.length>0;for(;t;)switch(t.s){case 0:if(t.s=1,i)for(;t.n.l&&vt(n,t.n.from)<0;)t={up:t,n:t.n.l,s:1};else for(;t.n.l;)t={up:t,n:t.n.l,s:1};case 1:if(t.s=2,!i||vt(n,t.n.to)<=0)return{value:t.n,done:!1};case 2:if(t.n.r){t.s=3,t={up:t,n:t.n.r,s:0};continue}case 3:t=t.up}return{done:!0}}}}function wr(e){var t,n;const i=((null===(t=e.r)||void 0===t?void 0:t.d)||0)-((null===(n=e.l)||void 0===n?void 0:n.d)||0),s=i>1?"r":i<-1?"l":"";if(s){const u="r"===s?"l":"r",c={...e},f=e[s];e.from=f.from,e.to=f.to,e[s]=f[s],c[s]=f[u],e[u]=c,c.d=br(c)}e.d=br(e)}function br({r:e,l:t}){return(e?t?Math.max(e.d,t.d):e.d:t?t.d:0)+1}lt(Ut.prototype,{add(e){return nn(this,e),this},addKey(e){return Re(this,e,e),this},addKeys(e){return e.forEach(t=>Re(this,t,t)),this},[ye](){return Ln(this)}});const Gr={stack:"dbcore",level:0,create:e=>{const t=e.schema.name,n=new Ut(e.MIN_KEY,e.MAX_KEY);return{...e,table:i=>{const s=e.table(i),{schema:u}=s,{primaryKey:c}=u,{extractKey:f,outbound:h}=c,g={...s,mutate:y=>{const _=y.trans,k=_.mutatedParts||(_.mutatedParts={}),B=P=>{const A=`idb://${t}/${i}/${P}`;return k[A]||(k[A]=new Ut)},I=B(""),E=B(":dels"),{type:v}=y;let[F,T]="deleteRange"===y.type?[y.range]:"delete"===y.type?[y.keys]:y.values.length<50?[[],y.values]:[];const O=y.trans._cache;return s.mutate(y).then(P=>{if($(F)){"delete"!==v&&(F=P.results),I.addKeys(F);const A=gr(F,O);A||"add"===v||E.addKeys(F),(A||T)&&(V=B,at=A,Z=T,u.indexes.forEach(function _t(bt){const ut=V(bt.name||"");function le(Et){return null!=Et?bt.extractKey(Et):null}const he=Et=>bt.multiEntry&&$(Et)?Et.forEach(ee=>ut.addKey(ee)):ut.addKey(Et);(at||Z).forEach((Et,ee)=>{const Te=at&&le(at[ee]),zn=Z&&le(Z[ee]);0!==vt(Te,zn)&&(null!=Te&&he(Te),null!=zn&&he(zn))})}))}else if(F){const A={from:F.lower,to:F.upper};E.add(A),I.add(A)}else I.add(n),E.add(n),u.indexes.forEach(A=>B(A.name).add(n));var V,at,Z;return P})}},p=({query:{index:y,range:_}})=>{var k,B;return[y,new Ut(null!==(k=_.lower)&&void 0!==k?k:e.MIN_KEY,null!==(B=_.upper)&&void 0!==B?B:e.MAX_KEY)]},w={get:y=>[c,new Ut(y.key)],getMany:y=>[c,(new Ut).addKeys(y.keys)],count:p,query:p,openCursor:p};return S(w).forEach(y=>{g[y]=function(_){const{subscr:k}=U;if(k){const B=T=>{const O=`idb://${t}/${i}/${T}`;return k[O]||(k[O]=new Ut)},I=B(""),E=B(":dels"),[v,F]=w[y](_);if(B(v.name||"").add(F),!v.isPrimaryKey){if("count"!==y){const T="query"===y&&h&&_.values&&s.query({..._,values:!1});return s[y].apply(this,arguments).then(O=>{if("query"===y){if(h&&_.values)return T.then(({result:A})=>(I.addKeys(A),O));const P=_.values?O.result.map(f):O.result;_.values?I.addKeys(P):E.addKeys(P)}else if("openCursor"===y){const P=O,A=_.values;return P&&Object.create(P,{key:{get:()=>(E.addKey(P.primaryKey),P.key)},primaryKey:{get(){const V=P.primaryKey;return E.addKey(V),V}},value:{get:()=>(A&&I.addKey(P.primaryKey),P.value)}})}return O})}E.add(n)}}return s[y].apply(this,arguments)}}),g}}}};class Qt{constructor(t,n){this._middlewares={},this.verno=0;const i=Qt.dependencies;this._options=n={addons:Qt.addons,autoOpen:!0,indexedDB:i.indexedDB,IDBKeyRange:i.IDBKeyRange,...n},this._deps={indexedDB:n.indexedDB,IDBKeyRange:n.IDBKeyRange};const{addons:s}=n;this._dbSchema={},this._versions=[],this._storeNames=[],this._allTables={},this.idbdb=null,this._novip=this;const u={dbOpenError:null,isBeingOpened:!1,onReadyBeingFired:null,openComplete:!1,dbReadyResolve:W,dbReadyPromise:null,cancelOpen:W,openCanceller:null,autoSchema:!0,PR1398_maxLoop:3};var c,f;u.dbReadyPromise=new R(f=>{u.dbReadyResolve=f}),u.openCanceller=new R((f,h)=>{u.cancelOpen=h}),this._state=u,this.name=t,this.on=Ie(this,"populate","blocked","versionchange","close",{ready:[l,W]}),this.on.ready.subscribe=Ct(this.on.ready.subscribe,f=>(h,g)=>{Qt.vip(()=>{const p=this._state;if(p.openComplete)p.dbOpenError||R.resolve().then(h),g&&f(h);else if(p.onReadyBeingFired)p.onReadyBeingFired.push(h),g&&f(h);else{f(h);const w=this;g||f(function y(){w.on.ready.unsubscribe(h),w.on.ready.unsubscribe(y)})}})}),this.Collection=(c=this,Ae(Sr.prototype,function(f,h){this.db=c;let g=or,p=null;if(h)try{g=h()}catch(k){p=k}const w=f._ctx,y=w.table,_=y.hook.reading.fire;this._ctx={table:y,index:w.index,isPrimKey:!w.index||y.schema.primKey.keyPath&&w.index===y.schema.primKey.name,range:g,keysOnly:!1,dir:"next",unique:"",algorithm:null,filter:null,replayFilter:null,justLimit:!0,isMatch:null,offset:0,limit:1/0,error:p,or:w.or,valueMapper:_!==Ot?_:null}})),this.Table=(f=this,Ae(Cr.prototype,function(h,g,p){this.db=f,this._tx=p,this.name=h,this.schema=g,this.hook=f._allTables[h]?f._allTables[h].hook:Ie(null,{creating:[hn,W],reading:[ln,Ot],updating:[r,W],deleting:[a,W]})})),this.Transaction=function(f){return Ae(Or.prototype,function(h,g,p,w,y){this.db=f,this.mode=h,this.storeNames=g,this.schema=p,this.chromeTransactionDurability=w,this.idbtrans=null,this.on=Ie(this,"complete","error","abort"),this.parent=y||null,this.active=!0,this._reculock=0,this._blockedFuncs=[],this._resolve=null,this._reject=null,this._waitingFor=null,this._waitingQueue=null,this._spinCount=0,this._completion=new R((_,k)=>{this._resolve=_,this._reject=k}),this._completion.then(()=>{this.active=!1,this.on.complete.fire()},_=>{var k=this.active;return this.active=!1,this.on.error.fire(_),this.parent?this.parent._reject(_):k&&this.idbtrans&&this.idbtrans.abort(),pt(_)})})}(this),this.Version=function(f){return Ae(Nr.prototype,function(h){this.db=f,this._cfg={version:h,storesSource:null,dbschema:{},tables:{},contentUpgrade:null}})}(this),this.WhereClause=function(f){return Ae(hr.prototype,function(h,g,p){this.db=f,this._ctx={table:h,index:":id"===g?null:g,or:p};const w=f._deps.indexedDB;if(!w)throw new j.MissingAPI;this._cmp=this._ascending=w.cmp.bind(w),this._descending=(y,_)=>w.cmp(_,y),this._max=(y,_)=>w.cmp(y,_)>0?y:_,this._min=(y,_)=>w.cmp(y,_)<0?y:_,this._IDBKeyRange=f._deps.IDBKeyRange})}(this),this.on("versionchange",f=>{f.newVersion>0?console.warn(`Another connection wants to upgrade database '${this.name}'. Closing db now to resume the upgrade.`):console.warn(`Another connection wants to delete database '${this.name}'. Closing db now to resume the delete request.`),this.close()}),this.on("blocked",f=>{!f.newVersion||f.newVersion<f.oldVersion?console.warn(`Dexie.delete('${this.name}') was blocked`):console.warn(`Upgrade '${this.name}' blocked by other connection holding version ${f.oldVersion/10}`)}),this._maxKey=Se(n.IDBKeyRange),this._createTransaction=(f,h,g,p)=>new this.Transaction(f,h,g,this._options.chromeTransactionDurability,p),this._fireOnBlocked=f=>{this.on("blocked").fire(f),ke.filter(h=>h.name===this.name&&h!==this&&!h._state.vcFired).map(h=>h.on("versionchange").fire(f))},this.use(qr),this.use(Wr),this.use(Gr),this.use(zr),this.vip=Object.create(this,{_vip:{value:!0}}),s.forEach(f=>f(this))}version(t){if(isNaN(t)||t<.1)throw new j.Type("Given version is not a positive number");if(t=Math.round(10*t)/10,this.idbdb||this._state.isBeingOpened)throw new j.Schema("Cannot add version when database is open");this.verno=Math.max(this.verno,t);const n=this._versions;var i=n.filter(s=>s._cfg.version===t)[0];return i||(i=new this.Version(t),n.push(i),n.sort(Ur),i.stores({}),this._state.autoSchema=!1,i)}_whenReady(t){return this.idbdb&&(this._state.openComplete||U.letThrough||this._vip)?t():new R((n,i)=>{if(this._state.openComplete)return i(new j.DatabaseClosed(this._state.dbOpenError));if(!this._state.isBeingOpened){if(!this._options.autoOpen)return void i(new j.DatabaseClosed);this.open().catch(W)}this._state.dbReadyPromise.then(n,i)}).then(t)}use({stack:t,create:n,level:i,name:s}){s&&this.unuse({stack:t,name:s});const u=this._middlewares[t]||(this._middlewares[t]=[]);return u.push({stack:t,create:n,level:i??10,name:s}),u.sort((c,f)=>c.level-f.level),this}unuse({stack:t,name:n,create:i}){return t&&this._middlewares[t]&&(this._middlewares[t]=this._middlewares[t].filter(s=>i?s.create!==i:!!n&&s.name!==n)),this}open(){return function $r(e){const t=e._state,{indexedDB:n}=e._deps;if(t.isBeingOpened||e.idbdb)return t.dbReadyPromise.then(()=>t.dbOpenError?pt(t.dbOpenError):e);kt&&(t.openCanceller._stackHolder=xt()),t.isBeingOpened=!0,t.dbOpenError=null,t.openComplete=!1;const i=t.openCanceller;function s(){if(t.openCanceller!==i)throw new j.DatabaseClosed("db.open() was cancelled")}let u=t.dbReadyResolve,c=null,f=!1;const h=()=>new R((g,p)=>{if(s(),!n)throw new j.MissingAPI;const w=e.name,y=t.autoSchema?n.open(w):n.open(w,Math.round(10*e.verno));if(!y)throw new j.MissingAPI;y.onerror=Rt(p),y.onblocked=ot(e._fireOnBlocked),y.onupgradeneeded=ot(_=>{if(c=y.transaction,t.autoSchema&&!e._options.allowEmptyDB){y.onerror=Fe,c.abort(),y.result.close();const B=n.deleteDatabase(w);B.onsuccess=B.onerror=ot(()=>{p(new j.NoSuchDatabase(`Database ${w} doesnt exist`))})}else{c.onerror=Rt(p);var k=_.oldVersion>Math.pow(2,62)?0:_.oldVersion;f=k<1,e._novip.idbdb=y.result,function jr(e,t,n,i){const s=e._dbSchema,u=e._createTransaction("readwrite",e._storeNames,s);u.create(n),u._completion.catch(i);const c=u._reject.bind(u),f=U.transless||U;$t(()=>{U.trans=u,U.transless=f,0===t?(S(s).forEach(h=>{Rn(n,h,s[h].primKey,s[h].indexes)}),Sn(e,n),R.follow(()=>e.on.populate.fire(u)).catch(c)):function({_novip:h},g,p,w){const y=[],_=h._versions;let k=h._dbSchema=On(0,h.idbdb,w),B=!1;return _.filter(v=>v._cfg.version>=g).forEach(v=>{y.push(()=>{const F=k,T=v._cfg.dbschema;Dn(h,F,w),Dn(h,T,w),k=h._dbSchema=T;const O=yr(F,T);O.add.forEach(A=>{Rn(w,A[0],A[1].primKey,A[1].indexes)}),O.change.forEach(A=>{if(A.recreate)throw new j.Upgrade("Not yet support for changing primary key");{const V=w.objectStore(A.name);A.add.forEach(C=>Tn(V,C)),A.change.forEach(C=>{V.deleteIndex(C.name),Tn(V,C)}),A.del.forEach(C=>V.deleteIndex(C))}});const P=v._cfg.contentUpgrade;if(P&&v._cfg.version>g){Sn(h,w),p._memoizedTables={},B=!0;let A=Oe(T);O.del.forEach(Z=>{A[Z]=F[Z]}),Pn(h,[h.Transaction.prototype]),tn(h,[h.Transaction.prototype],S(A),A),p.schema=A;const V=re(P);let C;V&&se();const at=R.follow(()=>{if(C=P(p),C&&V){var Z=Dt.bind(null,null);C.then(Z,Z)}});return C&&"function"==typeof C.then?R.resolve(C):at.then(()=>C)}}),y.push(F=>{var T,O;(!B||!Ar)&&(T=v._cfg.dbschema,[].slice.call((O=F).db.objectStoreNames).forEach(P=>null==T[P]&&O.db.deleteObjectStore(P))),Pn(h,[h.Transaction.prototype]),tn(h,[h.Transaction.prototype],h._storeNames,h._dbSchema),p.schema=h._dbSchema})}),function E(){return y.length?R.resolve(y.shift()(p.idbtrans)).then(E):R.resolve()}().then(()=>{var v,F;F=w,S(v=k).forEach(T=>{F.db.objectStoreNames.contains(T)||Rn(F,T,v[T].primKey,v[T].indexes)})})}(e,t,u,n).catch(c)})}(e,k/10,c,p)}},p),y.onsuccess=ot(()=>{c=null;const _=e._novip.idbdb=y.result,k=dt(_.objectStoreNames);if(k.length>0)try{const I=_.transaction(1===(B=k).length?B[0]:B,"readonly");t.autoSchema?function({_novip:E},v,F){E.verno=v.version/10;const T=E._dbSchema=On(0,v,F);E._storeNames=dt(v.objectStoreNames,0),tn(E,[E._allTables],S(T),T)}(e,_,I):(Dn(e,e._dbSchema,I),function(E,v){const F=yr(On(0,E.idbdb,v),E._dbSchema);return!(F.add.length||F.change.some(T=>T.add.length||T.change.length))}(e,I)||console.warn("Dexie SchemaDiff: Schema was extended without increasing the number passed to db.version(). Some queries may fail.")),Sn(e,I)}catch{}var B;ke.push(e),_.onversionchange=ot(I=>{t.vcFired=!0,e.on("versionchange").fire(I)}),_.onclose=ot(I=>{e.on("close").fire(I)}),f&&function({indexedDB:I,IDBKeyRange:E},v){!Un(I)&&v!==He&&Kn(I,E).put({name:v}).catch(W)}(e._deps,w),g()},p)}).catch(g=>g&&"UnknownError"===g.name&&t.PR1398_maxLoop>0?(t.PR1398_maxLoop--,console.warn("Dexie: Workaround for Chrome UnknownError on open()"),h()):R.reject(g));return R.race([i,(typeof navigator>"u"?R.resolve():Mr()).then(h)]).then(()=>(s(),t.onReadyBeingFired=[],R.resolve(jn(()=>e.on.ready.fire(e.vip))).then(function g(){if(t.onReadyBeingFired.length>0){let p=t.onReadyBeingFired.reduce(l,W);return t.onReadyBeingFired=[],R.resolve(jn(()=>p(e.vip))).then(g)}}))).finally(()=>{t.onReadyBeingFired=null,t.isBeingOpened=!1}).then(()=>e).catch(g=>{t.dbOpenError=g;try{c&&c.abort()}catch{}return i===t.openCanceller&&e._close(),pt(g)}).finally(()=>{t.openComplete=!0,u()})}(this)}_close(){const t=this._state,n=ke.indexOf(this);if(n>=0&&ke.splice(n,1),this.idbdb){try{this.idbdb.close()}catch{}this._novip.idbdb=null}t.dbReadyPromise=new R(i=>{t.dbReadyResolve=i}),t.openCanceller=new R((i,s)=>{t.cancelOpen=s})}close(){this._close();const t=this._state;this._options.autoOpen=!1,t.dbOpenError=new j.DatabaseClosed,t.isBeingOpened&&t.cancelOpen(t.dbOpenError)}delete(){const t=arguments.length>0,n=this._state;return new R((i,s)=>{const u=()=>{this.close();var c=this._deps.indexedDB.deleteDatabase(this.name);c.onsuccess=ot(()=>{(function({indexedDB:f,IDBKeyRange:h},g){!Un(f)&&g!==He&&Kn(f,h).delete(g).catch(W)})(this._deps,this.name),i()}),c.onerror=Rt(s),c.onblocked=this._fireOnBlocked};if(t)throw new j.InvalidArgument("Arguments not allowed in db.delete()");n.isBeingOpened?n.dbReadyPromise.then(u):u()})}backendDB(){return this.idbdb}isOpen(){return null!==this.idbdb}hasBeenClosed(){const t=this._state.dbOpenError;return t&&"DatabaseClosed"===t.name}hasFailed(){return null!==this._state.dbOpenError}dynamicallyOpened(){return this._state.autoSchema}get tables(){return S(this._allTables).map(t=>this._allTables[t])}transaction(){const t=Lr.apply(this,arguments);return this._transaction.apply(this,t)}_transaction(t,n,i){let s=U.trans;s&&s.db===this&&-1===t.indexOf("!")||(s=null);const u=-1!==t.indexOf("?");let c,f;t=t.replace("!","").replace("?","");try{if(f=n.map(g=>{var p=g instanceof this.Table?g.name:g;if("string"!=typeof p)throw new TypeError("Invalid table argument to Dexie.transaction(). Only Table or String are allowed");return p}),"r"==t||t===En)c=En;else{if("rw"!=t&&t!=Bn)throw new j.InvalidArgument("Invalid transaction mode: "+t);c=Bn}if(s){if(s.mode===En&&c===Bn){if(!u)throw new j.SubTransaction("Cannot enter a sub-transaction with READWRITE mode when parent transaction is READONLY");s=null}s&&f.forEach(g=>{if(s&&-1===s.storeNames.indexOf(g)){if(!u)throw new j.SubTransaction("Table "+g+" not included in parent transaction.");s=null}}),u&&s&&!s.active&&(s=null)}}catch(g){return s?s._promise(null,(p,w)=>{w(g)}):pt(g)}const h=mr.bind(null,this,c,f,s,i);return s?s._promise(c,h,"lock"):U.trans?ae(U.transless,()=>this._whenReady(h)):this._whenReady(h)}table(t){if(!q(this._allTables,t))throw new j.InvalidTable(`Table ${t} does not exist`);return this._allTables[t]}}const Yr=typeof Symbol<"u"&&"observable"in Symbol?Symbol.observable:"@@observable";class Hr{constructor(t){this._subscribe=t}subscribe(t,n,i){return this._subscribe(t&&"function"!=typeof t?t:{next:t,error:n,complete:i})}[Yr](){return this}}function vr(e,t){return S(t).forEach(n=>{nn(e[n]||(e[n]=new Ut),t[n])}),e}let qn;try{qn={indexedDB:D.indexedDB||D.mozIndexedDB||D.webkitIndexedDB||D.msIndexedDB,IDBKeyRange:D.IDBKeyRange||D.webkitIDBKeyRange}}catch{qn={indexedDB:null,IDBKeyRange:null}}const te=Qt;function rn(e){let t=jt;try{jt=!0,zt.storagemutated.fire(e)}finally{jt=t}}lt(te,{...Tt,delete:e=>new te(e,{addons:[]}).delete(),exists:e=>new te(e,{addons:[]}).open().then(t=>(t.close(),!0)).catch("NoSuchDatabaseError",()=>!1),getDatabaseNames(e){try{return function({indexedDB:t,IDBKeyRange:n}){return Un(t)?Promise.resolve(t.databases()).then(i=>i.map(s=>s.name).filter(s=>s!==He)):Kn(t,n).toCollection().primaryKeys()}(te.dependencies).then(e)}catch{return pt(new j.MissingAPI)}},defineClass:()=>function(e){m(this,e)},ignoreTransaction:e=>U.trans?ae(U.transless,e):e(),vip:jn,async:function(e){return function(){try{var t=Nn(e.apply(this,arguments));return t&&"function"==typeof t.then?t:R.resolve(t)}catch(n){return pt(n)}}},spawn:function(e,t,n){try{var i=Nn(e.apply(n,t||[]));return i&&"function"==typeof i.then?i:R.resolve(i)}catch(s){return pt(s)}},currentTransaction:{get:()=>U.trans||null},waitFor:function(e,t){const n=R.resolve("function"==typeof e?te.ignoreTransaction(e):e).timeout(t||6e4);return U.trans?U.trans.waitFor(n):n},Promise:R,debug:{get:()=>kt,set:e=>{me(e,"dexie"===e?()=>!0:ir)}},derive:Y,extend:m,props:lt,override:Ct,Events:Ie,on:zt,liveQuery:function Zr(e){let t,n=!1;const i=new Hr(s=>{const u=re(e);let c=!1,f={},h={};const g={get closed(){return c},unsubscribe:()=>{c=!0,zt.storagemutated.unsubscribe(_)}};s.start&&s.start(g);let p=!1,w=!1;function y(){return S(h).some(B=>f[B]&&function Vr(e,t){const n=Ln(t);let i=n.next();if(i.done)return!1;let s=i.value;const u=Ln(e);let c=u.next(s.from),f=c.value;for(;!i.done&&!c.done;){if(vt(f.from,s.to)<=0&&vt(f.to,s.from)>=0)return!0;vt(s.from,f.from)<0?s=(i=n.next(f.from)).value:f=(c=u.next(s.from)).value}return!1}(f[B],h[B]))}const _=B=>{vr(f,B),y()&&k()},k=()=>{if(p||c)return;f={};const B={},I=function(E){u&&se();const v=()=>$t(e,{subscr:E,trans:null}),F=U.trans?ae(U.transless,v):v();return u&&F.then(Dt,Dt),F}(B);w||(zt(Ce,_),w=!0),p=!0,Promise.resolve(I).then(E=>{n=!0,t=E,p=!1,c||(y()?k():(f={},h=B,s.next&&s.next(E)))},E=>{p=!1,n=!1,s.error&&s.error(E),g.unsubscribe()})};return k(),g});return i.hasValue=()=>n,i.getValue=()=>t,i},extendObservabilitySet:vr,getByKeyPath:Ft,setByKeyPath:Bt,delByKeyPath:function(e,t){"string"==typeof t?Bt(e,t,void 0):"length"in t&&[].map.call(t,function(n){Bt(e,n,void 0)})},shallowClone:Oe,deepClone:Nt,getObjectDiff:Mn,cmp:vt,asap:Pt,minKey:xn,addons:[],connections:ke,errnames:Yt,dependencies:qn,semVer:"3.2.7",version:"3.2.7".split(".").map(e=>parseInt(e)).reduce((e,t,n)=>e+t/Math.pow(10,2*n))}),te.maxKey=Se(te.dependencies.IDBKeyRange),typeof dispatchEvent<"u"&&typeof addEventListener<"u"&&(zt(Ce,e=>{if(!jt){let t;Ye?(t=document.createEvent("CustomEvent"),t.initCustomEvent(Wt,!0,!0,e)):t=new CustomEvent(Wt,{detail:e}),jt=!0,dispatchEvent(t),jt=!1}}),addEventListener(Wt,({detail:e})=>{jt||rn(e)}));let jt=!1;if(typeof BroadcastChannel<"u"){const e=new BroadcastChannel(Wt);"function"==typeof e.unref&&e.unref(),zt(Ce,t=>{jt||e.postMessage(t)}),e.onmessage=t=>{t.data&&rn(t.data)}}else if(typeof self<"u"&&typeof navigator<"u"){zt(Ce,t=>{try{jt||(typeof localStorage<"u"&&localStorage.setItem(Wt,JSON.stringify({trig:Math.random(),changedParts:t})),"object"==typeof self.clients&&[...self.clients.matchAll({includeUncontrolled:!0})].forEach(n=>n.postMessage({type:Wt,changedParts:t})))}catch{}}),typeof addEventListener<"u"&&addEventListener("storage",t=>{if(t.key===Wt){const n=JSON.parse(t.newValue);n&&rn(n.changedParts)}});const e=self.document&&navigator.serviceWorker;e&&e.addEventListener("message",function({data:t}){t&&t.type===Wt&&rn(t.changedParts)})}R.rejectionMapper=function(e,t){if(!e||e instanceof It||e instanceof TypeError||e instanceof SyntaxError||!e.name||!ve[e.name])return e;var n=new ve[e.name](t||e.message,e);return"stack"in e&&M(n,"stack",{get:function(){return this.inner.stack}}),n},me(kt,ir);var Wn=z(8274),Xr=z(2897);let Jr=(()=>{const t=class{constructor(i,s){this.http=i,this.ea=s,this.access_token=null,this.config=X.Z.spotify,this.eps={base:{accounts:"https://accounts.spotify.com",api:"https://api.spotify.com"},authorize:"/authorize",api:"/api",token:"/token",version:"/v1",me:{albums:"/me/albums",savedAlbums:"/me/albums/contains"}},this.initDB()}initDB(){this.db=new Qt("spotify"),this.db.version(1).stores({codes:"++id, type, code"}),this.table=this.db.table("codes")}getCode(){var i=this;return(0,K.Z)(function*(){return(yield i.table.get({type:"spotify"}))?.code??null})()}getHeaders(i=!1){const s=G.lW.from(this.config.clientId,"base64").toString(),u=G.lW.from(this.config.clientSecret,"base64").toString(),c=this.access_token?this.access_token:G.lW.from(s+":"+u).toString("base64");return(new ct.WM).set("Authorization",`${this.access_token?"Bearer":"Basic"} ${c}`).set("Content-Type","application/"+(i?"json":"x-www-form-urlencoded"))}getToken(){var i=this;return(0,K.Z)(function*(){let s=yield i.table.get({type:"spotify_tk"}),u=null;if(s)u=JSON.parse(s.code),i.access_token=u.access_token;else{const c=yield i.getCode(),f=new ct.LE({fromObject:{grant_type:"authorization_code",code:c,redirect_uri:`${location.origin}/callback`}}),h=i.getHeaders();u=yield new Promise(g=>{i.http.post(`${i.eps.base.accounts}${i.eps.api}${i.eps.token}`,f.toString(),{headers:h}).subscribe(p=>{(0,K.Z)(function*(){i.access_token=p.access_token,yield i.table.add({type:"spotify_tk",code:JSON.stringify(p)}),g(p)})()})})}return u})()}preSave(){var i=this;return(0,K.Z)(function*(){yield i.getToken(),(yield i.checkNextRelease())||(yield i.storeNextRelease()),i.ea.trigger("toast:add","presave.done.spotify")})()}getStoredAlbums(){var i=this;return(0,K.Z)(function*(){const s=i.getHeaders();return yield new Promise(u=>{i.http.get(`${i.eps.base.api}${i.eps.version}${i.eps.me.albums}`,{headers:s}).subscribe(c=>{u(c)})})})()}checkNextRelease(){var i=this;return(0,K.Z)(function*(){const s=i.getHeaders();return yield new Promise(u=>{i.http.get(`${i.eps.base.api}${i.eps.version}${i.eps.me.savedAlbums}?ids=${X.Z.spotify.nextRelease}`,{headers:s}).subscribe(c=>{u(c[0])})})})()}storeNextRelease(){var i=this;return(0,K.Z)(function*(){const s=i.getHeaders(!0);return yield new Promise(u=>{i.http.put(`${i.eps.base.api}${i.eps.version}${i.eps.me.albums}`,JSON.stringify({ids:[X.Z.spotify.nextRelease]}),{headers:s}).subscribe(f=>{u(f)})})})()}authorize(){var i=this;return(0,K.Z)(function*(){if(yield i.getCode())return"";{const s=G.lW.from(i.config.clientId,"base64").toString(),u=new ct.LE({fromObject:{response_type:"code",client_id:s,scope:"user-follow-modify user-library-modify user-library-read user-follow-read",redirect_uri:`${location.origin}/callback`,state:"SWEETQ"}});return`${i.eps.base.accounts}${i.eps.authorize}?${u.toString()}`}})()}setCode(i){var s=this;return(0,K.Z)(function*(){yield s.table.add({type:"spotify",code:i}),yield s.preSave()})()}};let e=t;return t.\u0275fac=function(s){return new(s||t)(Wn.LFG(ct.eN),Wn.LFG(Xr.Y))},t.\u0275prov=Wn.Yz7({token:t,factory:t.\u0275fac}),e})()},5343:(ne,yt)=>{"use strict";yt.byteLength=function $(N){var M=S(N),ht=M[1];return 3*(M[0]+ht)/4-ht},yt.toByteArray=function J(N){var M,ft,Y=S(N),ht=Y[0],mt=Y[1],st=new ct(function m(N,M,Y){return 3*(M+Y)/4-Y}(0,ht,mt)),dt=0,Ct=mt>0?ht-4:ht;for(ft=0;ft<Ct;ft+=4)M=K[N.charCodeAt(ft)]<<18|K[N.charCodeAt(ft+1)]<<12|K[N.charCodeAt(ft+2)]<<6|K[N.charCodeAt(ft+3)],st[dt++]=M>>16&255,st[dt++]=M>>8&255,st[dt++]=255&M;return 2===mt&&(M=K[N.charCodeAt(ft)]<<2|K[N.charCodeAt(ft+1)]>>4,st[dt++]=255&M),1===mt&&(M=K[N.charCodeAt(ft)]<<10|K[N.charCodeAt(ft+1)]<<4|K[N.charCodeAt(ft+2)]>>2,st[dt++]=M>>8&255,st[dt++]=255&M),st},yt.fromByteArray=function lt(N){for(var M,Y=N.length,ht=Y%3,mt=[],dt=0,Ct=Y-ht;dt<Ct;dt+=16383)mt.push(q(N,dt,dt+16383>Ct?Ct:dt+16383));return 1===ht?mt.push(z[(M=N[Y-1])>>2]+z[M<<4&63]+"=="):2===ht&&mt.push(z[(M=(N[Y-2]<<8)+N[Y-1])>>10]+z[M>>4&63]+z[M<<2&63]+"="),mt.join("")};for(var z=[],K=[],ct=typeof Uint8Array<"u"?Uint8Array:Array,X="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",G=0,D=X.length;G<D;++G)z[G]=X[G],K[X.charCodeAt(G)]=G;function S(N){var M=N.length;if(M%4>0)throw new Error("Invalid string. Length must be a multiple of 4");var Y=N.indexOf("=");return-1===Y&&(Y=M),[Y,Y===M?0:4-Y%4]}function Q(N){return z[N>>18&63]+z[N>>12&63]+z[N>>6&63]+z[63&N]}function q(N,M,Y){for(var mt=[],st=M;st<Y;st+=3)mt.push(Q((N[st]<<16&16711680)+(N[st+1]<<8&65280)+(255&N[st+2])));return mt.join("")}K["-".charCodeAt(0)]=62,K["_".charCodeAt(0)]=63},3172:(ne,yt,z)=>{"use strict";const ct=z(5343),X=z(8461),G="function"==typeof Symbol&&"function"==typeof Symbol.for?Symbol.for("nodejs.util.inspect.custom"):null;yt.lW=m,yt.h2=50;const D=2147483647;function $(a){if(a>D)throw new RangeError('The value "'+a+'" is invalid for option "size"');const r=new Uint8Array(a);return Object.setPrototypeOf(r,m.prototype),r}function m(a,r,o){if("number"==typeof a){if("string"==typeof r)throw new TypeError('The "string" argument must be of type string. Received type number');return lt(a)}return J(a,r,o)}function J(a,r,o){if("string"==typeof a)return function N(a,r){if(("string"!=typeof r||""===r)&&(r="utf8"),!m.isEncoding(r))throw new TypeError("Unknown encoding: "+r);const o=0|Ct(a,r);let l=$(o);const d=l.write(a,r);return d!==o&&(l=l.slice(0,d)),l}(a,r);if(ArrayBuffer.isView(a))return function Y(a){if(W(a,Uint8Array)){const r=new Uint8Array(a);return ht(r.buffer,r.byteOffset,r.byteLength)}return M(a)}(a);if(null==a)throw new TypeError("The first argument must be one of type string, Buffer, ArrayBuffer, Array, or Array-like Object. Received type "+typeof a);if(W(a,ArrayBuffer)||a&&W(a.buffer,ArrayBuffer)||typeof SharedArrayBuffer<"u"&&(W(a,SharedArrayBuffer)||a&&W(a.buffer,SharedArrayBuffer)))return ht(a,r,o);if("number"==typeof a)throw new TypeError('The "value" argument must not be of type number. Received type number');const l=a.valueOf&&a.valueOf();if(null!=l&&l!==a)return m.from(l,r,o);const d=function mt(a){if(m.isBuffer(a)){const r=0|st(a.length),o=$(r);return 0===o.length||a.copy(o,0,0,r),o}return void 0!==a.length?"number"!=typeof a.length||Ot(a.length)?$(0):M(a):"Buffer"===a.type&&Array.isArray(a.data)?M(a.data):void 0}(a);if(d)return d;if(typeof Symbol<"u"&&null!=Symbol.toPrimitive&&"function"==typeof a[Symbol.toPrimitive])return m.from(a[Symbol.toPrimitive]("string"),r,o);throw new TypeError("The first argument must be one of type string, Buffer, ArrayBuffer, Array, or Array-like Object. Received type "+typeof a)}function Q(a){if("number"!=typeof a)throw new TypeError('"size" argument must be of type number');if(a<0)throw new RangeError('The value "'+a+'" is invalid for option "size"')}function lt(a){return Q(a),$(a<0?0:0|st(a))}function M(a){const r=a.length<0?0:0|st(a.length),o=$(r);for(let l=0;l<r;l+=1)o[l]=255&a[l];return o}function ht(a,r,o){if(r<0||a.byteLength<r)throw new RangeError('"offset" is outside of buffer bounds');if(a.byteLength<r+(o||0))throw new RangeError('"length" is outside of buffer bounds');let l;return l=void 0===r&&void 0===o?new Uint8Array(a):void 0===o?new Uint8Array(a,r):new Uint8Array(a,r,o),Object.setPrototypeOf(l,m.prototype),l}function st(a){if(a>=D)throw new RangeError("Attempt to allocate Buffer larger than maximum size: 0x"+D.toString(16)+" bytes");return 0|a}function Ct(a,r){if(m.isBuffer(a))return a.length;if(ArrayBuffer.isView(a)||W(a,ArrayBuffer))return a.byteLength;if("string"!=typeof a)throw new TypeError('The "string" argument must be one of type string, Buffer, or ArrayBuffer. Received type '+typeof a);const o=a.length,l=arguments.length>2&&!0===arguments[2];if(!l&&0===o)return 0;let d=!1;for(;;)switch(r){case"ascii":case"latin1":case"binary":return o;case"utf8":case"utf-8":return Yt(a).length;case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return 2*o;case"hex":return o>>>1;case"base64":return ve(a).length;default:if(d)return l?-1:Yt(a).length;r=(""+r).toLowerCase(),d=!0}}function ft(a,r,o){let l=!1;if((void 0===r||r<0)&&(r=0),r>this.length||((void 0===o||o>this.length)&&(o=this.length),o<=0)||(o>>>=0)<=(r>>>=0))return"";for(a||(a="utf8");;)switch(a){case"hex":return ye(this,r,o);case"utf8":case"utf-8":return St(this,r,o);case"ascii":return an(this,r,o);case"latin1":case"binary":return pe(this,r,o);case"base64":return sn(this,r,o);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return un(this,r,o);default:if(l)throw new TypeError("Unknown encoding: "+a);a=(a+"").toLowerCase(),l=!0}}function Pt(a,r,o){const l=a[r];a[r]=a[o],a[o]=l}function fe(a,r,o,l,d){if(0===a.length)return-1;if("string"==typeof o?(l=o,o=0):o>2147483647?o=2147483647:o<-2147483648&&(o=-2147483648),Ot(o=+o)&&(o=d?0:a.length-1),o<0&&(o=a.length+o),o>=a.length){if(d)return-1;o=a.length-1}else if(o<0){if(!d)return-1;o=0}if("string"==typeof r&&(r=m.from(r,l)),m.isBuffer(r))return 0===r.length?-1:Ft(a,r,o,l,d);if("number"==typeof r)return r&=255,"function"==typeof Uint8Array.prototype.indexOf?d?Uint8Array.prototype.indexOf.call(a,r,o):Uint8Array.prototype.lastIndexOf.call(a,r,o):Ft(a,[r],o,l,d);throw new TypeError("val must be string, number or Buffer")}function Ft(a,r,o,l,d){let tt,b=1,x=a.length,L=r.length;if(void 0!==l&&("ucs2"===(l=String(l).toLowerCase())||"ucs-2"===l||"utf16le"===l||"utf-16le"===l)){if(a.length<2||r.length<2)return-1;b=2,x/=2,L/=2,o/=2}function nt(et,H){return 1===b?et[H]:et.readUInt16BE(H*b)}if(d){let et=-1;for(tt=o;tt<x;tt++)if(nt(a,tt)===nt(r,-1===et?0:tt-et)){if(-1===et&&(et=tt),tt-et+1===L)return et*b}else-1!==et&&(tt-=tt-et),et=-1}else for(o+L>x&&(o=x-L),tt=o;tt>=0;tt--){let et=!0;for(let H=0;H<L;H++)if(nt(a,tt+H)!==nt(r,H)){et=!1;break}if(et)return tt}return-1}function Bt(a,r,o,l){o=Number(o)||0;const d=a.length-o;l?(l=Number(l))>d&&(l=d):l=d;const b=r.length;let x;for(l>b/2&&(l=b/2),x=0;x<l;++x){const L=parseInt(r.substr(2*x,2),16);if(Ot(L))return x;a[o+x]=L}return x}function Oe(a,r,o,l){return Tt(Yt(r,a.length-o),a,o,l)}function on(a,r,o,l){return Tt(function cn(a){const r=[];for(let o=0;o<a.length;++o)r.push(255&a.charCodeAt(o));return r}(r),a,o,l)}function De(a,r,o,l){return Tt(ve(r),a,o,l)}function Ke(a,r,o,l){return Tt(function j(a,r){let o,l,d;const b=[];for(let x=0;x<a.length&&!((r-=2)<0);++x)o=a.charCodeAt(x),l=o>>8,d=o%256,b.push(d),b.push(l);return b}(r,a.length-o),a,o,l)}function sn(a,r,o){return ct.fromByteArray(0===r&&o===a.length?a:a.slice(r,o))}function St(a,r,o){o=Math.min(a.length,o);const l=[];let d=r;for(;d<o;){const b=a[d];let x=null,L=b>239?4:b>223?3:b>191?2:1;if(d+L<=o){let nt,tt,et,H;switch(L){case 1:b<128&&(x=b);break;case 2:nt=a[d+1],128==(192&nt)&&(H=(31&b)<<6|63&nt,H>127&&(x=H));break;case 3:nt=a[d+1],tt=a[d+2],128==(192&nt)&&128==(192&tt)&&(H=(15&b)<<12|(63&nt)<<6|63&tt,H>2047&&(H<55296||H>57343)&&(x=H));break;case 4:nt=a[d+1],tt=a[d+2],et=a[d+3],128==(192&nt)&&128==(192&tt)&&128==(192&et)&&(H=(15&b)<<18|(63&nt)<<12|(63&tt)<<6|63&et,H>65535&&H<1114112&&(x=H))}}null===x?(x=65533,L=1):x>65535&&(x-=65536,l.push(x>>>10&1023|55296),x=56320|1023&x),l.push(x),d+=L}return function de(a){const r=a.length;if(r<=Nt)return String.fromCharCode.apply(String,a);let o="",l=0;for(;l<r;)o+=String.fromCharCode.apply(String,a.slice(l,l+=Nt));return o}(l)}!(m.TYPED_ARRAY_SUPPORT=function S(){try{const a=new Uint8Array(1),r={foo:function(){return 42}};return Object.setPrototypeOf(r,Uint8Array.prototype),Object.setPrototypeOf(a,r),42===a.foo()}catch{return!1}}())&&typeof console<"u"&&"function"==typeof console.error&&console.error("This browser lacks typed array (Uint8Array) support which is required by `buffer` v5.x. Use `buffer` v4.x if you require old browser support."),Object.defineProperty(m.prototype,"parent",{enumerable:!0,get:function(){if(m.isBuffer(this))return this.buffer}}),Object.defineProperty(m.prototype,"offset",{enumerable:!0,get:function(){if(m.isBuffer(this))return this.byteOffset}}),m.poolSize=8192,m.from=function(a,r,o){return J(a,r,o)},Object.setPrototypeOf(m.prototype,Uint8Array.prototype),Object.setPrototypeOf(m,Uint8Array),m.alloc=function(a,r,o){return function q(a,r,o){return Q(a),a<=0?$(a):void 0!==r?"string"==typeof o?$(a).fill(r,o):$(a).fill(r):$(a)}(a,r,o)},m.allocUnsafe=function(a){return lt(a)},m.allocUnsafeSlow=function(a){return lt(a)},m.isBuffer=function(r){return null!=r&&!0===r._isBuffer&&r!==m.prototype},m.compare=function(r,o){if(W(r,Uint8Array)&&(r=m.from(r,r.offset,r.byteLength)),W(o,Uint8Array)&&(o=m.from(o,o.offset,o.byteLength)),!m.isBuffer(r)||!m.isBuffer(o))throw new TypeError('The "buf1", "buf2" arguments must be one of type Buffer or Uint8Array');if(r===o)return 0;let l=r.length,d=o.length;for(let b=0,x=Math.min(l,d);b<x;++b)if(r[b]!==o[b]){l=r[b],d=o[b];break}return l<d?-1:d<l?1:0},m.isEncoding=function(r){switch(String(r).toLowerCase()){case"hex":case"utf8":case"utf-8":case"ascii":case"latin1":case"binary":case"base64":case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return!0;default:return!1}},m.concat=function(r,o){if(!Array.isArray(r))throw new TypeError('"list" argument must be an Array of Buffers');if(0===r.length)return m.alloc(0);let l;if(void 0===o)for(o=0,l=0;l<r.length;++l)o+=r[l].length;const d=m.allocUnsafe(o);let b=0;for(l=0;l<r.length;++l){let x=r[l];if(W(x,Uint8Array))b+x.length>d.length?(m.isBuffer(x)||(x=m.from(x)),x.copy(d,b)):Uint8Array.prototype.set.call(d,x,b);else{if(!m.isBuffer(x))throw new TypeError('"list" argument must be an Array of Buffers');x.copy(d,b)}b+=x.length}return d},m.byteLength=Ct,m.prototype._isBuffer=!0,m.prototype.swap16=function(){const r=this.length;if(r%2!=0)throw new RangeError("Buffer size must be a multiple of 16-bits");for(let o=0;o<r;o+=2)Pt(this,o,o+1);return this},m.prototype.swap32=function(){const r=this.length;if(r%4!=0)throw new RangeError("Buffer size must be a multiple of 32-bits");for(let o=0;o<r;o+=4)Pt(this,o,o+3),Pt(this,o+1,o+2);return this},m.prototype.swap64=function(){const r=this.length;if(r%8!=0)throw new RangeError("Buffer size must be a multiple of 64-bits");for(let o=0;o<r;o+=8)Pt(this,o,o+7),Pt(this,o+1,o+6),Pt(this,o+2,o+5),Pt(this,o+3,o+4);return this},m.prototype.toLocaleString=m.prototype.toString=function(){const r=this.length;return 0===r?"":0===arguments.length?St(this,0,r):ft.apply(this,arguments)},m.prototype.equals=function(r){if(!m.isBuffer(r))throw new TypeError("Argument must be a Buffer");return this===r||0===m.compare(this,r)},m.prototype.inspect=function(){let r="";const o=yt.h2;return r=this.toString("hex",0,o).replace(/(.{2})/g,"$1 ").trim(),this.length>o&&(r+=" ... "),"<Buffer "+r+">"},G&&(m.prototype[G]=m.prototype.inspect),m.prototype.compare=function(r,o,l,d,b){if(W(r,Uint8Array)&&(r=m.from(r,r.offset,r.byteLength)),!m.isBuffer(r))throw new TypeError('The "target" argument must be one of type Buffer or Uint8Array. Received type '+typeof r);if(void 0===o&&(o=0),void 0===l&&(l=r?r.length:0),void 0===d&&(d=0),void 0===b&&(b=this.length),o<0||l>r.length||d<0||b>this.length)throw new RangeError("out of range index");if(d>=b&&o>=l)return 0;if(d>=b)return-1;if(o>=l)return 1;if(this===r)return 0;let x=(b>>>=0)-(d>>>=0),L=(l>>>=0)-(o>>>=0);const nt=Math.min(x,L),tt=this.slice(d,b),et=r.slice(o,l);for(let H=0;H<nt;++H)if(tt[H]!==et[H]){x=tt[H],L=et[H];break}return x<L?-1:L<x?1:0},m.prototype.includes=function(r,o,l){return-1!==this.indexOf(r,o,l)},m.prototype.indexOf=function(r,o,l){return fe(this,r,o,l,!0)},m.prototype.lastIndexOf=function(r,o,l){return fe(this,r,o,l,!1)},m.prototype.write=function(r,o,l,d){if(void 0===o)d="utf8",l=this.length,o=0;else if(void 0===l&&"string"==typeof o)d=o,l=this.length,o=0;else{if(!isFinite(o))throw new Error("Buffer.write(string, encoding, offset[, length]) is no longer supported");o>>>=0,isFinite(l)?(l>>>=0,void 0===d&&(d="utf8")):(d=l,l=void 0)}const b=this.length-o;if((void 0===l||l>b)&&(l=b),r.length>0&&(l<0||o<0)||o>this.length)throw new RangeError("Attempt to write outside buffer bounds");d||(d="utf8");let x=!1;for(;;)switch(d){case"hex":return Bt(this,r,o,l);case"utf8":case"utf-8":return Oe(this,r,o,l);case"ascii":case"latin1":case"binary":return on(this,r,o,l);case"base64":return De(this,r,o,l);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return Ke(this,r,o,l);default:if(x)throw new TypeError("Unknown encoding: "+d);d=(""+d).toLowerCase(),x=!0}},m.prototype.toJSON=function(){return{type:"Buffer",data:Array.prototype.slice.call(this._arr||this,0)}};const Nt=4096;function an(a,r,o){let l="";o=Math.min(a.length,o);for(let d=r;d<o;++d)l+=String.fromCharCode(127&a[d]);return l}function pe(a,r,o){let l="";o=Math.min(a.length,o);for(let d=r;d<o;++d)l+=String.fromCharCode(a[d]);return l}function ye(a,r,o){const l=a.length;(!r||r<0)&&(r=0),(!o||o<0||o>l)&&(o=l);let d="";for(let b=r;b<o;++b)d+=ln[a[b]];return d}function un(a,r,o){const l=a.slice(r,o);let d="";for(let b=0;b<l.length-1;b+=2)d+=String.fromCharCode(l[b]+256*l[b+1]);return d}function rt(a,r,o){if(a%1!=0||a<0)throw new RangeError("offset is not uint");if(a+r>o)throw new RangeError("Trying to access beyond buffer length")}function it(a,r,o,l,d,b){if(!m.isBuffer(a))throw new TypeError('"buffer" argument must be a Buffer instance');if(r>d||r<b)throw new RangeError('"value" argument is out of bounds');if(o+l>a.length)throw new RangeError("Index out of range")}function re(a,r,o,l,d){je(r,l,d,a,o,7);let b=Number(r&BigInt(4294967295));a[o++]=b,b>>=8,a[o++]=b,b>>=8,a[o++]=b,b>>=8,a[o++]=b;let x=Number(r>>BigInt(32)&BigInt(4294967295));return a[o++]=x,x>>=8,a[o++]=x,x>>=8,a[o++]=x,x>>=8,a[o++]=x,o}function kt(a,r,o,l,d){je(r,l,d,a,o,7);let b=Number(r&BigInt(4294967295));a[o+7]=b,b>>=8,a[o+6]=b,b>>=8,a[o+5]=b,b>>=8,a[o+4]=b;let x=Number(r>>BigInt(32)&BigInt(4294967295));return a[o+3]=x,x>>=8,a[o+2]=x,x>>=8,a[o+1]=x,x>>=8,a[o]=x,o+8}function me(a,r,o,l,d,b){if(o+l>a.length)throw new RangeError("Index out of range");if(o<0)throw new RangeError("Index out of range")}function ge(a,r,o,l,d){return r=+r,o>>>=0,d||me(a,0,o,4),X.write(a,r,o,l,23,4),o+4}function Ue(a,r,o,l,d){return r=+r,o>>>=0,d||me(a,0,o,8),X.write(a,r,o,l,52,8),o+8}m.prototype.slice=function(r,o){const l=this.length;(r=~~r)<0?(r+=l)<0&&(r=0):r>l&&(r=l),(o=void 0===o?l:~~o)<0?(o+=l)<0&&(o=0):o>l&&(o=l),o<r&&(o=r);const d=this.subarray(r,o);return Object.setPrototypeOf(d,m.prototype),d},m.prototype.readUintLE=m.prototype.readUIntLE=function(r,o,l){r>>>=0,o>>>=0,l||rt(r,o,this.length);let d=this[r],b=1,x=0;for(;++x<o&&(b*=256);)d+=this[r+x]*b;return d},m.prototype.readUintBE=m.prototype.readUIntBE=function(r,o,l){r>>>=0,o>>>=0,l||rt(r,o,this.length);let d=this[r+--o],b=1;for(;o>0&&(b*=256);)d+=this[r+--o]*b;return d},m.prototype.readUint8=m.prototype.readUInt8=function(r,o){return r>>>=0,o||rt(r,1,this.length),this[r]},m.prototype.readUint16LE=m.prototype.readUInt16LE=function(r,o){return r>>>=0,o||rt(r,2,this.length),this[r]|this[r+1]<<8},m.prototype.readUint16BE=m.prototype.readUInt16BE=function(r,o){return r>>>=0,o||rt(r,2,this.length),this[r]<<8|this[r+1]},m.prototype.readUint32LE=m.prototype.readUInt32LE=function(r,o){return r>>>=0,o||rt(r,4,this.length),(this[r]|this[r+1]<<8|this[r+2]<<16)+16777216*this[r+3]},m.prototype.readUint32BE=m.prototype.readUInt32BE=function(r,o){return r>>>=0,o||rt(r,4,this.length),16777216*this[r]+(this[r+1]<<16|this[r+2]<<8|this[r+3])},m.prototype.readBigUInt64LE=gt(function(r){It(r>>>=0,"offset");const o=this[r],l=this[r+7];(void 0===o||void 0===l)&&Mt(r,this.length-8);const d=o+256*this[++r]+65536*this[++r]+this[++r]*2**24,b=this[++r]+256*this[++r]+65536*this[++r]+l*2**24;return BigInt(d)+(BigInt(b)<<BigInt(32))}),m.prototype.readBigUInt64BE=gt(function(r){It(r>>>=0,"offset");const o=this[r],l=this[r+7];(void 0===o||void 0===l)&&Mt(r,this.length-8);const d=o*2**24+65536*this[++r]+256*this[++r]+this[++r],b=this[++r]*2**24+65536*this[++r]+256*this[++r]+l;return(BigInt(d)<<BigInt(32))+BigInt(b)}),m.prototype.readIntLE=function(r,o,l){r>>>=0,o>>>=0,l||rt(r,o,this.length);let d=this[r],b=1,x=0;for(;++x<o&&(b*=256);)d+=this[r+x]*b;return b*=128,d>=b&&(d-=Math.pow(2,8*o)),d},m.prototype.readIntBE=function(r,o,l){r>>>=0,o>>>=0,l||rt(r,o,this.length);let d=o,b=1,x=this[r+--d];for(;d>0&&(b*=256);)x+=this[r+--d]*b;return b*=128,x>=b&&(x-=Math.pow(2,8*o)),x},m.prototype.readInt8=function(r,o){return r>>>=0,o||rt(r,1,this.length),128&this[r]?-1*(255-this[r]+1):this[r]},m.prototype.readInt16LE=function(r,o){r>>>=0,o||rt(r,2,this.length);const l=this[r]|this[r+1]<<8;return 32768&l?4294901760|l:l},m.prototype.readInt16BE=function(r,o){r>>>=0,o||rt(r,2,this.length);const l=this[r+1]|this[r]<<8;return 32768&l?4294901760|l:l},m.prototype.readInt32LE=function(r,o){return r>>>=0,o||rt(r,4,this.length),this[r]|this[r+1]<<8|this[r+2]<<16|this[r+3]<<24},m.prototype.readInt32BE=function(r,o){return r>>>=0,o||rt(r,4,this.length),this[r]<<24|this[r+1]<<16|this[r+2]<<8|this[r+3]},m.prototype.readBigInt64LE=gt(function(r){It(r>>>=0,"offset");const o=this[r],l=this[r+7];return(void 0===o||void 0===l)&&Mt(r,this.length-8),(BigInt(this[r+4]+256*this[r+5]+65536*this[r+6]+(l<<24))<<BigInt(32))+BigInt(o+256*this[++r]+65536*this[++r]+this[++r]*2**24)}),m.prototype.readBigInt64BE=gt(function(r){It(r>>>=0,"offset");const o=this[r],l=this[r+7];(void 0===o||void 0===l)&&Mt(r,this.length-8);const d=(o<<24)+65536*this[++r]+256*this[++r]+this[++r];return(BigInt(d)<<BigInt(32))+BigInt(this[++r]*2**24+65536*this[++r]+256*this[++r]+l)}),m.prototype.readFloatLE=function(r,o){return r>>>=0,o||rt(r,4,this.length),X.read(this,r,!0,23,4)},m.prototype.readFloatBE=function(r,o){return r>>>=0,o||rt(r,4,this.length),X.read(this,r,!1,23,4)},m.prototype.readDoubleLE=function(r,o){return r>>>=0,o||rt(r,8,this.length),X.read(this,r,!0,52,8)},m.prototype.readDoubleBE=function(r,o){return r>>>=0,o||rt(r,8,this.length),X.read(this,r,!1,52,8)},m.prototype.writeUintLE=m.prototype.writeUIntLE=function(r,o,l,d){r=+r,o>>>=0,l>>>=0,d||it(this,r,o,l,Math.pow(2,8*l)-1,0);let b=1,x=0;for(this[o]=255&r;++x<l&&(b*=256);)this[o+x]=r/b&255;return o+l},m.prototype.writeUintBE=m.prototype.writeUIntBE=function(r,o,l,d){r=+r,o>>>=0,l>>>=0,d||it(this,r,o,l,Math.pow(2,8*l)-1,0);let b=l-1,x=1;for(this[o+b]=255&r;--b>=0&&(x*=256);)this[o+b]=r/x&255;return o+l},m.prototype.writeUint8=m.prototype.writeUInt8=function(r,o,l){return r=+r,o>>>=0,l||it(this,r,o,1,255,0),this[o]=255&r,o+1},m.prototype.writeUint16LE=m.prototype.writeUInt16LE=function(r,o,l){return r=+r,o>>>=0,l||it(this,r,o,2,65535,0),this[o]=255&r,this[o+1]=r>>>8,o+2},m.prototype.writeUint16BE=m.prototype.writeUInt16BE=function(r,o,l){return r=+r,o>>>=0,l||it(this,r,o,2,65535,0),this[o]=r>>>8,this[o+1]=255&r,o+2},m.prototype.writeUint32LE=m.prototype.writeUInt32LE=function(r,o,l){return r=+r,o>>>=0,l||it(this,r,o,4,4294967295,0),this[o+3]=r>>>24,this[o+2]=r>>>16,this[o+1]=r>>>8,this[o]=255&r,o+4},m.prototype.writeUint32BE=m.prototype.writeUInt32BE=function(r,o,l){return r=+r,o>>>=0,l||it(this,r,o,4,4294967295,0),this[o]=r>>>24,this[o+1]=r>>>16,this[o+2]=r>>>8,this[o+3]=255&r,o+4},m.prototype.writeBigUInt64LE=gt(function(r,o=0){return re(this,r,o,BigInt(0),BigInt("0xffffffffffffffff"))}),m.prototype.writeBigUInt64BE=gt(function(r,o=0){return kt(this,r,o,BigInt(0),BigInt("0xffffffffffffffff"))}),m.prototype.writeIntLE=function(r,o,l,d){if(r=+r,o>>>=0,!d){const nt=Math.pow(2,8*l-1);it(this,r,o,l,nt-1,-nt)}let b=0,x=1,L=0;for(this[o]=255&r;++b<l&&(x*=256);)r<0&&0===L&&0!==this[o+b-1]&&(L=1),this[o+b]=(r/x>>0)-L&255;return o+l},m.prototype.writeIntBE=function(r,o,l,d){if(r=+r,o>>>=0,!d){const nt=Math.pow(2,8*l-1);it(this,r,o,l,nt-1,-nt)}let b=l-1,x=1,L=0;for(this[o+b]=255&r;--b>=0&&(x*=256);)r<0&&0===L&&0!==this[o+b+1]&&(L=1),this[o+b]=(r/x>>0)-L&255;return o+l},m.prototype.writeInt8=function(r,o,l){return r=+r,o>>>=0,l||it(this,r,o,1,127,-128),r<0&&(r=255+r+1),this[o]=255&r,o+1},m.prototype.writeInt16LE=function(r,o,l){return r=+r,o>>>=0,l||it(this,r,o,2,32767,-32768),this[o]=255&r,this[o+1]=r>>>8,o+2},m.prototype.writeInt16BE=function(r,o,l){return r=+r,o>>>=0,l||it(this,r,o,2,32767,-32768),this[o]=r>>>8,this[o+1]=255&r,o+2},m.prototype.writeInt32LE=function(r,o,l){return r=+r,o>>>=0,l||it(this,r,o,4,2147483647,-2147483648),this[o]=255&r,this[o+1]=r>>>8,this[o+2]=r>>>16,this[o+3]=r>>>24,o+4},m.prototype.writeInt32BE=function(r,o,l){return r=+r,o>>>=0,l||it(this,r,o,4,2147483647,-2147483648),r<0&&(r=4294967295+r+1),this[o]=r>>>24,this[o+1]=r>>>16,this[o+2]=r>>>8,this[o+3]=255&r,o+4},m.prototype.writeBigInt64LE=gt(function(r,o=0){return re(this,r,o,-BigInt("0x8000000000000000"),BigInt("0x7fffffffffffffff"))}),m.prototype.writeBigInt64BE=gt(function(r,o=0){return kt(this,r,o,-BigInt("0x8000000000000000"),BigInt("0x7fffffffffffffff"))}),m.prototype.writeFloatLE=function(r,o,l){return ge(this,r,o,!0,l)},m.prototype.writeFloatBE=function(r,o,l){return ge(this,r,o,!1,l)},m.prototype.writeDoubleLE=function(r,o,l){return Ue(this,r,o,!0,l)},m.prototype.writeDoubleBE=function(r,o,l){return Ue(this,r,o,!1,l)},m.prototype.copy=function(r,o,l,d){if(!m.isBuffer(r))throw new TypeError("argument should be a Buffer");if(l||(l=0),!d&&0!==d&&(d=this.length),o>=r.length&&(o=r.length),o||(o=0),d>0&&d<l&&(d=l),d===l||0===r.length||0===this.length)return 0;if(o<0)throw new RangeError("targetStart out of bounds");if(l<0||l>=this.length)throw new RangeError("Index out of range");if(d<0)throw new RangeError("sourceEnd out of bounds");d>this.length&&(d=this.length),r.length-o<d-l&&(d=r.length-o+l);const b=d-l;return this===r&&"function"==typeof Uint8Array.prototype.copyWithin?this.copyWithin(o,l,d):Uint8Array.prototype.set.call(r,this.subarray(l,d),o),b},m.prototype.fill=function(r,o,l,d){if("string"==typeof r){if("string"==typeof o?(d=o,o=0,l=this.length):"string"==typeof l&&(d=l,l=this.length),void 0!==d&&"string"!=typeof d)throw new TypeError("encoding must be a string");if("string"==typeof d&&!m.isEncoding(d))throw new TypeError("Unknown encoding: "+d);if(1===r.length){const x=r.charCodeAt(0);("utf8"===d&&x<128||"latin1"===d)&&(r=x)}}else"number"==typeof r?r&=255:"boolean"==typeof r&&(r=Number(r));if(o<0||this.length<o||this.length<l)throw new RangeError("Out of range index");if(l<=o)return this;let b;if(o>>>=0,l=void 0===l?this.length:l>>>0,r||(r=0),"number"==typeof r)for(b=o;b<l;++b)this[b]=r;else{const x=m.isBuffer(r)?r:m.from(r,d),L=x.length;if(0===L)throw new TypeError('The value "'+r+'" is invalid for argument "value"');for(b=0;b<l-o;++b)this[b+o]=x[b%L]}return this};const xt={};function Vt(a,r,o){xt[a]=class extends o{constructor(){super(),Object.defineProperty(this,"message",{value:r.apply(this,arguments),writable:!0,configurable:!0}),this.name=`${this.name} [${a}]`,delete this.name}get code(){return a}set code(d){Object.defineProperty(this,"code",{configurable:!0,enumerable:!0,value:d,writable:!0})}toString(){return`${this.name} [${a}]: ${this.message}`}}}function we(a){let r="",o=a.length;const l="-"===a[0]?1:0;for(;o>=l+4;o-=3)r=`_${a.slice(o-3,o)}${r}`;return`${a.slice(0,o)}${r}`}function je(a,r,o,l,d,b){if(a>o||a<r){const x="bigint"==typeof r?"n":"";let L;throw L=b>3?0===r||r===BigInt(0)?`>= 0${x} and < 2${x} ** ${8*(b+1)}${x}`:`>= -(2${x} ** ${8*(b+1)-1}${x}) and < 2 ** ${8*(b+1)-1}${x}`:`>= ${r}${x} and <= ${o}${x}`,new xt.ERR_OUT_OF_RANGE("value",L,a)}!function be(a,r,o){It(r,"offset"),(void 0===a[r]||void 0===a[r+o])&&Mt(r,a.length-(o+1))}(l,d,b)}function It(a,r){if("number"!=typeof a)throw new xt.ERR_INVALID_ARG_TYPE(r,"number",a)}function Mt(a,r,o){throw Math.floor(a)!==a?(It(a,o),new xt.ERR_OUT_OF_RANGE(o||"offset","an integer",a)):r<0?new xt.ERR_BUFFER_OUT_OF_BOUNDS:new xt.ERR_OUT_OF_RANGE(o||"offset",`>= ${o?1:0} and <= ${r}`,a)}Vt("ERR_BUFFER_OUT_OF_BOUNDS",function(a){return a?`${a} is outside of buffer bounds`:"Attempt to access memory outside buffer bounds"},RangeError),Vt("ERR_INVALID_ARG_TYPE",function(a,r){return`The "${a}" argument must be of type number. Received type ${typeof r}`},TypeError),Vt("ERR_OUT_OF_RANGE",function(a,r,o){let l=`The value of "${a}" is out of range.`,d=o;return Number.isInteger(o)&&Math.abs(o)>2**32?d=we(String(o)):"bigint"==typeof o&&(d=String(o),(o>BigInt(2)**BigInt(32)||o<-(BigInt(2)**BigInt(32)))&&(d=we(d)),d+="n"),l+=` It must be ${r}. Received ${d}`,l},RangeError);const ie=/[^+/0-9A-Za-z-_]/g;function Yt(a,r){let o;r=r||1/0;const l=a.length;let d=null;const b=[];for(let x=0;x<l;++x){if(o=a.charCodeAt(x),o>55295&&o<57344){if(!d){if(o>56319){(r-=3)>-1&&b.push(239,191,189);continue}if(x+1===l){(r-=3)>-1&&b.push(239,191,189);continue}d=o;continue}if(o<56320){(r-=3)>-1&&b.push(239,191,189),d=o;continue}o=65536+(d-55296<<10|o-56320)}else d&&(r-=3)>-1&&b.push(239,191,189);if(d=null,o<128){if((r-=1)<0)break;b.push(o)}else if(o<2048){if((r-=2)<0)break;b.push(o>>6|192,63&o|128)}else if(o<65536){if((r-=3)<0)break;b.push(o>>12|224,o>>6&63|128,63&o|128)}else{if(!(o<1114112))throw new Error("Invalid code point");if((r-=4)<0)break;b.push(o>>18|240,o>>12&63|128,o>>6&63|128,63&o|128)}}return b}function ve(a){return ct.toByteArray(function Gt(a){if((a=(a=a.split("=")[0]).trim().replace(ie,"")).length<2)return"";for(;a.length%4!=0;)a+="=";return a}(a))}function Tt(a,r,o,l){let d;for(d=0;d<l&&!(d+o>=r.length||d>=a.length);++d)r[d+o]=a[d];return d}function W(a,r){return a instanceof r||null!=a&&null!=a.constructor&&null!=a.constructor.name&&a.constructor.name===r.name}function Ot(a){return a!=a}const ln=function(){const a="0123456789abcdef",r=new Array(256);for(let o=0;o<16;++o){const l=16*o;for(let d=0;d<16;++d)r[l+d]=a[o]+a[d]}return r}();function gt(a){return typeof BigInt>"u"?hn:a}function hn(){throw new Error("BigInt not supported")}},8461:(ne,yt)=>{yt.read=function(z,K,ct,X,G){var D,S,$=8*G-X-1,m=(1<<$)-1,J=m>>1,Q=-7,q=ct?G-1:0,lt=ct?-1:1,N=z[K+q];for(q+=lt,D=N&(1<<-Q)-1,N>>=-Q,Q+=$;Q>0;D=256*D+z[K+q],q+=lt,Q-=8);for(S=D&(1<<-Q)-1,D>>=-Q,Q+=X;Q>0;S=256*S+z[K+q],q+=lt,Q-=8);if(0===D)D=1-J;else{if(D===m)return S?NaN:1/0*(N?-1:1);S+=Math.pow(2,X),D-=J}return(N?-1:1)*S*Math.pow(2,D-X)},yt.write=function(z,K,ct,X,G,D){var S,$,m,J=8*D-G-1,Q=(1<<J)-1,q=Q>>1,lt=23===G?Math.pow(2,-24)-Math.pow(2,-77):0,N=X?0:D-1,M=X?1:-1,Y=K<0||0===K&&1/K<0?1:0;for(K=Math.abs(K),isNaN(K)||K===1/0?($=isNaN(K)?1:0,S=Q):(S=Math.floor(Math.log(K)/Math.LN2),K*(m=Math.pow(2,-S))<1&&(S--,m*=2),(K+=S+q>=1?lt/m:lt*Math.pow(2,1-q))*m>=2&&(S++,m/=2),S+q>=Q?($=0,S=Q):S+q>=1?($=(K*m-1)*Math.pow(2,G),S+=q):($=K*Math.pow(2,q-1)*Math.pow(2,G),S=0));G>=8;z[ct+N]=255&$,N+=M,$/=256,G-=8);for(S=S<<G|$,J+=G;J>0;z[ct+N]=255&S,N+=M,S/=256,J-=8);z[ct+N-M]|=128*Y}},5861:(ne,yt,z)=>{"use strict";function K(X,G,D,S,$,m,J){try{var Q=X[m](J),q=Q.value}catch(lt){return void D(lt)}Q.done?G(q):Promise.resolve(q).then(S,$)}function ct(X){return function(){var G=this,D=arguments;return new Promise(function(S,$){var m=X.apply(G,D);function J(q){K(m,S,$,J,Q,"next",q)}function Q(q){K(m,S,$,J,Q,"throw",q)}J(void 0)})}}z.d(yt,{Z:()=>ct})}}]);