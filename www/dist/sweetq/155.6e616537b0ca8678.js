(self.webpackChunksweetq=self.webpackChunksweetq||[]).push([[155],{3713:(lt,me,Y)=>{"use strict";Y.d(me,{Z:()=>G,y:()=>Q});var D=Y(8274),ce=Y(1481);let Q=(()=>{class T{constructor(j){this.sanitizer=j}transform(j){return this.sanitizer.bypassSecurityTrustResourceUrl(j)}}return T.\u0275fac=function(j){return new(j||T)(D.Y36(ce.H7,16))},T.\u0275pipe=D.Yjl({name:"safe",type:T,pure:!0}),T})(),G=(()=>{class T{}return T.\u0275fac=function(j){return new(j||T)},T.\u0275mod=D.oAB({type:T}),T.\u0275inj=D.cJS({}),T})()},9807:(lt,me,Y)=>{"use strict";Y.d(me,{s:()=>Lr});var D=Y(5861),ce=Y(529);const Q_spotify={clientId:"MDExNzEzNDkwZDY4NGYyNmFmOWRhYjRiNzc4OWI1YzU=",clientSecret:"OTc5YTM2NTZiNWJmNGY0OGIzNzA2ZDA2OGM2OTY3NTU=",nextRelease:"0quqDx9Qf79Gt8GC4sZQn5"};var G=Y(3172);const T=typeof globalThis<"u"?globalThis:typeof self<"u"?self:typeof window<"u"?window:global,O=Object.keys,j=Array.isArray;function m(t,e){return"object"!=typeof e||O(e).forEach(function(n){t[n]=e[n]}),t}typeof Promise>"u"||T.Promise||(T.Promise=Promise);const re=Object.getPrototypeOf,J={}.hasOwnProperty;function W(t,e){return J.call(t,e)}function le(t,e){"function"==typeof e&&(e=e(re(t))),(typeof Reflect>"u"?O:Reflect.ownKeys)(e).forEach(n=>{$(t,n,e[n])})}const M=Object.defineProperty;function $(t,e,n,o){M(t,e,m(n&&W(n,"get")&&"function"==typeof n.get?{get:n.get,set:n.set,configurable:!0}:{value:n,configurable:!0,writable:!0},o))}function V(t){return{from:function(e){return t.prototype=Object.create(e.prototype),$(t.prototype,"constructor",t),{extend:le.bind(null,t.prototype)}}}}const he=Object.getOwnPropertyDescriptor;function ye(t,e){let n;return he(t,e)||(n=re(t))&&ye(n,e)}const se=[].slice;function de(t,e,n){return se.call(t,e,n)}function Se(t,e){return e(t)}function fe(t){if(!t)throw new Error("Assertion Failed")}function Ce(t){T.setImmediate?setImmediate(t):setTimeout(t,0)}function ht(t,e){return t.reduce((n,o,s)=>{var u=e(o,s);return u&&(n[u[0]]=u[1]),n},{})}function Fe(t,e){if(W(t,e))return t[e];if(!e)return t;if("string"!=typeof e){for(var n=[],o=0,s=e.length;o<s;++o){var u=Fe(t,e[o]);n.push(u)}return n}var c=e.indexOf(".");if(-1!==c){var f=t[e.substr(0,c)];return void 0===f?void 0:Fe(f,e.substr(c+1))}}function Be(t,e,n){if(t&&void 0!==e&&(!("isFrozen"in Object)||!Object.isFrozen(t)))if("string"!=typeof e&&"length"in e){fe("string"!=typeof n&&"length"in n);for(var o=0,s=e.length;o<s;++o)Be(t,e[o],n[o])}else{var u=e.indexOf(".");if(-1!==u){var c=e.substr(0,u),f=e.substr(u+1);if(""===f)void 0===n?j(t)&&!isNaN(parseInt(c))?t.splice(c,1):delete t[c]:t[c]=n;else{var h=t[c];h&&W(t,c)||(h=t[c]={}),Be(h,f,n)}}else void 0===n?j(t)&&!isNaN(parseInt(e))?t.splice(e,1):delete t[e]:t[e]=n}}function Tt(t){var e={};for(var n in t)W(t,n)&&(e[n]=t[n]);return e}const tn=[].concat;function Ot(t){return tn.apply([],t)}const Rt="Boolean,String,Date,RegExp,Blob,File,FileList,FileSystemFileHandle,ArrayBuffer,DataView,Uint8ClampedArray,ImageBitmap,ImageData,Map,Set,CryptoKey".split(",").concat(Ot([8,16,32,64].map(t=>["Int","Uint","Float"].map(e=>e+t+"Array")))).filter(t=>T[t]),nn=Rt.map(t=>T[t]);ht(Rt,t=>[t,!0]);let Pe=null;function Ne(t){Pe=typeof WeakMap<"u"&&new WeakMap;const e=ft(t);return Pe=null,e}function ft(t){if(!t||"object"!=typeof t)return t;let e=Pe&&Pe.get(t);if(e)return e;if(j(t)){e=[],Pe&&Pe.set(t,e);for(var n=0,o=t.length;n<o;++n)e.push(ft(t[n]))}else if(nn.indexOf(t.constructor)>=0)e=t;else{const u=re(t);for(var s in e=u===Object.prototype?{}:Object.create(u),Pe&&Pe.set(t,e),t)W(t,s)&&(e[s]=ft(t[s]))}return e}const{toString:rn}={};function dt(t){return rn.call(t).slice(8,-1)}const pt=typeof Symbol<"u"?Symbol.iterator:"@@iterator",on="symbol"==typeof pt?function(t){var e;return null!=t&&(e=t[pt])&&e.apply(t)}:function(){return null},te={};function ie(t){var e,n,o,s;if(1===arguments.length){if(j(t))return t.slice();if(this===te&&"string"==typeof t)return[t];if(s=on(t)){for(n=[];!(o=s.next()).done;)n.push(o.value);return n}if(null==t)return[t];if("number"==typeof(e=t.length)){for(n=new Array(e);e--;)n[e]=t[e];return n}return[t]}for(e=arguments.length,n=new Array(e);e--;)n[e]=arguments[e];return n}const tt=typeof Symbol<"u"?t=>"AsyncFunction"===t[Symbol.toStringTag]:()=>!1;var ke=typeof location<"u"&&/^(http|https):\/\/(localhost|127\.0\.0\.1)/.test(location.href);function yt(t,e){ke=t,mt=e}var mt=()=>!0;const Kt=!new Error("").stack;function xe(){if(Kt)try{throw new Error}catch(t){return t}return new Error}function ze(t,e){var n=t.stack;return n?(e=e||0,0===n.indexOf(t.name)&&(e+=(t.name+t.message).split("\n").length),n.split("\n").slice(e).filter(mt).map(o=>"\n"+o).join("")):""}var gt=["Unknown","Constraint","Data","TransactionInactive","ReadOnly","Version","NotFound","InvalidState","InvalidAccess","Abort","Timeout","QuotaExceeded","Syntax","DataClone"],wt=["Modify","Bulk","OpenFailed","VersionChange","Schema","Upgrade","InvalidTable","MissingAPI","NoSuchDatabase","InvalidArgument","SubTransaction","Unsupported","Internal","DatabaseClosed","PrematureCommit","ForeignAwait"].concat(gt),Dt={VersionChanged:"Database version changed by other database connection",DatabaseClosed:"Database has been closed",Abort:"Transaction aborted",TransactionInactive:"Transaction has already completed or failed",MissingAPI:"IndexedDB API missing. Please visit https://tinyurl.com/y2uuvskb"};function Ie(t,e){this._e=xe(),this.name=t,this.message=e}function Me(t,e){return t+". Errors: "+Object.keys(e).map(n=>e[n].toString()).filter((n,o,s)=>s.indexOf(n)===o).join("\n")}function nt(t,e,n,o){this._e=xe(),this.failures=e,this.failedKeys=o,this.successCount=n,this.message=Me(t,e)}function Ye(t,e){this._e=xe(),this.name="BulkError",this.failures=Object.keys(e).map(n=>e[n]),this.failuresByPos=e,this.message=Me(t,e)}V(Ie).from(Error).extend({stack:{get:function(){return this._stack||(this._stack=this.name+": "+this.message+ze(this._e,2))}},toString:function(){return this.name+": "+this.message}}),V(nt).from(Ie),V(Ye).from(Ie);var Ge=wt.reduce((t,e)=>(t[e]=e+"Error",t),{});const sn=Ie;var N=wt.reduce((t,e)=>{var n=e+"Error";function o(s,u){this._e=xe(),this.name=n,s?"string"==typeof s?(this.message=`${s}${u?"\n "+u:""}`,this.inner=u||null):"object"==typeof s&&(this.message=`${s.name} ${s.message}`,this.inner=s):(this.message=Dt[e]||n,this.inner=null)}return V(o).from(sn),t[e]=o,t},{});N.Syntax=SyntaxError,N.Type=TypeError,N.Range=RangeError;var bt=gt.reduce((t,e)=>(t[e+"Error"]=N[e],t),{}),Oe=wt.reduce((t,e)=>(-1===["Syntax","Type","Range"].indexOf(e)&&(t[e+"Error"]=N[e]),t),{});function z(){}function Re(t){return t}function an(t,e){return null==t||t===Re?e:function(n){return e(t(n))}}function ge(t,e){return function(){t.apply(this,arguments),e.apply(this,arguments)}}function un(t,e){return t===z?e:function(){var n=t.apply(this,arguments);void 0!==n&&(arguments[0]=n);var o=this.onsuccess,s=this.onerror;this.onsuccess=null,this.onerror=null;var u=e.apply(this,arguments);return o&&(this.onsuccess=this.onsuccess?ge(o,this.onsuccess):o),s&&(this.onerror=this.onerror?ge(s,this.onerror):s),void 0!==u?u:n}}function a(t,e){return t===z?e:function(){t.apply(this,arguments);var n=this.onsuccess,o=this.onerror;this.onsuccess=this.onerror=null,e.apply(this,arguments),n&&(this.onsuccess=this.onsuccess?ge(n,this.onsuccess):n),o&&(this.onerror=this.onerror?ge(o,this.onerror):o)}}function r(t,e){return t===z?e:function(n){var o=t.apply(this,arguments);m(n,o);var s=this.onsuccess,u=this.onerror;this.onsuccess=null,this.onerror=null;var c=e.apply(this,arguments);return s&&(this.onsuccess=this.onsuccess?ge(s,this.onsuccess):s),u&&(this.onerror=this.onerror?ge(u,this.onerror):u),void 0===o?void 0===c?void 0:c:m(o,c)}}function i(t,e){return t===z?e:function(){return!1!==e.apply(this,arguments)&&t.apply(this,arguments)}}function l(t,e){return t===z?e:function(){var n=t.apply(this,arguments);if(n&&"function"==typeof n.then){for(var o=this,s=arguments.length,u=new Array(s);s--;)u[s]=arguments[s];return n.then(function(){return e.apply(o,u)})}return e.apply(this,arguments)}}Oe.ModifyError=nt,Oe.DexieError=Ie,Oe.BulkError=Ye;var d={};const[b,v,q]=typeof Promise>"u"?[]:(()=>{let t=Promise.resolve();if(typeof crypto>"u"||!crypto.subtle)return[t,re(t),t];const e=crypto.subtle.digest("SHA-512",new Uint8Array([0]));return[e,re(e),t]})(),ne=v&&v.then,Z=b&&b.constructor,X=!!q;var H=!1,hr=q?()=>{q.then(Mt)}:T.setImmediate?setImmediate.bind(null,Mt):T.MutationObserver?()=>{var t=document.createElement("div");new MutationObserver(()=>{Mt(),t=null}).observe(t,{attributes:!0}),t.setAttribute("i","1")}:()=>{setTimeout(Mt,0)},vt=function(t,e){_t.push([t,e]),Ut&&(hr(),Ut=!1)},cn=!0,Ut=!0,Ve=[],jt=[],ln=null,hn=Re,rt={id:"global",global:!0,ref:0,unhandleds:[],onunhandled:Gn,pgp:!1,env:{},finalize:function(){this.unhandleds.forEach(t=>{try{Gn(t[0],t[1])}catch{}})}},U=rt,_t=[],He=0,Nt=[];function P(t){if("object"!=typeof this)throw new TypeError("Promises must be constructed via new");this._listeners=[],this.onuncatched=z,this._lib=!1;var e=this._PSD=U;if(ke&&(this._stackHolder=xe(),this._prev=null,this._numPrev=0),"function"!=typeof t){if(t!==d)throw new TypeError("Not a function");return this._state=arguments[1],this._value=arguments[2],void(!1===this._state&&dn(this,this._value))}this._state=null,this._value=null,++e.ref,Mn(this,t)}const fn={get:function(){var t=U,e=qt;function n(o,s){var u=!t.global&&(t!==U||e!==qt);const c=u&&!Ke();var f=new P((h,w)=>{pn(this,new Nn(zt(o,t,u,c),zt(s,t,u,c),h,w,t))});return ke&&qn(f,this),f}return n.prototype=d,n},set:function(t){$(this,"then",t&&t.prototype===d?fn:{get:function(){return t},set:fn.set})}};function Nn(t,e,n,o,s){this.onFulfilled="function"==typeof t?t:null,this.onRejected="function"==typeof e?e:null,this.resolve=n,this.reject=o,this.psd=s}function Mn(t,e){try{e(n=>{if(null===t._state){if(n===t)throw new TypeError("A promise cannot be resolved with itself.");var o=t._lib&&xt();n&&"function"==typeof n.then?Mn(t,(s,u)=>{n instanceof P?n._then(s,u):n.then(s,u)}):(t._state=!0,t._value=n,$n(t)),o&&Et()}},dn.bind(null,t))}catch(n){dn(t,n)}}function dn(t,e){if(jt.push(e),null===t._state){var n=t._lib&&xt();e=hn(e),t._state=!1,t._value=e,ke&&null!==e&&"object"==typeof e&&!e._promise&&function(o,s,u){try{(()=>{var o=ye(e,"stack");e._promise=t,$(e,"stack",{get:()=>H?o&&(o.get?o.get.apply(e):o.value):t.stack})}).apply(null,void 0)}catch(c){}}(),o=t,Ve.some(s=>s._value===o._value)||Ve.push(o),$n(t),n&&Et()}var o}function $n(t){var e=t._listeners;t._listeners=[];for(var n=0,o=e.length;n<o;++n)pn(t,e[n]);var s=t._PSD;--s.ref||s.finalize(),0===He&&(++He,vt(()=>{0==--He&&yn()},[]))}function pn(t,e){if(null!==t._state){var n=t._state?e.onFulfilled:e.onRejected;if(null===n)return(t._state?e.resolve:e.reject)(t._value);++e.psd.ref,++He,vt(fr,[n,t,e])}else t._listeners.push(e)}function fr(t,e,n){try{ln=e;var o,s=e._value;e._state?o=t(s):(jt.length&&(jt=[]),o=t(s),-1===jt.indexOf(s)&&function(u){for(var c=Ve.length;c;)if(Ve[--c]._value===u._value)return void Ve.splice(c,1)}(e)),n.resolve(o)}catch(u){n.reject(u)}finally{ln=null,0==--He&&yn(),--n.psd.ref||n.psd.finalize()}}function Ln(t,e,n){if(e.length===n)return e;var o="";if(!1===t._state){var s,u,c=t._value;null!=c?(s=c.name||"Error",u=c.message||c,o=ze(c,0)):(s=c,u=""),e.push(s+(u?": "+u:"")+o)}return ke&&((o=ze(t._stackHolder,2))&&-1===e.indexOf(o)&&e.push(o),t._prev&&Ln(t._prev,e,n)),e}function qn(t,e){var n=e?e._numPrev+1:0;n<100&&(t._prev=e,t._numPrev=n)}function Mt(){xt()&&Et()}function xt(){var t=cn;return cn=!1,Ut=!1,t}function Et(){var t,e,n;do{for(;_t.length>0;)for(t=_t,_t=[],n=t.length,e=0;e<n;++e){var o=t[e];o[0].apply(null,o[1])}}while(_t.length>0);cn=!0,Ut=!0}function yn(){var t=Ve;Ve=[],t.forEach(o=>{o._PSD.onunhandled.call(null,o._value,o)});for(var e=Nt.slice(0),n=e.length;n;)e[--n]()}function $t(t){return new P(d,!1,t)}function oe(t,e){var n=U;return function(){var o=xt(),s=U;try{return Le(n,!0),t.apply(this,arguments)}catch(u){e&&e(u)}finally{Le(s,!1),o&&Et()}}}le(P.prototype,{then:fn,_then:function(t,e){pn(this,new Nn(null,null,t,e,U))},catch:function(t){if(1===arguments.length)return this.then(null,t);var e=arguments[0],n=arguments[1];return this.then(null,"function"==typeof e?o=>o instanceof e?n(o):$t(o):o=>o&&o.name===e?n(o):$t(o))},finally:function(t){return this.then(e=>(t(),e),e=>(t(),$t(e)))},stack:{get:function(){if(this._stack)return this._stack;try{H=!0;var t=Ln(this,[],20).join("\nFrom previous: ");return null!==this._state&&(this._stack=t),t}finally{H=!1}}},timeout:function(t,e){return t<1/0?new P((n,o)=>{var s=setTimeout(()=>o(new N.Timeout(e)),t);this.then(n,o).finally(clearTimeout.bind(null,s))}):this}}),typeof Symbol<"u"&&Symbol.toStringTag&&$(P.prototype,Symbol.toStringTag,"Dexie.Promise"),rt.env=Wn(),le(P,{all:function(){var t=ie.apply(null,arguments).map(Wt);return new P(function(e,n){0===t.length&&e([]);var o=t.length;t.forEach((s,u)=>P.resolve(s).then(c=>{t[u]=c,--o||e(t)},n))})},resolve:t=>{if(t instanceof P)return t;if(t&&"function"==typeof t.then)return new P((n,o)=>{t.then(n,o)});var e=new P(d,!0,t);return qn(e,ln),e},reject:$t,race:function(){var t=ie.apply(null,arguments).map(Wt);return new P((e,n)=>{t.map(o=>P.resolve(o).then(e,n))})},PSD:{get:()=>U,set:t=>U=t},totalEchoes:{get:()=>qt},newPSD:$e,usePSD:ot,scheduler:{get:()=>vt,set:t=>{vt=t}},rejectionMapper:{get:()=>hn,set:t=>{hn=t}},follow:(t,e)=>new P((n,o)=>$e((s,u)=>{var c=U;c.unhandleds=[],c.onunhandled=u,c.finalize=ge(function(){var f;f=()=>{0===this.unhandleds.length?s():u(this.unhandleds[0])},Nt.push(function h(){f(),Nt.splice(Nt.indexOf(h),1)}),++He,vt(()=>{0==--He&&yn()},[])},c.finalize),t()},e,n,o))}),Z&&(Z.allSettled&&$(P,"allSettled",function(){const t=ie.apply(null,arguments).map(Wt);return new P(e=>{0===t.length&&e([]);let n=t.length;const o=new Array(n);t.forEach((s,u)=>P.resolve(s).then(c=>o[u]={status:"fulfilled",value:c},c=>o[u]={status:"rejected",reason:c}).then(()=>--n||e(o)))})}),Z.any&&typeof AggregateError<"u"&&$(P,"any",function(){const t=ie.apply(null,arguments).map(Wt);return new P((e,n)=>{0===t.length&&n(new AggregateError([]));let o=t.length;const s=new Array(o);t.forEach((u,c)=>P.resolve(u).then(f=>e(f),f=>{s[c]=f,--o||n(new AggregateError(s))}))})}));const we={awaits:0,echoes:0,id:0};var dr=0,Lt=[],mn=0,qt=0,pr=0;function $e(t,e,n,o){var s=U,u=Object.create(s);u.parent=s,u.ref=0,u.global=!1,u.id=++pr;var c=rt.env;u.env=X?{Promise:P,PromiseProp:{value:P,configurable:!0,writable:!0},all:P.all,race:P.race,allSettled:P.allSettled,any:P.any,resolve:P.resolve,reject:P.reject,nthen:Yn(c.nthen,u),gthen:Yn(c.gthen,u)}:{},e&&m(u,e),++s.ref,u.finalize=function(){--this.parent.ref||this.parent.finalize()};var f=ot(u,t,n,o);return 0===u.ref&&u.finalize(),f}function it(){return we.id||(we.id=++dr),++we.awaits,we.echoes+=100,we.id}function Ke(){return!!we.awaits&&(0==--we.awaits&&(we.id=0),we.echoes=100*we.awaits,!0)}function Wt(t){return we.echoes&&t&&t.constructor===Z?(it(),t.then(e=>(Ke(),e),e=>(Ke(),pe(e)))):t}function yr(t){++qt,we.echoes&&0!=--we.echoes||(we.echoes=we.id=0),Lt.push(U),Le(t,!0)}function mr(){var t=Lt[Lt.length-1];Lt.pop(),Le(t,!1)}function Le(t,e){var n=U;if((e?!we.echoes||mn++&&t===U:!mn||--mn&&t===U)||zn(e?yr.bind(null,t):mr),t!==U&&(U=t,n===rt&&(rt.env=Wn()),X)){var o=rt.env.Promise,s=t.env;v.then=s.nthen,o.prototype.then=s.gthen,(n.global||t.global)&&(Object.defineProperty(T,"Promise",s.PromiseProp),o.all=s.all,o.race=s.race,o.resolve=s.resolve,o.reject=s.reject,s.allSettled&&(o.allSettled=s.allSettled),s.any&&(o.any=s.any))}}function Wn(){var t=T.Promise;return X?{Promise:t,PromiseProp:Object.getOwnPropertyDescriptor(T,"Promise"),all:t.all,race:t.race,allSettled:t.allSettled,any:t.any,resolve:t.resolve,reject:t.reject,nthen:v.then,gthen:t.prototype.then}:{}}function ot(t,e,n,o,s){var u=U;try{return Le(t,!0),e(n,o,s)}finally{Le(u,!1)}}function zn(t){ne.call(b,t)}function zt(t,e,n,o){return"function"!=typeof t?t:function(){var s=U;n&&it(),Le(e,!0);try{return t.apply(this,arguments)}finally{Le(s,!1),o&&zn(Ke)}}}function Yn(t,e){return function(n,o){return t.call(this,zt(n,e),zt(o,e))}}function Gn(t,e){var n;try{n=e.onuncatched(t)}catch{}if(!1!==n)try{var o,s={promise:e,reason:t};if(T.document&&document.createEvent?((o=document.createEvent("Event")).initEvent("unhandledrejection",!0,!0),m(o,s)):T.CustomEvent&&m(o=new CustomEvent("unhandledrejection",{detail:s}),s),o&&T.dispatchEvent&&(dispatchEvent(o),!T.PromiseRejectionEvent&&T.onunhandledrejection))try{T.onunhandledrejection(o)}catch{}ke&&o&&!o.defaultPrevented&&console.warn(`Unhandled rejection: ${t.stack||t}`)}catch{}}-1===(""+ne).indexOf("[native code]")&&(it=Ke=z);var pe=P.reject;function gn(t,e,n,o){if(t.idbdb&&(t._state.openComplete||U.letThrough||t._vip)){var s=t._createTransaction(e,n,t._dbSchema);try{s.create(),t._state.PR1398_maxLoop=3}catch(u){return u.name===Ge.InvalidState&&t.isOpen()&&--t._state.PR1398_maxLoop>0?(console.warn("Dexie: Need to reopen db"),t._close(),t.open().then(()=>gn(t,e,n,o))):pe(u)}return s._promise(e,(u,c)=>$e(()=>(U.trans=s,o(u,c,s)))).then(u=>s._completion.then(()=>u))}if(t._state.openComplete)return pe(new N.DatabaseClosed(t._state.dbOpenError));if(!t._state.isBeingOpened){if(!t._options.autoOpen)return pe(new N.DatabaseClosed);t.open().catch(z)}return t._state.dbReadyPromise.then(()=>gn(t,e,n,o))}const Ze=String.fromCharCode(65535),De="Invalid key provided. Keys must be of type string, number, Date or Array<string | number | Date>.",Bt=[],Yt=typeof navigator<"u"&&/(MSIE|Trident|Edge)/.test(navigator.userAgent),gr=Yt,wr=Yt,Vn=t=>!/(dexie\.js|dexie\.min\.js)/.test(t);function Qe(t,e){return t?e?function(){return t.apply(this,arguments)&&e.apply(this,arguments)}:t:e}const Hn={type:3,lower:-1/0,lowerOpen:!1,upper:[[]],upperOpen:!1};function Gt(t){return"string"!=typeof t||/\./.test(t)?e=>e:e=>(void 0===e[t]&&t in e&&delete(e=Ne(e))[t],e)}class br{_trans(e,n,o){const s=this._tx||U.trans,u=this.name;function c(h,w,p){if(!p.schema[u])throw new N.NotFound("Table "+u+" not part of transaction");return n(p.idbtrans,p)}const f=xt();try{return s&&s.db===this.db?s===U.trans?s._promise(e,c,o):$e(()=>s._promise(e,c,o),{trans:s,transless:U.transless||U}):gn(this.db,e,[this.name],c)}finally{f&&Et()}}get(e,n){return e&&e.constructor===Object?this.where(e).first(n):this._trans("readonly",o=>this.core.get({trans:o,key:e}).then(s=>this.hook.reading.fire(s))).then(n)}where(e){if("string"==typeof e)return new this.db.WhereClause(this,e);if(j(e))return new this.db.WhereClause(this,`[${e.join("+")}]`);const n=O(e);if(1===n.length)return this.where(n[0]).equals(e[n[0]]);const o=this.schema.indexes.concat(this.schema.primKey).filter(w=>w.compound&&n.every(p=>w.keyPath.indexOf(p)>=0)&&w.keyPath.every(p=>n.indexOf(p)>=0))[0];if(o&&this.db._maxKey!==Ze)return this.where(o.name).equals(o.keyPath.map(w=>e[w]));!o&&ke&&console.warn(`The query ${JSON.stringify(e)} on ${this.name} would benefit of a compound index [${n.join("+")}]`);const{idxByName:s}=this.schema,u=this.db._deps.indexedDB;function c(w,p){try{return 0===u.cmp(w,p)}catch{return!1}}const[f,h]=n.reduce(([w,p],g)=>{const y=s[g],_=e[g];return[w||y,w||!y?Qe(p,y&&y.multi?k=>{const B=Fe(k,g);return j(B)&&B.some(I=>c(_,I))}:k=>c(_,Fe(k,g))):p]},[null,null]);return f?this.where(f.name).equals(e[f.keyPath]).filter(h):o?this.filter(h):this.where(n).equals("")}filter(e){return this.toCollection().and(e)}count(e){return this.toCollection().count(e)}offset(e){return this.toCollection().offset(e)}limit(e){return this.toCollection().limit(e)}each(e){return this.toCollection().each(e)}toArray(e){return this.toCollection().toArray(e)}toCollection(){return new this.db.Collection(new this.db.WhereClause(this))}orderBy(e){return new this.db.Collection(new this.db.WhereClause(this,j(e)?`[${e.join("+")}]`:e))}reverse(){return this.toCollection().reverse()}mapToClass(e){this.schema.mappedClass=e;const n=o=>{if(!o)return o;const s=Object.create(e.prototype);for(var u in o)if(W(o,u))try{s[u]=o[u]}catch{}return s};return this.schema.readHook&&this.hook.reading.unsubscribe(this.schema.readHook),this.schema.readHook=n,this.hook("reading",n),e}defineClass(){return this.mapToClass(function(e){m(this,e)})}add(e,n){const{auto:o,keyPath:s}=this.schema.primKey;let u=e;return s&&o&&(u=Gt(s)(e)),this._trans("readwrite",c=>this.core.mutate({trans:c,type:"add",keys:null!=n?[n]:null,values:[u]})).then(c=>c.numFailures?P.reject(c.failures[0]):c.lastResult).then(c=>{if(s)try{Be(e,s,c)}catch{}return c})}update(e,n){if("object"!=typeof e||j(e))return this.where(":id").equals(e).modify(n);{const o=Fe(e,this.schema.primKey.keyPath);if(void 0===o)return pe(new N.InvalidArgument("Given object does not contain its primary key"));try{"function"!=typeof n?O(n).forEach(s=>{Be(e,s,n[s])}):n(e,{value:e,primKey:o})}catch{}return this.where(":id").equals(o).modify(n)}}put(e,n){const{auto:o,keyPath:s}=this.schema.primKey;let u=e;return s&&o&&(u=Gt(s)(e)),this._trans("readwrite",c=>this.core.mutate({trans:c,type:"put",values:[u],keys:null!=n?[n]:null})).then(c=>c.numFailures?P.reject(c.failures[0]):c.lastResult).then(c=>{if(s)try{Be(e,s,c)}catch{}return c})}delete(e){return this._trans("readwrite",n=>this.core.mutate({trans:n,type:"delete",keys:[e]})).then(n=>n.numFailures?P.reject(n.failures[0]):void 0)}clear(){return this._trans("readwrite",e=>this.core.mutate({trans:e,type:"deleteRange",range:Hn})).then(e=>e.numFailures?P.reject(e.failures[0]):void 0)}bulkGet(e){return this._trans("readonly",n=>this.core.getMany({keys:e,trans:n}).then(o=>o.map(s=>this.hook.reading.fire(s))))}bulkAdd(e,n,o){const s=Array.isArray(n)?n:void 0,u=(o=o||(s?void 0:n))?o.allKeys:void 0;return this._trans("readwrite",c=>{const{auto:f,keyPath:h}=this.schema.primKey;if(h&&s)throw new N.InvalidArgument("bulkAdd(): keys argument invalid on tables with inbound keys");if(s&&s.length!==e.length)throw new N.InvalidArgument("Arguments objects and keys must have the same length");const w=e.length;let p=h&&f?e.map(Gt(h)):e;return this.core.mutate({trans:c,type:"add",keys:s,values:p,wantResults:u}).then(({numFailures:g,results:y,lastResult:_,failures:k})=>{if(0===g)return u?y:_;throw new Ye(`${this.name}.bulkAdd(): ${g} of ${w} operations failed`,k)})})}bulkPut(e,n,o){const s=Array.isArray(n)?n:void 0,u=(o=o||(s?void 0:n))?o.allKeys:void 0;return this._trans("readwrite",c=>{const{auto:f,keyPath:h}=this.schema.primKey;if(h&&s)throw new N.InvalidArgument("bulkPut(): keys argument invalid on tables with inbound keys");if(s&&s.length!==e.length)throw new N.InvalidArgument("Arguments objects and keys must have the same length");const w=e.length;let p=h&&f?e.map(Gt(h)):e;return this.core.mutate({trans:c,type:"put",keys:s,values:p,wantResults:u}).then(({numFailures:g,results:y,lastResult:_,failures:k})=>{if(0===g)return u?y:_;throw new Ye(`${this.name}.bulkPut(): ${g} of ${w} operations failed`,k)})})}bulkDelete(e){const n=e.length;return this._trans("readwrite",o=>this.core.mutate({trans:o,type:"delete",keys:e})).then(({numFailures:o,lastResult:s,failures:u})=>{if(0===o)return s;throw new Ye(`${this.name}.bulkDelete(): ${o} of ${n} operations failed`,u)})}}function kt(t){var e={},n=function(f,h){if(h){for(var w=arguments.length,p=new Array(w-1);--w;)p[w-1]=arguments[w];return e[f].subscribe.apply(null,p),t}if("string"==typeof f)return e[f]};n.addEventType=u;for(var o=1,s=arguments.length;o<s;++o)u(arguments[o]);return n;function u(f,h,w){if("object"==typeof f)return function c(f){O(f).forEach(function(h){var w=f[h];if(j(w))u(h,f[h][0],f[h][1]);else{if("asap"!==w)throw new N.InvalidArgument("Invalid event config");var p=u(h,Re,function(){for(var g=arguments.length,y=new Array(g);g--;)y[g]=arguments[g];p.subscribers.forEach(function(_){Ce(function(){_.apply(null,y)})})})}})}(f);h||(h=i),w||(w=z);var p={subscribers:[],fire:w,subscribe:function(g){-1===p.subscribers.indexOf(g)&&(p.subscribers.push(g),p.fire=h(p.fire,g))},unsubscribe:function(g){p.subscribers=p.subscribers.filter(function(y){return y!==g}),p.fire=p.subscribers.reduce(h,w)}};return e[f]=n[f]=p,p}}function It(t,e){return V(e).from({prototype:t}),e}function st(t,e){return!(t.filter||t.algorithm||t.or)&&(e?t.justLimit:!t.replayFilter)}function wn(t,e){t.filter=Qe(t.filter,e)}function bn(t,e,n){var o=t.replayFilter;t.replayFilter=o?()=>Qe(o(),e()):e,t.justLimit=n&&!o}function Vt(t,e){if(t.isPrimKey)return e.primaryKey;const n=e.getIndexByKeyPath(t.index);if(!n)throw new N.Schema("KeyPath "+t.index+" on object store "+e.name+" is not indexed");return n}function Zn(t,e,n){const o=Vt(t,e.schema);return e.openCursor({trans:n,values:!t.keysOnly,reverse:"prev"===t.dir,unique:!!t.unique,query:{index:o,range:t.range}})}function Ht(t,e,n,o){const s=t.replayFilter?Qe(t.filter,t.replayFilter()):t.filter;if(t.or){const u={},c=(f,h,w)=>{if(!s||s(h,w,y=>h.stop(y),y=>h.fail(y))){var p=h.primaryKey,g=""+p;"[object ArrayBuffer]"===g&&(g=""+new Uint8Array(p)),W(u,g)||(u[g]=!0,e(f,h,w))}};return Promise.all([t.or._iterate(c,n),Qn(Zn(t,o,n),t.algorithm,c,!t.keysOnly&&t.valueMapper)])}return Qn(Zn(t,o,n),Qe(t.algorithm,s),e,!t.keysOnly&&t.valueMapper)}function Qn(t,e,n,o){var s=oe(o?(u,c,f)=>n(o(u),c,f):n);return t.then(u=>{if(u)return u.start(()=>{var c=()=>u.continue();e&&!e(u,f=>c=f,f=>{u.stop(f),c=z},f=>{u.fail(f),c=z})||s(u.value,u,f=>c=f),c()})})}function ve(t,e){try{const n=Jn(t),o=Jn(e);if(n!==o)return"Array"===n?1:"Array"===o?-1:"binary"===n?1:"binary"===o?-1:"string"===n?1:"string"===o?-1:"Date"===n?1:"Date"!==o?NaN:-1;switch(n){case"number":case"Date":case"string":return t>e?1:t<e?-1:0;case"binary":return function(s,u){const c=s.length,f=u.length,h=c<f?c:f;for(let w=0;w<h;++w)if(s[w]!==u[w])return s[w]<u[w]?-1:1;return c===f?0:c<f?-1:1}(Xn(t),Xn(e));case"Array":return function(s,u){const c=s.length,f=u.length,h=c<f?c:f;for(let w=0;w<h;++w){const p=ve(s[w],u[w]);if(0!==p)return p}return c===f?0:c<f?-1:1}(t,e)}}catch{}return NaN}function Jn(t){const e=typeof t;if("object"!==e)return e;if(ArrayBuffer.isView(t))return"binary";const n=dt(t);return"ArrayBuffer"===n?"binary":n}function Xn(t){return t instanceof Uint8Array?t:ArrayBuffer.isView(t)?new Uint8Array(t.buffer,t.byteOffset,t.byteLength):new Uint8Array(t)}class vr{_read(e,n){var o=this._ctx;return o.error?o.table._trans(null,pe.bind(null,o.error)):o.table._trans("readonly",e).then(n)}_write(e){var n=this._ctx;return n.error?n.table._trans(null,pe.bind(null,n.error)):n.table._trans("readwrite",e,"locked")}_addAlgorithm(e){var n=this._ctx;n.algorithm=Qe(n.algorithm,e)}_iterate(e,n){return Ht(this._ctx,e,n,this._ctx.table.core)}clone(e){var n=Object.create(this.constructor.prototype),o=Object.create(this._ctx);return e&&m(o,e),n._ctx=o,n}raw(){return this._ctx.valueMapper=null,this}each(e){var n=this._ctx;return this._read(o=>Ht(n,e,o,n.table.core))}count(e){return this._read(n=>{const o=this._ctx,s=o.table.core;if(st(o,!0))return s.count({trans:n,query:{index:Vt(o,s.schema),range:o.range}}).then(c=>Math.min(c,o.limit));var u=0;return Ht(o,()=>(++u,!1),n,s).then(()=>u)}).then(e)}sortBy(e,n){const o=e.split(".").reverse(),s=o[0],u=o.length-1;function c(w,p){return p?c(w[o[p]],p-1):w[s]}var f="next"===this._ctx.dir?1:-1;function h(w,p){var g=c(w,u),y=c(p,u);return g<y?-f:g>y?f:0}return this.toArray(function(w){return w.sort(h)}).then(n)}toArray(e){return this._read(n=>{var o=this._ctx;if("next"===o.dir&&st(o,!0)&&o.limit>0){const{valueMapper:s}=o,u=Vt(o,o.table.core.schema);return o.table.core.query({trans:n,limit:o.limit,values:!0,query:{index:u,range:o.range}}).then(({result:c})=>s?c.map(s):c)}{const s=[];return Ht(o,u=>s.push(u),n,o.table.core).then(()=>s)}},e)}offset(e){var n=this._ctx;return e<=0||(n.offset+=e,st(n)?bn(n,()=>{var o=e;return(s,u)=>0===o||(1===o?(--o,!1):(u(()=>{s.advance(o),o=0}),!1))}):bn(n,()=>{var o=e;return()=>--o<0})),this}limit(e){return this._ctx.limit=Math.min(this._ctx.limit,e),bn(this._ctx,()=>{var n=e;return function(o,s,u){return--n<=0&&s(u),n>=0}},!0),this}until(e,n){return wn(this._ctx,function(o,s,u){return!e(o.value)||(s(u),n)}),this}first(e){return this.limit(1).toArray(function(n){return n[0]}).then(e)}last(e){return this.reverse().first(e)}filter(e){var n;return wn(this._ctx,function(s){return e(s.value)}),(n=this._ctx).isMatch=Qe(n.isMatch,e),this}and(e){return this.filter(e)}or(e){return new this.db.WhereClause(this._ctx.table,e,this)}reverse(){return this._ctx.dir="prev"===this._ctx.dir?"next":"prev",this._ondirectionchange&&this._ondirectionchange(this._ctx.dir),this}desc(){return this.reverse()}eachKey(e){var n=this._ctx;return n.keysOnly=!n.isMatch,this.each(function(o,s){e(s.key,s)})}eachUniqueKey(e){return this._ctx.unique="unique",this.eachKey(e)}eachPrimaryKey(e){var n=this._ctx;return n.keysOnly=!n.isMatch,this.each(function(o,s){e(s.primaryKey,s)})}keys(e){var n=this._ctx;n.keysOnly=!n.isMatch;var o=[];return this.each(function(s,u){o.push(u.key)}).then(function(){return o}).then(e)}primaryKeys(e){var n=this._ctx;if("next"===n.dir&&st(n,!0)&&n.limit>0)return this._read(s=>{var u=Vt(n,n.table.core.schema);return n.table.core.query({trans:s,values:!1,limit:n.limit,query:{index:u,range:n.range}})}).then(({result:s})=>s).then(e);n.keysOnly=!n.isMatch;var o=[];return this.each(function(s,u){o.push(u.primaryKey)}).then(function(){return o}).then(e)}uniqueKeys(e){return this._ctx.unique="unique",this.keys(e)}firstKey(e){return this.limit(1).keys(function(n){return n[0]}).then(e)}lastKey(e){return this.reverse().firstKey(e)}distinct(){var e=this._ctx,n=e.index&&e.table.schema.idxByName[e.index];if(!n||!n.multi)return this;var o={};return wn(this._ctx,function(s){var u=s.primaryKey.toString(),c=W(o,u);return o[u]=!0,!c}),this}modify(e){var n=this._ctx;return this._write(o=>{var s;if("function"==typeof e)s=e;else{var u=O(e),c=u.length;s=function(B){for(var I=!1,E=0;E<c;++E){var x=u[E],F=e[x];Fe(B,x)!==F&&(Be(B,x,F),I=!0)}return I}}const f=n.table.core,{outbound:h,extractKey:w}=f.schema.primaryKey,p=this.db._options.modifyChunkSize||200,g=[];let y=0;const _=[],k=(B,I)=>{const{failures:E,numFailures:x}=I;y+=B-x;for(let F of O(E))g.push(E[F])};return this.clone().primaryKeys().then(B=>{const I=E=>{const x=Math.min(p,B.length-E);return f.getMany({trans:o,keys:B.slice(E,E+x),cache:"immutable"}).then(F=>{const K=[],C=[],A=h?[]:null,S=[];for(let R=0;R<x;++R){const ee=F[R],ae={value:Ne(ee),primKey:B[E+R]};!1!==s.call(ae,ae.value,ae)&&(null==ae.value?S.push(B[E+R]):h||0===ve(w(ee),w(ae.value))?(C.push(ae.value),h&&A.push(B[E+R])):(S.push(B[E+R]),K.push(ae.value)))}const L=st(n)&&n.limit===1/0&&("function"!=typeof e||e===vn)&&{index:n.index,range:n.range};return Promise.resolve(K.length>0&&f.mutate({trans:o,type:"add",values:K}).then(R=>{for(let ee in R.failures)S.splice(parseInt(ee),1);k(K.length,R)})).then(()=>(C.length>0||L&&"object"==typeof e)&&f.mutate({trans:o,type:"put",keys:A,values:C,criteria:L,changeSpec:"function"!=typeof e&&e}).then(R=>k(C.length,R))).then(()=>(S.length>0||L&&e===vn)&&f.mutate({trans:o,type:"delete",keys:S,criteria:L}).then(R=>k(S.length,R))).then(()=>B.length>E+x&&I(E+p))})};return I(0).then(()=>{if(g.length>0)throw new nt("Error modifying one or more objects",g,y,_);return B.length})})})}delete(){var e=this._ctx,n=e.range;return st(e)&&(e.isPrimKey&&!wr||3===n.type)?this._write(o=>{const{primaryKey:s}=e.table.core.schema,u=n;return e.table.core.count({trans:o,query:{index:s,range:u}}).then(c=>e.table.core.mutate({trans:o,type:"deleteRange",range:u}).then(({failures:f,numFailures:p})=>{if(p)throw new nt("Could not delete some values",Object.keys(f).map(g=>f[g]),c-p);return c-p}))}):this.modify(vn)}}const vn=(t,e)=>e.value=null;function _r(t,e){return t<e?-1:t===e?0:1}function xr(t,e){return t>e?-1:t===e?0:1}function Ae(t,e,n){var o=t instanceof tr?new t.Collection(t):t;return o._ctx.error=n?new n(e):new TypeError(e),o}function at(t){return new t.Collection(t,()=>er("")).limit(0)}function Er(t,e,n,o,s,u){for(var c=Math.min(t.length,o.length),f=-1,h=0;h<c;++h){var w=e[h];if(w!==o[h])return s(t[h],n[h])<0?t.substr(0,h)+n[h]+n.substr(h+1):s(t[h],o[h])<0?t.substr(0,h)+o[h]+n.substr(h+1):f>=0?t.substr(0,f)+e[f]+n.substr(f+1):null;s(t[h],w)<0&&(f=h)}return c<o.length&&"next"===u?t+n.substr(t.length):c<t.length&&"prev"===u?t.substr(0,n.length):f<0?null:t.substr(0,f)+o[f]+n.substr(f+1)}function Zt(t,e,n,o){var s,u,c,f,h,w,p,g=n.length;if(!n.every(B=>"string"==typeof B))return Ae(t,"String expected.");function y(B){s="next"===B?x=>x.toUpperCase():x=>x.toLowerCase(),u="next"===B?x=>x.toLowerCase():x=>x.toUpperCase(),c="next"===B?_r:xr;var I=n.map(function(E){return{lower:u(E),upper:s(E)}}).sort(function(E,x){return c(E.lower,x.lower)});f=I.map(function(E){return E.upper}),h=I.map(function(E){return E.lower}),w=B,p="next"===B?"":o}y("next");var _=new t.Collection(t,()=>qe(f[0],h[g-1]+o));_._ondirectionchange=function(B){y(B)};var k=0;return _._addAlgorithm(function(B,I,E){var x=B.key;if("string"!=typeof x)return!1;var F=u(x);if(e(F,h,k))return!0;for(var K=null,C=k;C<g;++C){var A=Er(x,F,f[C],h[C],c,w);null===A&&null===K?k=C+1:(null===K||c(K,A)>0)&&(K=A)}return I(null!==K?function(){B.continue(K+p)}:E),!1}),_}function qe(t,e,n,o){return{type:2,lower:t,upper:e,lowerOpen:n,upperOpen:o}}function er(t){return{type:1,lower:t,upper:t}}class tr{get Collection(){return this._ctx.table.db.Collection}between(e,n,o,s){o=!1!==o,s=!0===s;try{return this._cmp(e,n)>0||0===this._cmp(e,n)&&(o||s)&&(!o||!s)?at(this):new this.Collection(this,()=>qe(e,n,!o,!s))}catch{return Ae(this,De)}}equals(e){return null==e?Ae(this,De):new this.Collection(this,()=>er(e))}above(e){return null==e?Ae(this,De):new this.Collection(this,()=>qe(e,void 0,!0))}aboveOrEqual(e){return null==e?Ae(this,De):new this.Collection(this,()=>qe(e,void 0,!1))}below(e){return null==e?Ae(this,De):new this.Collection(this,()=>qe(void 0,e,!1,!0))}belowOrEqual(e){return null==e?Ae(this,De):new this.Collection(this,()=>qe(void 0,e))}startsWith(e){return"string"!=typeof e?Ae(this,"String expected."):this.between(e,e+Ze,!0,!0)}startsWithIgnoreCase(e){return""===e?this.startsWith(e):Zt(this,(n,o)=>0===n.indexOf(o[0]),[e],Ze)}equalsIgnoreCase(e){return Zt(this,(n,o)=>n===o[0],[e],"")}anyOfIgnoreCase(){var e=ie.apply(te,arguments);return 0===e.length?at(this):Zt(this,(n,o)=>-1!==o.indexOf(n),e,"")}startsWithAnyOfIgnoreCase(){var e=ie.apply(te,arguments);return 0===e.length?at(this):Zt(this,(n,o)=>o.some(s=>0===n.indexOf(s)),e,Ze)}anyOf(){const e=ie.apply(te,arguments);let n=this._cmp;try{e.sort(n)}catch{return Ae(this,De)}if(0===e.length)return at(this);const o=new this.Collection(this,()=>qe(e[0],e[e.length-1]));o._ondirectionchange=u=>{n="next"===u?this._ascending:this._descending,e.sort(n)};let s=0;return o._addAlgorithm((u,c,f)=>{const h=u.key;for(;n(h,e[s])>0;)if(++s,s===e.length)return c(f),!1;return 0===n(h,e[s])||(c(()=>{u.continue(e[s])}),!1)}),o}notEqual(e){return this.inAnyRange([[-1/0,e],[e,this.db._maxKey]],{includeLowers:!1,includeUppers:!1})}noneOf(){const e=ie.apply(te,arguments);if(0===e.length)return new this.Collection(this);try{e.sort(this._ascending)}catch{return Ae(this,De)}const n=e.reduce((o,s)=>o?o.concat([[o[o.length-1][1],s]]):[[-1/0,s]],null);return n.push([e[e.length-1],this.db._maxKey]),this.inAnyRange(n,{includeLowers:!1,includeUppers:!1})}inAnyRange(e,n){const o=this._cmp,s=this._ascending,u=this._descending,c=this._min,f=this._max;if(0===e.length)return at(this);if(!e.every(x=>void 0!==x[0]&&void 0!==x[1]&&s(x[0],x[1])<=0))return Ae(this,"First argument to inAnyRange() must be an Array of two-value Arrays [lower,upper] where upper must not be lower than lower",N.InvalidArgument);const h=!n||!1!==n.includeLowers,w=n&&!0===n.includeUppers;let p,g=s;function y(x,F){return g(x[0],F[0])}try{p=e.reduce(function(x,F){let K=0,C=x.length;for(;K<C;++K){const A=x[K];if(o(F[0],A[1])<0&&o(F[1],A[0])>0){A[0]=c(A[0],F[0]),A[1]=f(A[1],F[1]);break}}return K===C&&x.push(F),x},[]),p.sort(y)}catch{return Ae(this,De)}let _=0;const k=w?x=>s(x,p[_][1])>0:x=>s(x,p[_][1])>=0,B=h?x=>u(x,p[_][0])>0:x=>u(x,p[_][0])>=0;let I=k;const E=new this.Collection(this,()=>qe(p[0][0],p[p.length-1][1],!h,!w));return E._ondirectionchange=x=>{"next"===x?(I=k,g=s):(I=B,g=u),p.sort(y)},E._addAlgorithm((x,F,K)=>{for(var C=x.key;I(C);)if(++_,_===p.length)return F(K),!1;return!((k(A=C)||B(A))&&(0===this._cmp(C,p[_][1])||0===this._cmp(C,p[_][0])||F(()=>{x.continue(g===s?p[_][0]:p[_][1])}),1));var A}),E}startsWithAnyOf(){const e=ie.apply(te,arguments);return e.every(n=>"string"==typeof n)?0===e.length?at(this):this.inAnyRange(e.map(n=>[n,n+Ze])):Ae(this,"startsWithAnyOf() only works with strings")}}function Te(t){return oe(function(e){return At(e),t(e.target.error),!1})}function At(t){t.stopPropagation&&t.stopPropagation(),t.preventDefault&&t.preventDefault()}const We=kt(null,"storagemutated");class Br{_lock(){return fe(!U.global),++this._reculock,1!==this._reculock||U.global||(U.lockOwnerFor=this),this}_unlock(){if(fe(!U.global),0==--this._reculock)for(U.global||(U.lockOwnerFor=null);this._blockedFuncs.length>0&&!this._locked();){var e=this._blockedFuncs.shift();try{ot(e[1],e[0])}catch{}}return this}_locked(){return this._reculock&&U.lockOwnerFor!==this}create(e){if(!this.mode)return this;const n=this.db.idbdb,o=this.db._state.dbOpenError;if(fe(!this.idbtrans),!e&&!n)switch(o&&o.name){case"DatabaseClosedError":throw new N.DatabaseClosed(o);case"MissingAPIError":throw new N.MissingAPI(o.message,o);default:throw new N.OpenFailed(o)}if(!this.active)throw new N.TransactionInactive;return fe(null===this._completion._state),(e=this.idbtrans=e||(this.db.core?this.db.core.transaction(this.storeNames,this.mode,{durability:this.chromeTransactionDurability}):n.transaction(this.storeNames,this.mode,{durability:this.chromeTransactionDurability}))).onerror=oe(s=>{At(s),this._reject(e.error)}),e.onabort=oe(s=>{At(s),this.active&&this._reject(new N.Abort(e.error)),this.active=!1,this.on("abort").fire(s)}),e.oncomplete=oe(()=>{this.active=!1,this._resolve(),"mutatedParts"in e&&We.storagemutated.fire(e.mutatedParts)}),this}_promise(e,n,o){if("readwrite"===e&&"readwrite"!==this.mode)return pe(new N.ReadOnly("Transaction is readonly"));if(!this.active)return pe(new N.TransactionInactive);if(this._locked())return new P((u,c)=>{this._blockedFuncs.push([()=>{this._promise(e,n,o).then(u,c)},U])});if(o)return $e(()=>{var u=new P((c,f)=>{this._lock();const h=n(c,f,this);h&&h.then&&h.then(c,f)});return u.finally(()=>this._unlock()),u._lib=!0,u});var s=new P((u,c)=>{var f=n(u,c,this);f&&f.then&&f.then(u,c)});return s._lib=!0,s}_root(){return this.parent?this.parent._root():this}waitFor(e){var n=this._root();const o=P.resolve(e);if(n._waitingFor)n._waitingFor=n._waitingFor.then(()=>o);else{n._waitingFor=o,n._waitingQueue=[];var s=n.idbtrans.objectStore(n.storeNames[0]);!function c(){for(++n._spinCount;n._waitingQueue.length;)n._waitingQueue.shift()();n._waitingFor&&(s.get(-1/0).onsuccess=c)}()}var u=n._waitingFor;return new P((c,f)=>{o.then(h=>n._waitingQueue.push(oe(c.bind(null,h))),h=>n._waitingQueue.push(oe(f.bind(null,h)))).finally(()=>{n._waitingFor===u&&(n._waitingFor=null)})})}abort(){this.active&&(this.active=!1,this.idbtrans&&this.idbtrans.abort(),this._reject(new N.Abort))}table(e){const n=this._memoizedTables||(this._memoizedTables={});if(W(n,e))return n[e];const o=this.schema[e];if(!o)throw new N.NotFound("Table "+e+" not part of transaction");const s=new this.db.Table(e,o,this);return s.core=this.db.core.table(e),n[e]=s,s}}function _n(t,e,n,o,s,u,c){return{name:t,keyPath:e,unique:n,multi:o,auto:s,compound:u,src:(n&&!c?"&":"")+(o?"*":"")+(s?"++":"")+nr(e)}}function nr(t){return"string"==typeof t?t:t?"["+[].join.call(t,"+")+"]":""}function rr(t,e,n){return{name:t,primKey:e,indexes:n,mappedClass:null,idxByName:ht(n,o=>[o.name,o])}}let Ft=t=>{try{return t.only([[]]),Ft=()=>[[]],[[]]}catch{return Ft=()=>Ze,Ze}};function xn(t){return null==t?()=>{}:"string"==typeof t?1===(e=t).split(".").length?n=>n[e]:n=>Fe(n,e):e=>Fe(e,t);var e}function ir(t){return[].slice.call(t)}let kr=0;function St(t){return null==t?":id":"string"==typeof t?t:`[${t.join("+")}]`}function Ir(t,e,n){function o(h){if(3===h.type)return null;if(4===h.type)throw new Error("Cannot convert never type to IDBKeyRange");const{lower:w,upper:p,lowerOpen:g,upperOpen:y}=h;return void 0===w?void 0===p?null:e.upperBound(p,!!y):void 0===p?e.lowerBound(w,!!g):e.bound(w,p,!!g,!!y)}const{schema:s,hasGetAll:u}=function(h,w){const p=ir(h.objectStoreNames);return{schema:{name:h.name,tables:p.map(g=>w.objectStore(g)).map(g=>{const{keyPath:y,autoIncrement:_}=g,k=j(y),I={},E={name:g.name,primaryKey:{name:null,isPrimaryKey:!0,outbound:null==y,compound:k,keyPath:y,autoIncrement:_,unique:!0,extractKey:xn(y)},indexes:ir(g.indexNames).map(x=>g.index(x)).map(x=>{const{name:F,unique:K,multiEntry:C,keyPath:A}=x,S={name:F,compound:j(A),keyPath:A,unique:K,multiEntry:C,extractKey:xn(A)};return I[St(A)]=S,S}),getIndexByKeyPath:x=>I[St(x)]};return I[":id"]=E.primaryKey,null!=y&&(I[St(y)]=E.primaryKey),E})},hasGetAll:p.length>0&&"getAll"in w.objectStore(p[0])&&!(typeof navigator<"u"&&/Safari/.test(navigator.userAgent)&&!/(Chrome\/|Edge\/)/.test(navigator.userAgent)&&[].concat(navigator.userAgent.match(/Safari\/(\d*)/))[1]<604)}}(t,n),c=s.tables.map(h=>function(w){const p=w.name;return{name:p,schema:w,mutate:function({trans:g,type:y,keys:_,values:k,range:B}){return new Promise((I,E)=>{I=oe(I);const x=g.objectStore(p),F=null==x.keyPath,K="put"===y||"add"===y;if(!K&&"delete"!==y&&"deleteRange"!==y)throw new Error("Invalid operation type: "+y);const{length:C}=_||k||{length:1};if(_&&k&&_.length!==k.length)throw new Error("Given keys array must have same length as given values array.");if(0===C)return I({numFailures:0,failures:{},results:[],lastResult:void 0});let A;const S=[],L=[];let R=0;const ee=_e=>{++R,At(_e)};if("deleteRange"===y){if(4===B.type)return I({numFailures:R,failures:L,results:[],lastResult:void 0});S.push(A=3===B.type?x.clear():x.delete(o(B)))}else{const[_e,be]=K?F?[k,_]:[k,null]:[_,null];if(K)for(let ue=0;ue<C;++ue)S.push(A=be&&void 0!==be[ue]?x[y](_e[ue],be[ue]):x[y](_e[ue])),A.onerror=ee;else for(let ue=0;ue<C;++ue)S.push(A=x[y](_e[ue])),A.onerror=ee}const ae=_e=>{const be=_e.target.result;S.forEach((ue,ut)=>null!=ue.error&&(L[ut]=ue.error)),I({numFailures:R,failures:L,results:"delete"===y?_:S.map(ue=>ue.result),lastResult:be})};A.onerror=_e=>{ee(_e),ae(_e)},A.onsuccess=ae})},getMany:({trans:g,keys:y})=>new Promise((_,k)=>{_=oe(_);const B=g.objectStore(p),I=y.length,E=new Array(I);let x,F=0,K=0;const C=S=>{const L=S.target;E[L._pos]=L.result,++K===F&&_(E)},A=Te(k);for(let S=0;S<I;++S)null!=y[S]&&(x=B.get(y[S]),x._pos=S,x.onsuccess=C,x.onerror=A,++F);0===F&&_(E)}),get:({trans:g,key:y})=>new Promise((_,k)=>{_=oe(_);const B=g.objectStore(p).get(y);B.onsuccess=I=>_(I.target.result),B.onerror=Te(k)}),query:(g=u,y=>new Promise((_,k)=>{_=oe(_);const{trans:B,values:I,limit:E,query:x}=y,F=E===1/0?void 0:E,{index:K,range:C}=x,A=B.objectStore(p),S=K.isPrimaryKey?A:A.index(K.name),L=o(C);if(0===E)return _({result:[]});if(g){const R=I?S.getAll(L,F):S.getAllKeys(L,F);R.onsuccess=ee=>_({result:ee.target.result}),R.onerror=Te(k)}else{let R=0;const ee=I||!("openKeyCursor"in S)?S.openCursor(L):S.openKeyCursor(L),ae=[];ee.onsuccess=_e=>{const be=ee.result;return be?(ae.push(I?be.value:be.primaryKey),++R===E?_({result:ae}):void be.continue()):_({result:ae})},ee.onerror=Te(k)}})),openCursor:function({trans:g,values:y,query:_,reverse:k,unique:B}){return new Promise((I,E)=>{I=oe(I);const{index:x,range:F}=_,K=g.objectStore(p),C=x.isPrimaryKey?K:K.index(x.name),A=k?B?"prevunique":"prev":B?"nextunique":"next",S=y||!("openKeyCursor"in C)?C.openCursor(o(F),A):C.openKeyCursor(o(F),A);S.onerror=Te(E),S.onsuccess=oe(L=>{const R=S.result;if(!R)return void I(null);R.___id=++kr,R.done=!1;const ee=R.continue.bind(R);let ae=R.continuePrimaryKey;ae&&(ae=ae.bind(R));const _e=R.advance.bind(R),be=()=>{throw new Error("Cursor not stopped")};R.trans=g,R.stop=R.continue=R.continuePrimaryKey=R.advance=()=>{throw new Error("Cursor not started")},R.fail=oe(E),R.next=function(){let ue=1;return this.start(()=>ue--?this.continue():this.stop()).then(()=>this)},R.start=ue=>{const ut=new Promise((Ee,et)=>{Ee=oe(Ee),S.onerror=Te(et),R.fail=et,R.stop=Ct=>{R.stop=R.continue=R.continuePrimaryKey=R.advance=be,Ee(Ct)}}),ct=()=>{if(S.result)try{ue()}catch(Ee){R.fail(Ee)}else R.done=!0,R.start=()=>{throw new Error("Cursor behind last entry")},R.stop()};return S.onsuccess=oe(Ee=>{S.onsuccess=ct,ct()}),R.continue=ee,R.continuePrimaryKey=ae,R.advance=_e,ct(),ut},I(R)},E)})},count({query:g,trans:y}){const{index:_,range:k}=g;return new Promise((B,I)=>{const E=y.objectStore(p),x=_.isPrimaryKey?E:E.index(_.name),F=o(k),K=F?x.count(F):x.count();K.onsuccess=oe(C=>B(C.target.result)),K.onerror=Te(I)})}};var g}(h)),f={};return c.forEach(h=>f[h.name]=h),{stack:"dbcore",transaction:t.transaction.bind(t),table(h){if(!f[h])throw new Error(`Table '${h}' not found`);return f[h]},MIN_KEY:-1/0,MAX_KEY:Ft(e),schema:s}}function En({_novip:t},e){const o=function(s,u,{IDBKeyRange:c},h){return{dbcore:(p=Ir(u,c,h),g=s.dbcore,g.reduce((y,{create:_})=>({...y,..._(y)}),p))};var p,g}(t._middlewares,e.db,t._deps,e);t.core=o.dbcore,t.tables.forEach(s=>{const u=s.name;t.core.schema.tables.some(c=>c.name===u)&&(s.core=t.core.table(u),t[u]instanceof t.Table&&(t[u].core=s.core))})}function Qt({_novip:t},e,n,o){n.forEach(s=>{const u=o[s];e.forEach(c=>{const f=ye(c,s);(!f||"value"in f&&void 0===f.value)&&(c===t.Transaction.prototype||c instanceof t.Transaction?$(c,s,{get(){return this.table(s)},set(h){M(this,s,{value:h,writable:!0,configurable:!0,enumerable:!0})}}):c[s]=new t.Table(s,u))})})}function Bn({_novip:t},e){e.forEach(n=>{for(let o in n)n[o]instanceof t.Table&&delete n[o]})}function Ar(t,e){return t._cfg.version-e._cfg.version}function or(t,e){const n={del:[],add:[],change:[]};let o;for(o in t)e[o]||n.del.push(o);for(o in e){const s=t[o],u=e[o];if(s){const c={name:o,def:u,recreate:!1,del:[],add:[],change:[]};if(""+(s.primKey.keyPath||"")!=""+(u.primKey.keyPath||"")||s.primKey.auto!==u.primKey.auto&&!Yt)c.recreate=!0,n.change.push(c);else{const f=s.idxByName,h=u.idxByName;let w;for(w in f)h[w]||c.del.push(w);for(w in h){const p=f[w],g=h[w];p?p.src!==g.src&&c.change.push(g):c.add.push(g)}(c.del.length>0||c.add.length>0||c.change.length>0)&&n.change.push(c)}}else n.add.push([o,u])}return n}function kn(t,e,n,o){const s=t.db.createObjectStore(e,n.keyPath?{keyPath:n.keyPath,autoIncrement:n.auto}:{autoIncrement:n.auto});return o.forEach(u=>In(s,u)),s}function In(t,e){t.createIndex(e.name,e.keyPath,{unique:e.unique,multiEntry:e.multi})}function An(t,e,n){const o={};return de(e.objectStoreNames,0).forEach(s=>{const u=n.objectStore(s);let c=u.keyPath;const f=_n(nr(c),c||"",!1,!1,!!u.autoIncrement,c&&"string"!=typeof c,!0),h=[];for(let p=0;p<u.indexNames.length;++p){const g=u.index(u.indexNames[p]);c=g.keyPath;var w=_n(g.name,c,!!g.unique,!!g.multiEntry,!1,c&&"string"!=typeof c,!1);h.push(w)}o[s]=rr(s,f,h)}),o}function Fn({_novip:t},e,n){const o=n.db.objectStoreNames;for(let s=0;s<o.length;++s){const u=o[s],c=n.objectStore(u);t._hasGetAll="getAll"in c;for(let f=0;f<c.indexNames.length;++f){const h=c.indexNames[f],w=c.index(h).keyPath,p="string"==typeof w?w:"["+de(w).join("+")+"]";if(e[u]){const g=e[u].idxByName[p];g&&(g.name=h,delete e[u].idxByName[p],e[u].idxByName[h]=g)}}}typeof navigator<"u"&&/Safari/.test(navigator.userAgent)&&!/(Chrome\/|Edge\/)/.test(navigator.userAgent)&&T.WorkerGlobalScope&&T instanceof T.WorkerGlobalScope&&[].concat(navigator.userAgent.match(/Safari\/(\d*)/))[1]<604&&(t._hasGetAll=!1)}class Sr{_parseStoresSpec(e,n){O(e).forEach(o=>{if(null!==e[o]){var s=e[o].split(",").map((c,f)=>{const h=(c=c.trim()).replace(/([&*]|\+\+)/g,""),w=/^\[/.test(h)?h.match(/^\[(.*)\]$/)[1].split("+"):h;return _n(h,w||null,/\&/.test(c),/\*/.test(c),/\+\+/.test(c),j(w),0===f)}),u=s.shift();if(u.multi)throw new N.Schema("Primary key cannot be multi-valued");s.forEach(c=>{if(c.auto)throw new N.Schema("Only primary key can be marked as autoIncrement (++)");if(!c.keyPath)throw new N.Schema("Index must have a name and cannot be an empty string")}),n[o]=rr(o,u,s)}})}stores(e){const n=this.db;this._cfg.storesSource=this._cfg.storesSource?m(this._cfg.storesSource,e):e;const s={};let u={};return n._versions.forEach(c=>{m(s,c._cfg.storesSource),u=c._cfg.dbschema={},c._parseStoresSpec(s,u)}),n._dbSchema=u,Bn(n,[n._allTables,n,n.Transaction.prototype]),Qt(n,[n._allTables,n,n.Transaction.prototype,this._cfg.tables],O(u),u),n._storeNames=O(u),this}upgrade(e){return this._cfg.contentUpgrade=l(this._cfg.contentUpgrade||z,e),this}}function Sn(t,e){let n=t._dbNamesDB;return n||(n=t._dbNamesDB=new Je("__dbnames",{addons:[],indexedDB:t,IDBKeyRange:e}),n.version(1).stores({dbnames:"name"})),n.table("dbnames")}function Pn(t){return t&&"function"==typeof t.databases}function Cn(t){return $e(function(){return U.letThrough=!0,t()})}function Pr(){var t;return!navigator.userAgentData&&/Safari\//.test(navigator.userAgent)&&!/Chrom(e|ium)\//.test(navigator.userAgent)&&indexedDB.databases?new Promise(function(e){var n=function(){return indexedDB.databases().finally(e)};t=setInterval(n,100),n()}).finally(function(){return clearInterval(t)}):Promise.resolve()}function Tn(t){var e=u=>t.next(u),n=s(e),o=s(u=>t.throw(u));function s(u){return c=>{var f=u(c),h=f.value;return f.done?h:h&&"function"==typeof h.then?h.then(n,o):j(h)?Promise.all(h).then(n,o):n(h)}}return s(e)()}function Tr(t,e,n){var o=arguments.length;if(o<2)throw new N.InvalidArgument("Too few arguments");for(var s=new Array(o-1);--o;)s[o-1]=arguments[o];return n=s.pop(),[t,Ot(s),n]}function sr(t,e,n,o,s){return P.resolve().then(()=>{const u=U.transless||U,c=t._createTransaction(e,n,t._dbSchema,o),f={trans:c,transless:u};if(o)c.idbtrans=o.idbtrans;else try{c.create(),t._state.PR1398_maxLoop=3}catch(g){return g.name===Ge.InvalidState&&t.isOpen()&&--t._state.PR1398_maxLoop>0?(console.warn("Dexie: Need to reopen db"),t._close(),t.open().then(()=>sr(t,e,n,null,s))):pe(g)}const h=tt(s);let w;h&&it();const p=P.follow(()=>{if(w=s.call(c,c),w)if(h){var g=Ke.bind(null,null);w.then(g,g)}else"function"==typeof w.next&&"function"==typeof w.throw&&(w=Tn(w))},f);return(w&&"function"==typeof w.then?P.resolve(w).then(g=>c.active?g:pe(new N.PrematureCommit("Transaction committed too early. See http://bit.ly/2kdckMn"))):p.then(()=>w)).then(g=>(o&&c._resolve(),c._completion.then(()=>g))).catch(g=>(c._reject(g),pe(g)))})}function Jt(t,e,n){const o=j(t)?t.slice():[t];for(let s=0;s<n;++s)o.push(e);return o}const Or={stack:"dbcore",name:"VirtualIndexMiddleware",level:1,create:function(t){return{...t,table(e){const n=t.table(e),{schema:o}=n,s={},u=[];function c(p,g,y){const _=St(p),k=s[_]=s[_]||[],B=null==p?0:"string"==typeof p?1:p.length,I=g>0,E={...y,isVirtual:I,keyTail:g,keyLength:B,extractKey:xn(p),unique:!I&&y.unique};return k.push(E),E.isPrimaryKey||u.push(E),B>1&&c(2===B?p[0]:p.slice(0,B-1),g+1,y),k.sort((x,F)=>x.keyTail-F.keyTail),E}const f=c(o.primaryKey.keyPath,0,o.primaryKey);s[":id"]=[f];for(const p of o.indexes)c(p.keyPath,0,p);function h(p){const g=p.query.index;return g.isVirtual?{...p,query:{index:g,range:(y=p.query.range,_=g.keyTail,{type:1===y.type?2:y.type,lower:Jt(y.lower,y.lowerOpen?t.MAX_KEY:t.MIN_KEY,_),lowerOpen:!0,upper:Jt(y.upper,y.upperOpen?t.MIN_KEY:t.MAX_KEY,_),upperOpen:!0})}}:p;var y,_}return{...n,schema:{...o,primaryKey:f,indexes:u,getIndexByKeyPath:function(p){const g=s[St(p)];return g&&g[0]}},count:p=>n.count(h(p)),query:p=>n.query(h(p)),openCursor(p){const{keyTail:g,isVirtual:y,keyLength:_}=p.query.index;return y?n.openCursor(h(p)).then(k=>{return k&&(B=k,Object.create(B,{continue:{value:function(E){null!=E?B.continue(Jt(E,p.reverse?t.MAX_KEY:t.MIN_KEY,g)):p.unique?B.continue(B.key.slice(0,_).concat(p.reverse?t.MIN_KEY:t.MAX_KEY,g)):B.continue()}},continuePrimaryKey:{value(E,x){B.continuePrimaryKey(Jt(E,t.MAX_KEY,g),x)}},primaryKey:{get:()=>B.primaryKey},key:{get(){const E=B.key;return 1===_?E[0]:E.slice(0,_)}},value:{get:()=>B.value}}));var B}):n.openCursor(p)}}}}}};function On(t,e,n,o){return n=n||{},o=o||"",O(t).forEach(s=>{if(W(e,s)){var u=t[s],c=e[s];if("object"==typeof u&&"object"==typeof c&&u&&c){const f=dt(u);f!==dt(c)?n[o+s]=e[s]:"Object"===f?On(u,c,n,o+s+"."):u!==c&&(n[o+s]=e[s])}else u!==c&&(n[o+s]=e[s])}else n[o+s]=void 0}),O(e).forEach(s=>{W(t,s)||(n[o+s]=e[s])}),n}const Rr={stack:"dbcore",name:"HooksMiddleware",level:2,create:t=>({...t,table(e){const n=t.table(e),{primaryKey:o}=n.schema;return{...n,mutate(u){const c=U.trans,{deleting:f,creating:h,updating:w}=c.table(e).hook;switch(u.type){case"add":if(h.fire===z)break;return c._promise("readwrite",()=>p(u),!0);case"put":if(h.fire===z&&w.fire===z)break;return c._promise("readwrite",()=>p(u),!0);case"delete":if(f.fire===z)break;return c._promise("readwrite",()=>p(u),!0);case"deleteRange":if(f.fire===z)break;return c._promise("readwrite",()=>{return g((y=u).trans,y.range,1e4);var y},!0)}return n.mutate(u);function p(y){const _=U.trans,k=y.keys||("delete"===(I=y).type?I.keys:I.keys||I.values.map(o.extractKey));var I;if(!k)throw new Error("Keys missing");return"delete"!==(y="add"===y.type||"put"===y.type?{...y,keys:k}:{...y}).type&&(y.values=[...y.values]),y.keys&&(y.keys=[...y.keys]),function(B,I,E){return"add"===I.type?Promise.resolve([]):B.getMany({trans:I.trans,keys:E,cache:"immutable"})}(n,y,k).then(B=>{const I=k.map((E,x)=>{const F=B[x],K={onerror:null,onsuccess:null};if("delete"===y.type)f.fire.call(K,E,F,_);else if("add"===y.type||void 0===F){const C=h.fire.call(K,E,y.values[x],_);null==E&&null!=C&&(y.keys[x]=E=C,o.outbound||Be(y.values[x],o.keyPath,E))}else{const C=On(F,y.values[x]),A=w.fire.call(K,C,E,F,_);if(A){const S=y.values[x];Object.keys(A).forEach(L=>{W(S,L)?S[L]=A[L]:Be(S,L,A[L])})}}return K});return n.mutate(y).then(({failures:E,results:x,numFailures:F,lastResult:K})=>{for(let C=0;C<k.length;++C){const A=x?x[C]:k[C],S=I[C];null==A?S.onerror&&S.onerror(E[C]):S.onsuccess&&S.onsuccess("put"===y.type&&B[C]?y.values[C]:A)}return{failures:E,results:x,numFailures:F,lastResult:K}}).catch(E=>(I.forEach(x=>x.onerror&&x.onerror(E)),Promise.reject(E)))})}function g(y,_,k){return n.query({trans:y,values:!1,query:{index:o,range:_},limit:k}).then(({result:B})=>p({type:"delete",keys:B,trans:y}).then(I=>I.numFailures>0?Promise.reject(I.failures[0]):B.length<k?{failures:[],numFailures:0,lastResult:void 0}:g(y,{..._,lower:B[B.length-1],lowerOpen:!0},k)))}}}}})};function ar(t,e,n){try{if(!e||e.keys.length<t.length)return null;const o=[];for(let s=0,u=0;s<e.keys.length&&u<t.length;++s)0===ve(e.keys[s],t[u])&&(o.push(n?Ne(e.values[s]):e.values[s]),++u);return o.length===t.length?o:null}catch{return null}}const Kr={stack:"dbcore",level:-1,create:t=>({table:e=>{const n=t.table(e);return{...n,getMany:o=>{if(!o.cache)return n.getMany(o);const s=ar(o.keys,o.trans._cache,"clone"===o.cache);return s?P.resolve(s):n.getMany(o).then(u=>(o.trans._cache={keys:o.keys,values:"clone"===o.cache?Ne(u):u},u))},mutate:o=>("add"!==o.type&&(o.trans._cache=null),n.mutate(o))}}})};function Rn(t){return!("from"in t)}const Ue=function(t,e){if(!this){const n=new Ue;return t&&"d"in t&&m(n,t),n}m(this,arguments.length?{d:1,from:t,to:arguments.length>1?e:t}:{d:0})};function Pt(t,e,n){const o=ve(e,n);if(isNaN(o))return;if(o>0)throw RangeError();if(Rn(t))return m(t,{from:e,to:n,d:1});const s=t.l,u=t.r;if(ve(n,t.from)<0)return s?Pt(s,e,n):t.l={from:e,to:n,d:1,l:null,r:null},ur(t);if(ve(e,t.to)>0)return u?Pt(u,e,n):t.r={from:e,to:n,d:1,l:null,r:null},ur(t);ve(e,t.from)<0&&(t.from=e,t.l=null,t.d=u?u.d+1:1),ve(n,t.to)>0&&(t.to=n,t.r=null,t.d=t.l?t.l.d+1:1);const c=!t.r;s&&!t.l&&Xt(t,s),u&&c&&Xt(t,u)}function Xt(t,e){Rn(e)||function n(o,{from:s,to:u,l:c,r:f}){Pt(o,s,u),c&&n(o,c),f&&n(o,f)}(t,e)}function Kn(t){let e=Rn(t)?null:{s:0,n:t};return{next(n){const o=arguments.length>0;for(;e;)switch(e.s){case 0:if(e.s=1,o)for(;e.n.l&&ve(n,e.n.from)<0;)e={up:e,n:e.n.l,s:1};else for(;e.n.l;)e={up:e,n:e.n.l,s:1};case 1:if(e.s=2,!o||ve(n,e.n.to)<=0)return{value:e.n,done:!1};case 2:if(e.n.r){e.s=3,e={up:e,n:e.n.r,s:0};continue}case 3:e=e.up}return{done:!0}}}}function ur(t){var e,n;const o=((null===(e=t.r)||void 0===e?void 0:e.d)||0)-((null===(n=t.l)||void 0===n?void 0:n.d)||0),s=o>1?"r":o<-1?"l":"";if(s){const u="r"===s?"l":"r",c={...t},f=t[s];t.from=f.from,t.to=f.to,t[s]=f[s],c[s]=f[u],t[u]=c,c.d=cr(c)}t.d=cr(t)}function cr({r:t,l:e}){return(t?e?Math.max(t.d,e.d):t.d:e?e.d:0)+1}le(Ue.prototype,{add(t){return Xt(this,t),this},addKey(t){return Pt(this,t,t),this},addKeys(t){return t.forEach(e=>Pt(this,e,e)),this},[pt](){return Kn(this)}});const Ur={stack:"dbcore",level:0,create:t=>{const e=t.schema.name,n=new Ue(t.MIN_KEY,t.MAX_KEY);return{...t,table:o=>{const s=t.table(o),{schema:u}=s,{primaryKey:c}=u,{extractKey:f,outbound:h}=c,w={...s,mutate:y=>{const _=y.trans,k=_.mutatedParts||(_.mutatedParts={}),B=A=>{const S=`idb://${e}/${o}/${A}`;return k[S]||(k[S]=new Ue)},I=B(""),E=B(":dels"),{type:x}=y;let[F,K]="deleteRange"===y.type?[y.range]:"delete"===y.type?[y.keys]:y.values.length<50?[[],y.values]:[];const C=y.trans._cache;return s.mutate(y).then(A=>{if(j(F)){"delete"!==x&&(F=A.results),I.addKeys(F);const S=ar(F,C);S||"add"===x||E.addKeys(F),(S||K)&&(L=B,ee=S,ae=K,u.indexes.forEach(function _e(be){const ue=L(be.name||"");function ut(Ee){return null!=Ee?be.extractKey(Ee):null}const ct=Ee=>be.multiEntry&&j(Ee)?Ee.forEach(et=>ue.addKey(et)):ue.addKey(Ee);(ee||ae).forEach((Ee,et)=>{const Ct=ee&&ut(ee[et]),jn=ae&&ut(ae[et]);0!==ve(Ct,jn)&&(null!=Ct&&ct(Ct),null!=jn&&ct(jn))})}))}else if(F){const S={from:F.lower,to:F.upper};E.add(S),I.add(S)}else I.add(n),E.add(n),u.indexes.forEach(S=>B(S.name).add(n));var L,ee,ae;return A})}},p=({query:{index:y,range:_}})=>{var k,B;return[y,new Ue(null!==(k=_.lower)&&void 0!==k?k:t.MIN_KEY,null!==(B=_.upper)&&void 0!==B?B:t.MAX_KEY)]},g={get:y=>[c,new Ue(y.key)],getMany:y=>[c,(new Ue).addKeys(y.keys)],count:p,query:p,openCursor:p};return O(g).forEach(y=>{w[y]=function(_){const{subscr:k}=U;if(k){const B=K=>{const C=`idb://${e}/${o}/${K}`;return k[C]||(k[C]=new Ue)},I=B(""),E=B(":dels"),[x,F]=g[y](_);if(B(x.name||"").add(F),!x.isPrimaryKey){if("count"!==y){const K="query"===y&&h&&_.values&&s.query({..._,values:!1});return s[y].apply(this,arguments).then(C=>{if("query"===y){if(h&&_.values)return K.then(({result:S})=>(I.addKeys(S),C));const A=_.values?C.result.map(f):C.result;_.values?I.addKeys(A):E.addKeys(A)}else if("openCursor"===y){const A=C,S=_.values;return A&&Object.create(A,{key:{get:()=>(E.addKey(A.primaryKey),A.key)},primaryKey:{get(){const L=A.primaryKey;return E.addKey(L),L}},value:{get:()=>(S&&I.addKey(A.primaryKey),A.value)}})}return C})}E.add(n)}}return s[y].apply(this,arguments)}}),w}}}};class Je{constructor(e,n){this._middlewares={},this.verno=0;const o=Je.dependencies;this._options=n={addons:Je.addons,autoOpen:!0,indexedDB:o.indexedDB,IDBKeyRange:o.IDBKeyRange,...n},this._deps={indexedDB:n.indexedDB,IDBKeyRange:n.IDBKeyRange};const{addons:s}=n;this._dbSchema={},this._versions=[],this._storeNames=[],this._allTables={},this.idbdb=null,this._novip=this;const u={dbOpenError:null,isBeingOpened:!1,onReadyBeingFired:null,openComplete:!1,dbReadyResolve:z,dbReadyPromise:null,cancelOpen:z,openCanceller:null,autoSchema:!0,PR1398_maxLoop:3};var c,f;u.dbReadyPromise=new P(f=>{u.dbReadyResolve=f}),u.openCanceller=new P((f,h)=>{u.cancelOpen=h}),this._state=u,this.name=e,this.on=kt(this,"populate","blocked","versionchange","close",{ready:[l,z]}),this.on.ready.subscribe=Se(this.on.ready.subscribe,f=>(h,w)=>{Je.vip(()=>{const p=this._state;if(p.openComplete)p.dbOpenError||P.resolve().then(h),w&&f(h);else if(p.onReadyBeingFired)p.onReadyBeingFired.push(h),w&&f(h);else{f(h);const g=this;w||f(function y(){g.on.ready.unsubscribe(h),g.on.ready.unsubscribe(y)})}})}),this.Collection=(c=this,It(vr.prototype,function(f,h){this.db=c;let w=Hn,p=null;if(h)try{w=h()}catch(k){p=k}const g=f._ctx,y=g.table,_=y.hook.reading.fire;this._ctx={table:y,index:g.index,isPrimKey:!g.index||y.schema.primKey.keyPath&&g.index===y.schema.primKey.name,range:w,keysOnly:!1,dir:"next",unique:"",algorithm:null,filter:null,replayFilter:null,justLimit:!0,isMatch:null,offset:0,limit:1/0,error:p,or:g.or,valueMapper:_!==Re?_:null}})),this.Table=(f=this,It(br.prototype,function(h,w,p){this.db=f,this._tx=p,this.name=h,this.schema=w,this.hook=f._allTables[h]?f._allTables[h].hook:kt(null,{creating:[un,z],reading:[an,Re],updating:[r,z],deleting:[a,z]})})),this.Transaction=function(f){return It(Br.prototype,function(h,w,p,g,y){this.db=f,this.mode=h,this.storeNames=w,this.schema=p,this.chromeTransactionDurability=g,this.idbtrans=null,this.on=kt(this,"complete","error","abort"),this.parent=y||null,this.active=!0,this._reculock=0,this._blockedFuncs=[],this._resolve=null,this._reject=null,this._waitingFor=null,this._waitingQueue=null,this._spinCount=0,this._completion=new P((_,k)=>{this._resolve=_,this._reject=k}),this._completion.then(()=>{this.active=!1,this.on.complete.fire()},_=>{var k=this.active;return this.active=!1,this.on.error.fire(_),this.parent?this.parent._reject(_):k&&this.idbtrans&&this.idbtrans.abort(),pe(_)})})}(this),this.Version=function(f){return It(Sr.prototype,function(h){this.db=f,this._cfg={version:h,storesSource:null,dbschema:{},tables:{},contentUpgrade:null}})}(this),this.WhereClause=function(f){return It(tr.prototype,function(h,w,p){this.db=f,this._ctx={table:h,index:":id"===w?null:w,or:p};const g=f._deps.indexedDB;if(!g)throw new N.MissingAPI;this._cmp=this._ascending=g.cmp.bind(g),this._descending=(y,_)=>g.cmp(_,y),this._max=(y,_)=>g.cmp(y,_)>0?y:_,this._min=(y,_)=>g.cmp(y,_)<0?y:_,this._IDBKeyRange=f._deps.IDBKeyRange})}(this),this.on("versionchange",f=>{f.newVersion>0?console.warn(`Another connection wants to upgrade database '${this.name}'. Closing db now to resume the upgrade.`):console.warn(`Another connection wants to delete database '${this.name}'. Closing db now to resume the delete request.`),this.close()}),this.on("blocked",f=>{!f.newVersion||f.newVersion<f.oldVersion?console.warn(`Dexie.delete('${this.name}') was blocked`):console.warn(`Upgrade '${this.name}' blocked by other connection holding version ${f.oldVersion/10}`)}),this._maxKey=Ft(n.IDBKeyRange),this._createTransaction=(f,h,w,p)=>new this.Transaction(f,h,w,this._options.chromeTransactionDurability,p),this._fireOnBlocked=f=>{this.on("blocked").fire(f),Bt.filter(h=>h.name===this.name&&h!==this&&!h._state.vcFired).map(h=>h.on("versionchange").fire(f))},this.use(Or),this.use(Rr),this.use(Ur),this.use(Kr),this.vip=Object.create(this,{_vip:{value:!0}}),s.forEach(f=>f(this))}version(e){if(isNaN(e)||e<.1)throw new N.Type("Given version is not a positive number");if(e=Math.round(10*e)/10,this.idbdb||this._state.isBeingOpened)throw new N.Schema("Cannot add version when database is open");this.verno=Math.max(this.verno,e);const n=this._versions;var o=n.filter(s=>s._cfg.version===e)[0];return o||(o=new this.Version(e),n.push(o),n.sort(Ar),o.stores({}),this._state.autoSchema=!1,o)}_whenReady(e){return this.idbdb&&(this._state.openComplete||U.letThrough||this._vip)?e():new P((n,o)=>{if(this._state.openComplete)return o(new N.DatabaseClosed(this._state.dbOpenError));if(!this._state.isBeingOpened){if(!this._options.autoOpen)return void o(new N.DatabaseClosed);this.open().catch(z)}this._state.dbReadyPromise.then(n,o)}).then(e)}use({stack:e,create:n,level:o,name:s}){s&&this.unuse({stack:e,name:s});const u=this._middlewares[e]||(this._middlewares[e]=[]);return u.push({stack:e,create:n,level:o??10,name:s}),u.sort((c,f)=>c.level-f.level),this}unuse({stack:e,name:n,create:o}){return e&&this._middlewares[e]&&(this._middlewares[e]=this._middlewares[e].filter(s=>o?s.create!==o:!!n&&s.name!==n)),this}open(){return function Cr(t){const e=t._state,{indexedDB:n}=t._deps;if(e.isBeingOpened||t.idbdb)return e.dbReadyPromise.then(()=>e.dbOpenError?pe(e.dbOpenError):t);ke&&(e.openCanceller._stackHolder=xe()),e.isBeingOpened=!0,e.dbOpenError=null,e.openComplete=!1;const o=e.openCanceller;function s(){if(e.openCanceller!==o)throw new N.DatabaseClosed("db.open() was cancelled")}let u=e.dbReadyResolve,c=null,f=!1;return P.race([o,(typeof navigator>"u"?P.resolve():Pr()).then(()=>new P((h,w)=>{if(s(),!n)throw new N.MissingAPI;const p=t.name,g=e.autoSchema?n.open(p):n.open(p,Math.round(10*t.verno));if(!g)throw new N.MissingAPI;g.onerror=Te(w),g.onblocked=oe(t._fireOnBlocked),g.onupgradeneeded=oe(y=>{if(c=g.transaction,e.autoSchema&&!t._options.allowEmptyDB){g.onerror=At,c.abort(),g.result.close();const k=n.deleteDatabase(p);k.onsuccess=k.onerror=oe(()=>{w(new N.NoSuchDatabase(`Database ${p} doesnt exist`))})}else{c.onerror=Te(w);var _=y.oldVersion>Math.pow(2,62)?0:y.oldVersion;f=_<1,t._novip.idbdb=g.result,function Fr(t,e,n,o){const s=t._dbSchema,u=t._createTransaction("readwrite",t._storeNames,s);u.create(n),u._completion.catch(o);const c=u._reject.bind(u),f=U.transless||U;$e(()=>{U.trans=u,U.transless=f,0===e?(O(s).forEach(h=>{kn(n,h,s[h].primKey,s[h].indexes)}),En(t,n),P.follow(()=>t.on.populate.fire(u)).catch(c)):function({_novip:h},w,p,g){const y=[],_=h._versions;let k=h._dbSchema=An(0,h.idbdb,g),B=!1;return _.filter(E=>E._cfg.version>=w).forEach(E=>{y.push(()=>{const x=k,F=E._cfg.dbschema;Fn(h,x,g),Fn(h,F,g),k=h._dbSchema=F;const K=or(x,F);K.add.forEach(A=>{kn(g,A[0],A[1].primKey,A[1].indexes)}),K.change.forEach(A=>{if(A.recreate)throw new N.Upgrade("Not yet support for changing primary key");{const S=g.objectStore(A.name);A.add.forEach(L=>In(S,L)),A.change.forEach(L=>{S.deleteIndex(L.name),In(S,L)}),A.del.forEach(L=>S.deleteIndex(L))}});const C=E._cfg.contentUpgrade;if(C&&E._cfg.version>w){En(h,g),p._memoizedTables={},B=!0;let A=Tt(F);K.del.forEach(ee=>{A[ee]=x[ee]}),Bn(h,[h.Transaction.prototype]),Qt(h,[h.Transaction.prototype],O(A),A),p.schema=A;const S=tt(C);let L;S&&it();const R=P.follow(()=>{if(L=C(p),L&&S){var ee=Ke.bind(null,null);L.then(ee,ee)}});return L&&"function"==typeof L.then?P.resolve(L):R.then(()=>L)}}),y.push(x=>{var F,K;(!B||!gr)&&(F=E._cfg.dbschema,[].slice.call((K=x).db.objectStoreNames).forEach(C=>null==F[C]&&K.db.deleteObjectStore(C))),Bn(h,[h.Transaction.prototype]),Qt(h,[h.Transaction.prototype],h._storeNames,h._dbSchema),p.schema=h._dbSchema})}),function I(){return y.length?P.resolve(y.shift()(p.idbtrans)).then(I):P.resolve()}().then(()=>{var E,x;x=g,O(E=k).forEach(F=>{x.db.objectStoreNames.contains(F)||kn(x,F,E[F].primKey,E[F].indexes)})})}(t,e,u,n).catch(c)})}(t,_/10,c,w)}},w),g.onsuccess=oe(()=>{c=null;const y=t._novip.idbdb=g.result,_=de(y.objectStoreNames);if(_.length>0)try{const B=y.transaction(1===(k=_).length?k[0]:k,"readonly");e.autoSchema?function({_novip:I},E,x){I.verno=E.version/10;const F=I._dbSchema=An(0,E,x);I._storeNames=de(E.objectStoreNames,0),Qt(I,[I._allTables],O(F),F)}(t,y,B):(Fn(t,t._dbSchema,B),function(I,E){const x=or(An(0,I.idbdb,E),I._dbSchema);return!(x.add.length||x.change.some(F=>F.add.length||F.change.length))}(t,B)||console.warn("Dexie SchemaDiff: Schema was extended without increasing the number passed to db.version(). Some queries may fail.")),En(t,B)}catch{}var k;Bt.push(t),y.onversionchange=oe(B=>{e.vcFired=!0,t.on("versionchange").fire(B)}),y.onclose=oe(B=>{t.on("close").fire(B)}),f&&function({indexedDB:B,IDBKeyRange:I},E){!Pn(B)&&"__dbnames"!==E&&Sn(B,I).put({name:E}).catch(z)}(t._deps,p),h()},w)}))]).then(()=>(s(),e.onReadyBeingFired=[],P.resolve(Cn(()=>t.on.ready.fire(t.vip))).then(function h(){if(e.onReadyBeingFired.length>0){let w=e.onReadyBeingFired.reduce(l,z);return e.onReadyBeingFired=[],P.resolve(Cn(()=>w(t.vip))).then(h)}}))).finally(()=>{e.onReadyBeingFired=null,e.isBeingOpened=!1}).then(()=>t).catch(h=>{e.dbOpenError=h;try{c&&c.abort()}catch{}return o===e.openCanceller&&t._close(),pe(h)}).finally(()=>{e.openComplete=!0,u()})}(this)}_close(){const e=this._state,n=Bt.indexOf(this);if(n>=0&&Bt.splice(n,1),this.idbdb){try{this.idbdb.close()}catch{}this._novip.idbdb=null}e.dbReadyPromise=new P(o=>{e.dbReadyResolve=o}),e.openCanceller=new P((o,s)=>{e.cancelOpen=s})}close(){this._close();const e=this._state;this._options.autoOpen=!1,e.dbOpenError=new N.DatabaseClosed,e.isBeingOpened&&e.cancelOpen(e.dbOpenError)}delete(){const e=arguments.length>0,n=this._state;return new P((o,s)=>{const u=()=>{this.close();var c=this._deps.indexedDB.deleteDatabase(this.name);c.onsuccess=oe(()=>{(function({indexedDB:f,IDBKeyRange:h},w){!Pn(f)&&"__dbnames"!==w&&Sn(f,h).delete(w).catch(z)})(this._deps,this.name),o()}),c.onerror=Te(s),c.onblocked=this._fireOnBlocked};if(e)throw new N.InvalidArgument("Arguments not allowed in db.delete()");n.isBeingOpened?n.dbReadyPromise.then(u):u()})}backendDB(){return this.idbdb}isOpen(){return null!==this.idbdb}hasBeenClosed(){const e=this._state.dbOpenError;return e&&"DatabaseClosed"===e.name}hasFailed(){return null!==this._state.dbOpenError}dynamicallyOpened(){return this._state.autoSchema}get tables(){return O(this._allTables).map(e=>this._allTables[e])}transaction(){const e=Tr.apply(this,arguments);return this._transaction.apply(this,e)}_transaction(e,n,o){let s=U.trans;s&&s.db===this&&-1===e.indexOf("!")||(s=null);const u=-1!==e.indexOf("?");let c,f;e=e.replace("!","").replace("?","");try{if(f=n.map(w=>{var p=w instanceof this.Table?w.name:w;if("string"!=typeof p)throw new TypeError("Invalid table argument to Dexie.transaction(). Only Table or String are allowed");return p}),"r"==e||"readonly"===e)c="readonly";else{if("rw"!=e&&"readwrite"!=e)throw new N.InvalidArgument("Invalid transaction mode: "+e);c="readwrite"}if(s){if("readonly"===s.mode&&"readwrite"===c){if(!u)throw new N.SubTransaction("Cannot enter a sub-transaction with READWRITE mode when parent transaction is READONLY");s=null}s&&f.forEach(w=>{if(s&&-1===s.storeNames.indexOf(w)){if(!u)throw new N.SubTransaction("Table "+w+" not included in parent transaction.");s=null}}),u&&s&&!s.active&&(s=null)}}catch(w){return s?s._promise(null,(p,g)=>{g(w)}):pe(w)}const h=sr.bind(null,this,c,f,s,o);return s?s._promise(c,h,"lock"):U.trans?ot(U.transless,()=>this._whenReady(h)):this._whenReady(h)}table(e){if(!W(this._allTables,e))throw new N.InvalidTable(`Table ${e} does not exist`);return this._allTables[e]}}const jr=typeof Symbol<"u"&&"observable"in Symbol?Symbol.observable:"@@observable";class Nr{constructor(e){this._subscribe=e}subscribe(e,n,o){return this._subscribe(e&&"function"!=typeof e?e:{next:e,error:n,complete:o})}[jr](){return this}}function lr(t,e){return O(e).forEach(n=>{Xt(t[n]||(t[n]=new Ue),e[n])}),t}let Dn;try{Dn={indexedDB:T.indexedDB||T.mozIndexedDB||T.webkitIndexedDB||T.msIndexedDB,IDBKeyRange:T.IDBKeyRange||T.webkitIDBKeyRange}}catch{Dn={indexedDB:null,IDBKeyRange:null}}const Xe=Je;function en(t){let e=je;try{je=!0,We.storagemutated.fire(t)}finally{je=e}}le(Xe,{...Oe,delete:t=>new Xe(t,{addons:[]}).delete(),exists:t=>new Xe(t,{addons:[]}).open().then(e=>(e.close(),!0)).catch("NoSuchDatabaseError",()=>!1),getDatabaseNames(t){try{return function({indexedDB:e,IDBKeyRange:n}){return Pn(e)?Promise.resolve(e.databases()).then(o=>o.map(s=>s.name).filter(s=>"__dbnames"!==s)):Sn(e,n).toCollection().primaryKeys()}(Xe.dependencies).then(t)}catch{return pe(new N.MissingAPI)}},defineClass:()=>function(t){m(this,t)},ignoreTransaction:t=>U.trans?ot(U.transless,t):t(),vip:Cn,async:function(t){return function(){try{var e=Tn(t.apply(this,arguments));return e&&"function"==typeof e.then?e:P.resolve(e)}catch(n){return pe(n)}}},spawn:function(t,e,n){try{var o=Tn(t.apply(n,e||[]));return o&&"function"==typeof o.then?o:P.resolve(o)}catch(s){return pe(s)}},currentTransaction:{get:()=>U.trans||null},waitFor:function(t,e){const n=P.resolve("function"==typeof t?Xe.ignoreTransaction(t):t).timeout(e||6e4);return U.trans?U.trans.waitFor(n):n},Promise:P,debug:{get:()=>ke,set:t=>{yt(t,"dexie"===t?()=>!0:Vn)}},derive:V,extend:m,props:le,override:Se,Events:kt,on:We,liveQuery:function Mr(t){return new Nr(e=>{const n=tt(t);let o=!1,s={},u={};const c={get closed(){return o},unsubscribe:()=>{o=!0,We.storagemutated.unsubscribe(p)}};e.start&&e.start(c);let f=!1,h=!1;function w(){return O(u).some(y=>s[y]&&function Dr(t,e){const n=Kn(e);let o=n.next();if(o.done)return!1;let s=o.value;const u=Kn(t);let c=u.next(s.from),f=c.value;for(;!o.done&&!c.done;){if(ve(f.from,s.to)<=0&&ve(f.to,s.from)>=0)return!0;ve(s.from,f.from)<0?s=(o=n.next(f.from)).value:f=(c=u.next(s.from)).value}return!1}(s[y],u[y]))}const p=y=>{lr(s,y),w()&&g()},g=()=>{if(f||o)return;s={};const y={},_=function(k){n&&it();const B=()=>$e(t,{subscr:k,trans:null}),I=U.trans?ot(U.transless,B):B();return n&&I.then(Ke,Ke),I}(y);h||(We("storagemutated",p),h=!0),f=!0,Promise.resolve(_).then(k=>{f=!1,o||(w()?g():(s={},u=y,e.next&&e.next(k)))},k=>{f=!1,e.error&&e.error(k),c.unsubscribe()})};return g(),c})},extendObservabilitySet:lr,getByKeyPath:Fe,setByKeyPath:Be,delByKeyPath:function(t,e){"string"==typeof e?Be(t,e,void 0):"length"in e&&[].map.call(e,function(n){Be(t,n,void 0)})},shallowClone:Tt,deepClone:Ne,getObjectDiff:On,cmp:ve,asap:Ce,minKey:-1/0,addons:[],connections:Bt,errnames:Ge,dependencies:Dn,semVer:"3.2.3",version:"3.2.3".split(".").map(t=>parseInt(t)).reduce((t,e,n)=>t+e/Math.pow(10,2*n))}),Xe.maxKey=Ft(Xe.dependencies.IDBKeyRange),typeof dispatchEvent<"u"&&typeof addEventListener<"u"&&(We("storagemutated",t=>{if(!je){let e;Yt?(e=document.createEvent("CustomEvent"),e.initCustomEvent("x-storagemutated-1",!0,!0,t)):e=new CustomEvent("x-storagemutated-1",{detail:t}),je=!0,dispatchEvent(e),je=!1}}),addEventListener("x-storagemutated-1",({detail:t})=>{je||en(t)}));let je=!1;if(typeof BroadcastChannel<"u"){const t=new BroadcastChannel("x-storagemutated-1");"function"==typeof t.unref&&t.unref(),We("storagemutated",e=>{je||t.postMessage(e)}),t.onmessage=e=>{e.data&&en(e.data)}}else if(typeof self<"u"&&typeof navigator<"u"){We("storagemutated",e=>{try{je||(typeof localStorage<"u"&&localStorage.setItem("x-storagemutated-1",JSON.stringify({trig:Math.random(),changedParts:e})),"object"==typeof self.clients&&[...self.clients.matchAll({includeUncontrolled:!0})].forEach(n=>n.postMessage({type:"x-storagemutated-1",changedParts:e})))}catch{}}),typeof addEventListener<"u"&&addEventListener("storage",e=>{if("x-storagemutated-1"===e.key){const n=JSON.parse(e.newValue);n&&en(n.changedParts)}});const t=self.document&&navigator.serviceWorker;t&&t.addEventListener("message",function({data:e}){e&&"x-storagemutated-1"===e.type&&en(e.changedParts)})}P.rejectionMapper=function(t,e){if(!t||t instanceof Ie||t instanceof TypeError||t instanceof SyntaxError||!t.name||!bt[t.name])return t;var n=new bt[t.name](e||t.message,t);return"stack"in t&&$(n,"stack",{get:function(){return this.inner.stack}}),n},yt(ke,Vn);var Un=Y(8274),$r=Y(2897);let Lr=(()=>{class t{constructor(n,o){this.http=n,this.ea=o,this.access_token=null,this.config=Q_spotify,this.eps={base:{accounts:"https://accounts.spotify.com",api:"https://api.spotify.com"},authorize:"/authorize",api:"/api",token:"/token",version:"/v1",me:{albums:"/me/albums",savedAlbums:"/me/albums/contains"}},this.initDB()}initDB(){this.db=new Je("spotify"),this.db.version(1).stores({codes:"++id, type, code"}),this.table=this.db.table("codes")}getCode(){var n=this;return(0,D.Z)(function*(){return(yield n.table.get({type:"spotify"}))?.code||null})()}getHeaders(n=!1){const o=G.lW.from(this.config.clientId,"base64").toString(),s=G.lW.from(this.config.clientSecret,"base64").toString(),u=this.access_token?this.access_token:G.lW.from(o+":"+s).toString("base64");return(new ce.WM).set("Authorization",`${this.access_token?"Bearer":"Basic"} ${u}`).set("Content-Type","application/"+(n?"json":"x-www-form-urlencoded"))}getToken(){var n=this;return(0,D.Z)(function*(){let o=yield n.table.get({type:"spotify_tk"}),s=null;if(o)s=JSON.parse(o.code),n.access_token=s.access_token;else{const u=yield n.getCode(),c=new ce.LE({fromObject:{grant_type:"authorization_code",code:u,redirect_uri:`${location.origin}/callback`}}),f=n.getHeaders();s=yield new Promise(h=>{n.http.post(`${n.eps.base.accounts}${n.eps.api}${n.eps.token}`,c.toString(),{headers:f}).subscribe(function(){var w=(0,D.Z)(function*(p){n.access_token=p.access_token,yield n.table.add({type:"spotify_tk",code:JSON.stringify(p)}),h(p)});return function(p){return w.apply(this,arguments)}}())})}return s})()}preSave(){var n=this;return(0,D.Z)(function*(){yield n.getToken(),(yield n.checkNextRelease())||(yield n.storeNextRelease()),n.ea.trigger("toast:add","presave.done.spotify")})()}getStoredAlbums(){var n=this;return(0,D.Z)(function*(){const o=n.getHeaders();return yield new Promise(s=>{n.http.get(`${n.eps.base.api}${n.eps.version}${n.eps.me.albums}`,{headers:o}).subscribe(u=>{s(u)})})})()}checkNextRelease(){var n=this;return(0,D.Z)(function*(){const o=n.getHeaders();return yield new Promise(s=>{n.http.get(`${n.eps.base.api}${n.eps.version}${n.eps.me.savedAlbums}?ids=${Q_spotify.nextRelease}`,{headers:o}).subscribe(u=>{s(u[0])})})})()}storeNextRelease(){var n=this;return(0,D.Z)(function*(){const o=n.getHeaders(!0);return yield new Promise(s=>{n.http.put(`${n.eps.base.api}${n.eps.version}${n.eps.me.albums}`,JSON.stringify({ids:[Q_spotify.nextRelease]}),{headers:o}).subscribe(c=>{s(c)})})})()}authorize(){var n=this;return(0,D.Z)(function*(){if(yield n.getCode())return"";{const o=G.lW.from(n.config.clientId,"base64").toString(),s=new ce.LE({fromObject:{response_type:"code",client_id:o,scope:"user-follow-modify user-library-modify user-library-read user-follow-read",redirect_uri:`${location.origin}/callback`,state:"SWEETQ"}});return`${n.eps.base.accounts}${n.eps.authorize}?${s.toString()}`}})()}setCode(n){var o=this;return(0,D.Z)(function*(){yield o.table.add({type:"spotify",code:n}),yield o.preSave()})()}}return t.\u0275fac=function(n){return new(n||t)(Un.LFG(ce.eN),Un.LFG($r.Y))},t.\u0275prov=Un.Yz7({token:t,factory:t.\u0275fac}),t})()},5343:(lt,me)=>{"use strict";me.byteLength=function j(M){var $=O(M),he=$[1];return 3*($[0]+he)/4-he},me.toByteArray=function re(M){var $,fe,V=O(M),he=V[0],ye=V[1],se=new ce(function m(M,$,V){return 3*($+V)/4-V}(0,he,ye)),de=0,Se=ye>0?he-4:he;for(fe=0;fe<Se;fe+=4)$=D[M.charCodeAt(fe)]<<18|D[M.charCodeAt(fe+1)]<<12|D[M.charCodeAt(fe+2)]<<6|D[M.charCodeAt(fe+3)],se[de++]=$>>16&255,se[de++]=$>>8&255,se[de++]=255&$;return 2===ye&&($=D[M.charCodeAt(fe)]<<2|D[M.charCodeAt(fe+1)]>>4,se[de++]=255&$),1===ye&&($=D[M.charCodeAt(fe)]<<10|D[M.charCodeAt(fe+1)]<<4|D[M.charCodeAt(fe+2)]>>2,se[de++]=$>>8&255,se[de++]=255&$),se},me.fromByteArray=function le(M){for(var $,V=M.length,he=V%3,ye=[],de=0,Se=V-he;de<Se;de+=16383)ye.push(W(M,de,de+16383>Se?Se:de+16383));return 1===he?ye.push(Y[($=M[V-1])>>2]+Y[$<<4&63]+"=="):2===he&&ye.push(Y[($=(M[V-2]<<8)+M[V-1])>>10]+Y[$>>4&63]+Y[$<<2&63]+"="),ye.join("")};for(var Y=[],D=[],ce=typeof Uint8Array<"u"?Uint8Array:Array,Q="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",G=0,T=Q.length;G<T;++G)Y[G]=Q[G],D[Q.charCodeAt(G)]=G;function O(M){var $=M.length;if($%4>0)throw new Error("Invalid string. Length must be a multiple of 4");var V=M.indexOf("=");return-1===V&&(V=$),[V,V===$?0:4-V%4]}function J(M){return Y[M>>18&63]+Y[M>>12&63]+Y[M>>6&63]+Y[63&M]}function W(M,$,V){for(var ye=[],se=$;se<V;se+=3)ye.push(J((M[se]<<16&16711680)+(M[se+1]<<8&65280)+(255&M[se+2])));return ye.join("")}D["-".charCodeAt(0)]=62,D["_".charCodeAt(0)]=63},3172:(lt,me,Y)=>{"use strict";const ce=Y(5343),Q=Y(8461),G="function"==typeof Symbol&&"function"==typeof Symbol.for?Symbol.for("nodejs.util.inspect.custom"):null;me.lW=m,me.h2=50;const T=2147483647;function j(a){if(a>T)throw new RangeError('The value "'+a+'" is invalid for option "size"');const r=new Uint8Array(a);return Object.setPrototypeOf(r,m.prototype),r}function m(a,r,i){if("number"==typeof a){if("string"==typeof r)throw new TypeError('The "string" argument must be of type string. Received type number');return le(a)}return re(a,r,i)}function re(a,r,i){if("string"==typeof a)return function M(a,r){if(("string"!=typeof r||""===r)&&(r="utf8"),!m.isEncoding(r))throw new TypeError("Unknown encoding: "+r);const i=0|Se(a,r);let l=j(i);const d=l.write(a,r);return d!==i&&(l=l.slice(0,d)),l}(a,r);if(ArrayBuffer.isView(a))return function V(a){if(z(a,Uint8Array)){const r=new Uint8Array(a);return he(r.buffer,r.byteOffset,r.byteLength)}return $(a)}(a);if(null==a)throw new TypeError("The first argument must be one of type string, Buffer, ArrayBuffer, Array, or Array-like Object. Received type "+typeof a);if(z(a,ArrayBuffer)||a&&z(a.buffer,ArrayBuffer)||typeof SharedArrayBuffer<"u"&&(z(a,SharedArrayBuffer)||a&&z(a.buffer,SharedArrayBuffer)))return he(a,r,i);if("number"==typeof a)throw new TypeError('The "value" argument must not be of type number. Received type number');const l=a.valueOf&&a.valueOf();if(null!=l&&l!==a)return m.from(l,r,i);const d=function ye(a){if(m.isBuffer(a)){const r=0|se(a.length),i=j(r);return 0===i.length||a.copy(i,0,0,r),i}return void 0!==a.length?"number"!=typeof a.length||Re(a.length)?j(0):$(a):"Buffer"===a.type&&Array.isArray(a.data)?$(a.data):void 0}(a);if(d)return d;if(typeof Symbol<"u"&&null!=Symbol.toPrimitive&&"function"==typeof a[Symbol.toPrimitive])return m.from(a[Symbol.toPrimitive]("string"),r,i);throw new TypeError("The first argument must be one of type string, Buffer, ArrayBuffer, Array, or Array-like Object. Received type "+typeof a)}function J(a){if("number"!=typeof a)throw new TypeError('"size" argument must be of type number');if(a<0)throw new RangeError('The value "'+a+'" is invalid for option "size"')}function le(a){return J(a),j(a<0?0:0|se(a))}function $(a){const r=a.length<0?0:0|se(a.length),i=j(r);for(let l=0;l<r;l+=1)i[l]=255&a[l];return i}function he(a,r,i){if(r<0||a.byteLength<r)throw new RangeError('"offset" is outside of buffer bounds');if(a.byteLength<r+(i||0))throw new RangeError('"length" is outside of buffer bounds');let l;return l=void 0===r&&void 0===i?new Uint8Array(a):void 0===i?new Uint8Array(a,r):new Uint8Array(a,r,i),Object.setPrototypeOf(l,m.prototype),l}function se(a){if(a>=T)throw new RangeError("Attempt to allocate Buffer larger than maximum size: 0x"+T.toString(16)+" bytes");return 0|a}function Se(a,r){if(m.isBuffer(a))return a.length;if(ArrayBuffer.isView(a)||z(a,ArrayBuffer))return a.byteLength;if("string"!=typeof a)throw new TypeError('The "string" argument must be one of type string, Buffer, or ArrayBuffer. Received type '+typeof a);const i=a.length,l=arguments.length>2&&!0===arguments[2];if(!l&&0===i)return 0;let d=!1;for(;;)switch(r){case"ascii":case"latin1":case"binary":return i;case"utf8":case"utf-8":return Ge(a).length;case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return 2*i;case"hex":return i>>>1;case"base64":return bt(a).length;default:if(d)return l?-1:Ge(a).length;r=(""+r).toLowerCase(),d=!0}}function fe(a,r,i){let l=!1;if((void 0===r||r<0)&&(r=0),r>this.length||((void 0===i||i>this.length)&&(i=this.length),i<=0)||(i>>>=0)<=(r>>>=0))return"";for(a||(a="utf8");;)switch(a){case"hex":return pt(this,r,i);case"utf8":case"utf-8":return Pe(this,r,i);case"ascii":return rn(this,r,i);case"latin1":case"binary":return dt(this,r,i);case"base64":return nn(this,r,i);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return on(this,r,i);default:if(l)throw new TypeError("Unknown encoding: "+a);a=(a+"").toLowerCase(),l=!0}}function Ce(a,r,i){const l=a[r];a[r]=a[i],a[i]=l}function ht(a,r,i,l,d){if(0===a.length)return-1;if("string"==typeof i?(l=i,i=0):i>2147483647?i=2147483647:i<-2147483648&&(i=-2147483648),Re(i=+i)&&(i=d?0:a.length-1),i<0&&(i=a.length+i),i>=a.length){if(d)return-1;i=a.length-1}else if(i<0){if(!d)return-1;i=0}if("string"==typeof r&&(r=m.from(r,l)),m.isBuffer(r))return 0===r.length?-1:Fe(a,r,i,l,d);if("number"==typeof r)return r&=255,"function"==typeof Uint8Array.prototype.indexOf?d?Uint8Array.prototype.indexOf.call(a,r,i):Uint8Array.prototype.lastIndexOf.call(a,r,i):Fe(a,[r],i,l,d);throw new TypeError("val must be string, number or Buffer")}function Fe(a,r,i,l,d){let Z,b=1,v=a.length,q=r.length;if(void 0!==l&&("ucs2"===(l=String(l).toLowerCase())||"ucs-2"===l||"utf16le"===l||"utf-16le"===l)){if(a.length<2||r.length<2)return-1;b=2,v/=2,q/=2,i/=2}function ne(X,H){return 1===b?X[H]:X.readUInt16BE(H*b)}if(d){let X=-1;for(Z=i;Z<v;Z++)if(ne(a,Z)===ne(r,-1===X?0:Z-X)){if(-1===X&&(X=Z),Z-X+1===q)return X*b}else-1!==X&&(Z-=Z-X),X=-1}else for(i+q>v&&(i=v-q),Z=i;Z>=0;Z--){let X=!0;for(let H=0;H<q;H++)if(ne(a,Z+H)!==ne(r,H)){X=!1;break}if(X)return Z}return-1}function Be(a,r,i,l){i=Number(i)||0;const d=a.length-i;l?(l=Number(l))>d&&(l=d):l=d;const b=r.length;let v;for(l>b/2&&(l=b/2),v=0;v<l;++v){const q=parseInt(r.substr(2*v,2),16);if(Re(q))return v;a[i+v]=q}return v}function Tt(a,r,i,l){return Oe(Ge(r,a.length-i),a,i,l)}function tn(a,r,i,l){return Oe(function sn(a){const r=[];for(let i=0;i<a.length;++i)r.push(255&a.charCodeAt(i));return r}(r),a,i,l)}function Ot(a,r,i,l){return Oe(bt(r),a,i,l)}function Rt(a,r,i,l){return Oe(function N(a,r){let i,l,d;const b=[];for(let v=0;v<a.length&&!((r-=2)<0);++v)i=a.charCodeAt(v),l=i>>8,d=i%256,b.push(d),b.push(l);return b}(r,a.length-i),a,i,l)}function nn(a,r,i){return ce.fromByteArray(0===r&&i===a.length?a:a.slice(r,i))}function Pe(a,r,i){i=Math.min(a.length,i);const l=[];let d=r;for(;d<i;){const b=a[d];let v=null,q=b>239?4:b>223?3:b>191?2:1;if(d+q<=i){let ne,Z,X,H;switch(q){case 1:b<128&&(v=b);break;case 2:ne=a[d+1],128==(192&ne)&&(H=(31&b)<<6|63&ne,H>127&&(v=H));break;case 3:ne=a[d+1],Z=a[d+2],128==(192&ne)&&128==(192&Z)&&(H=(15&b)<<12|(63&ne)<<6|63&Z,H>2047&&(H<55296||H>57343)&&(v=H));break;case 4:ne=a[d+1],Z=a[d+2],X=a[d+3],128==(192&ne)&&128==(192&Z)&&128==(192&X)&&(H=(15&b)<<18|(63&ne)<<12|(63&Z)<<6|63&X,H>65535&&H<1114112&&(v=H))}}null===v?(v=65533,q=1):v>65535&&(v-=65536,l.push(v>>>10&1023|55296),v=56320|1023&v),l.push(v),d+=q}return function ft(a){const r=a.length;if(r<=Ne)return String.fromCharCode.apply(String,a);let i="",l=0;for(;l<r;)i+=String.fromCharCode.apply(String,a.slice(l,l+=Ne));return i}(l)}!(m.TYPED_ARRAY_SUPPORT=function O(){try{const a=new Uint8Array(1),r={foo:function(){return 42}};return Object.setPrototypeOf(r,Uint8Array.prototype),Object.setPrototypeOf(a,r),42===a.foo()}catch{return!1}}())&&typeof console<"u"&&"function"==typeof console.error&&console.error("This browser lacks typed array (Uint8Array) support which is required by `buffer` v5.x. Use `buffer` v4.x if you require old browser support."),Object.defineProperty(m.prototype,"parent",{enumerable:!0,get:function(){if(m.isBuffer(this))return this.buffer}}),Object.defineProperty(m.prototype,"offset",{enumerable:!0,get:function(){if(m.isBuffer(this))return this.byteOffset}}),m.poolSize=8192,m.from=function(a,r,i){return re(a,r,i)},Object.setPrototypeOf(m.prototype,Uint8Array.prototype),Object.setPrototypeOf(m,Uint8Array),m.alloc=function(a,r,i){return function W(a,r,i){return J(a),a<=0?j(a):void 0!==r?"string"==typeof i?j(a).fill(r,i):j(a).fill(r):j(a)}(a,r,i)},m.allocUnsafe=function(a){return le(a)},m.allocUnsafeSlow=function(a){return le(a)},m.isBuffer=function(r){return null!=r&&!0===r._isBuffer&&r!==m.prototype},m.compare=function(r,i){if(z(r,Uint8Array)&&(r=m.from(r,r.offset,r.byteLength)),z(i,Uint8Array)&&(i=m.from(i,i.offset,i.byteLength)),!m.isBuffer(r)||!m.isBuffer(i))throw new TypeError('The "buf1", "buf2" arguments must be one of type Buffer or Uint8Array');if(r===i)return 0;let l=r.length,d=i.length;for(let b=0,v=Math.min(l,d);b<v;++b)if(r[b]!==i[b]){l=r[b],d=i[b];break}return l<d?-1:d<l?1:0},m.isEncoding=function(r){switch(String(r).toLowerCase()){case"hex":case"utf8":case"utf-8":case"ascii":case"latin1":case"binary":case"base64":case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return!0;default:return!1}},m.concat=function(r,i){if(!Array.isArray(r))throw new TypeError('"list" argument must be an Array of Buffers');if(0===r.length)return m.alloc(0);let l;if(void 0===i)for(i=0,l=0;l<r.length;++l)i+=r[l].length;const d=m.allocUnsafe(i);let b=0;for(l=0;l<r.length;++l){let v=r[l];if(z(v,Uint8Array))b+v.length>d.length?(m.isBuffer(v)||(v=m.from(v)),v.copy(d,b)):Uint8Array.prototype.set.call(d,v,b);else{if(!m.isBuffer(v))throw new TypeError('"list" argument must be an Array of Buffers');v.copy(d,b)}b+=v.length}return d},m.byteLength=Se,m.prototype._isBuffer=!0,m.prototype.swap16=function(){const r=this.length;if(r%2!=0)throw new RangeError("Buffer size must be a multiple of 16-bits");for(let i=0;i<r;i+=2)Ce(this,i,i+1);return this},m.prototype.swap32=function(){const r=this.length;if(r%4!=0)throw new RangeError("Buffer size must be a multiple of 32-bits");for(let i=0;i<r;i+=4)Ce(this,i,i+3),Ce(this,i+1,i+2);return this},m.prototype.swap64=function(){const r=this.length;if(r%8!=0)throw new RangeError("Buffer size must be a multiple of 64-bits");for(let i=0;i<r;i+=8)Ce(this,i,i+7),Ce(this,i+1,i+6),Ce(this,i+2,i+5),Ce(this,i+3,i+4);return this},m.prototype.toLocaleString=m.prototype.toString=function(){const r=this.length;return 0===r?"":0===arguments.length?Pe(this,0,r):fe.apply(this,arguments)},m.prototype.equals=function(r){if(!m.isBuffer(r))throw new TypeError("Argument must be a Buffer");return this===r||0===m.compare(this,r)},m.prototype.inspect=function(){let r="";const i=me.h2;return r=this.toString("hex",0,i).replace(/(.{2})/g,"$1 ").trim(),this.length>i&&(r+=" ... "),"<Buffer "+r+">"},G&&(m.prototype[G]=m.prototype.inspect),m.prototype.compare=function(r,i,l,d,b){if(z(r,Uint8Array)&&(r=m.from(r,r.offset,r.byteLength)),!m.isBuffer(r))throw new TypeError('The "target" argument must be one of type Buffer or Uint8Array. Received type '+typeof r);if(void 0===i&&(i=0),void 0===l&&(l=r?r.length:0),void 0===d&&(d=0),void 0===b&&(b=this.length),i<0||l>r.length||d<0||b>this.length)throw new RangeError("out of range index");if(d>=b&&i>=l)return 0;if(d>=b)return-1;if(i>=l)return 1;if(this===r)return 0;let v=(b>>>=0)-(d>>>=0),q=(l>>>=0)-(i>>>=0);const ne=Math.min(v,q),Z=this.slice(d,b),X=r.slice(i,l);for(let H=0;H<ne;++H)if(Z[H]!==X[H]){v=Z[H],q=X[H];break}return v<q?-1:q<v?1:0},m.prototype.includes=function(r,i,l){return-1!==this.indexOf(r,i,l)},m.prototype.indexOf=function(r,i,l){return ht(this,r,i,l,!0)},m.prototype.lastIndexOf=function(r,i,l){return ht(this,r,i,l,!1)},m.prototype.write=function(r,i,l,d){if(void 0===i)d="utf8",l=this.length,i=0;else if(void 0===l&&"string"==typeof i)d=i,l=this.length,i=0;else{if(!isFinite(i))throw new Error("Buffer.write(string, encoding, offset[, length]) is no longer supported");i>>>=0,isFinite(l)?(l>>>=0,void 0===d&&(d="utf8")):(d=l,l=void 0)}const b=this.length-i;if((void 0===l||l>b)&&(l=b),r.length>0&&(l<0||i<0)||i>this.length)throw new RangeError("Attempt to write outside buffer bounds");d||(d="utf8");let v=!1;for(;;)switch(d){case"hex":return Be(this,r,i,l);case"utf8":case"utf-8":return Tt(this,r,i,l);case"ascii":case"latin1":case"binary":return tn(this,r,i,l);case"base64":return Ot(this,r,i,l);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return Rt(this,r,i,l);default:if(v)throw new TypeError("Unknown encoding: "+d);d=(""+d).toLowerCase(),v=!0}},m.prototype.toJSON=function(){return{type:"Buffer",data:Array.prototype.slice.call(this._arr||this,0)}};const Ne=4096;function rn(a,r,i){let l="";i=Math.min(a.length,i);for(let d=r;d<i;++d)l+=String.fromCharCode(127&a[d]);return l}function dt(a,r,i){let l="";i=Math.min(a.length,i);for(let d=r;d<i;++d)l+=String.fromCharCode(a[d]);return l}function pt(a,r,i){const l=a.length;(!r||r<0)&&(r=0),(!i||i<0||i>l)&&(i=l);let d="";for(let b=r;b<i;++b)d+=an[a[b]];return d}function on(a,r,i){const l=a.slice(r,i);let d="";for(let b=0;b<l.length-1;b+=2)d+=String.fromCharCode(l[b]+256*l[b+1]);return d}function te(a,r,i){if(a%1!=0||a<0)throw new RangeError("offset is not uint");if(a+r>i)throw new RangeError("Trying to access beyond buffer length")}function ie(a,r,i,l,d,b){if(!m.isBuffer(a))throw new TypeError('"buffer" argument must be a Buffer instance');if(r>d||r<b)throw new RangeError('"value" argument is out of bounds');if(i+l>a.length)throw new RangeError("Index out of range")}function tt(a,r,i,l,d){Dt(r,l,d,a,i,7);let b=Number(r&BigInt(4294967295));a[i++]=b,b>>=8,a[i++]=b,b>>=8,a[i++]=b,b>>=8,a[i++]=b;let v=Number(r>>BigInt(32)&BigInt(4294967295));return a[i++]=v,v>>=8,a[i++]=v,v>>=8,a[i++]=v,v>>=8,a[i++]=v,i}function ke(a,r,i,l,d){Dt(r,l,d,a,i,7);let b=Number(r&BigInt(4294967295));a[i+7]=b,b>>=8,a[i+6]=b,b>>=8,a[i+5]=b,b>>=8,a[i+4]=b;let v=Number(r>>BigInt(32)&BigInt(4294967295));return a[i+3]=v,v>>=8,a[i+2]=v,v>>=8,a[i+1]=v,v>>=8,a[i]=v,i+8}function yt(a,r,i,l,d,b){if(i+l>a.length)throw new RangeError("Index out of range");if(i<0)throw new RangeError("Index out of range")}function mt(a,r,i,l,d){return r=+r,i>>>=0,d||yt(a,0,i,4),Q.write(a,r,i,l,23,4),i+4}function Kt(a,r,i,l,d){return r=+r,i>>>=0,d||yt(a,0,i,8),Q.write(a,r,i,l,52,8),i+8}m.prototype.slice=function(r,i){const l=this.length;(r=~~r)<0?(r+=l)<0&&(r=0):r>l&&(r=l),(i=void 0===i?l:~~i)<0?(i+=l)<0&&(i=0):i>l&&(i=l),i<r&&(i=r);const d=this.subarray(r,i);return Object.setPrototypeOf(d,m.prototype),d},m.prototype.readUintLE=m.prototype.readUIntLE=function(r,i,l){r>>>=0,i>>>=0,l||te(r,i,this.length);let d=this[r],b=1,v=0;for(;++v<i&&(b*=256);)d+=this[r+v]*b;return d},m.prototype.readUintBE=m.prototype.readUIntBE=function(r,i,l){r>>>=0,i>>>=0,l||te(r,i,this.length);let d=this[r+--i],b=1;for(;i>0&&(b*=256);)d+=this[r+--i]*b;return d},m.prototype.readUint8=m.prototype.readUInt8=function(r,i){return r>>>=0,i||te(r,1,this.length),this[r]},m.prototype.readUint16LE=m.prototype.readUInt16LE=function(r,i){return r>>>=0,i||te(r,2,this.length),this[r]|this[r+1]<<8},m.prototype.readUint16BE=m.prototype.readUInt16BE=function(r,i){return r>>>=0,i||te(r,2,this.length),this[r]<<8|this[r+1]},m.prototype.readUint32LE=m.prototype.readUInt32LE=function(r,i){return r>>>=0,i||te(r,4,this.length),(this[r]|this[r+1]<<8|this[r+2]<<16)+16777216*this[r+3]},m.prototype.readUint32BE=m.prototype.readUInt32BE=function(r,i){return r>>>=0,i||te(r,4,this.length),16777216*this[r]+(this[r+1]<<16|this[r+2]<<8|this[r+3])},m.prototype.readBigUInt64LE=ge(function(r){Ie(r>>>=0,"offset");const i=this[r],l=this[r+7];(void 0===i||void 0===l)&&Me(r,this.length-8);const d=i+256*this[++r]+65536*this[++r]+this[++r]*2**24,b=this[++r]+256*this[++r]+65536*this[++r]+l*2**24;return BigInt(d)+(BigInt(b)<<BigInt(32))}),m.prototype.readBigUInt64BE=ge(function(r){Ie(r>>>=0,"offset");const i=this[r],l=this[r+7];(void 0===i||void 0===l)&&Me(r,this.length-8);const d=i*2**24+65536*this[++r]+256*this[++r]+this[++r],b=this[++r]*2**24+65536*this[++r]+256*this[++r]+l;return(BigInt(d)<<BigInt(32))+BigInt(b)}),m.prototype.readIntLE=function(r,i,l){r>>>=0,i>>>=0,l||te(r,i,this.length);let d=this[r],b=1,v=0;for(;++v<i&&(b*=256);)d+=this[r+v]*b;return b*=128,d>=b&&(d-=Math.pow(2,8*i)),d},m.prototype.readIntBE=function(r,i,l){r>>>=0,i>>>=0,l||te(r,i,this.length);let d=i,b=1,v=this[r+--d];for(;d>0&&(b*=256);)v+=this[r+--d]*b;return b*=128,v>=b&&(v-=Math.pow(2,8*i)),v},m.prototype.readInt8=function(r,i){return r>>>=0,i||te(r,1,this.length),128&this[r]?-1*(255-this[r]+1):this[r]},m.prototype.readInt16LE=function(r,i){r>>>=0,i||te(r,2,this.length);const l=this[r]|this[r+1]<<8;return 32768&l?4294901760|l:l},m.prototype.readInt16BE=function(r,i){r>>>=0,i||te(r,2,this.length);const l=this[r+1]|this[r]<<8;return 32768&l?4294901760|l:l},m.prototype.readInt32LE=function(r,i){return r>>>=0,i||te(r,4,this.length),this[r]|this[r+1]<<8|this[r+2]<<16|this[r+3]<<24},m.prototype.readInt32BE=function(r,i){return r>>>=0,i||te(r,4,this.length),this[r]<<24|this[r+1]<<16|this[r+2]<<8|this[r+3]},m.prototype.readBigInt64LE=ge(function(r){Ie(r>>>=0,"offset");const i=this[r],l=this[r+7];return(void 0===i||void 0===l)&&Me(r,this.length-8),(BigInt(this[r+4]+256*this[r+5]+65536*this[r+6]+(l<<24))<<BigInt(32))+BigInt(i+256*this[++r]+65536*this[++r]+this[++r]*2**24)}),m.prototype.readBigInt64BE=ge(function(r){Ie(r>>>=0,"offset");const i=this[r],l=this[r+7];(void 0===i||void 0===l)&&Me(r,this.length-8);const d=(i<<24)+65536*this[++r]+256*this[++r]+this[++r];return(BigInt(d)<<BigInt(32))+BigInt(this[++r]*2**24+65536*this[++r]+256*this[++r]+l)}),m.prototype.readFloatLE=function(r,i){return r>>>=0,i||te(r,4,this.length),Q.read(this,r,!0,23,4)},m.prototype.readFloatBE=function(r,i){return r>>>=0,i||te(r,4,this.length),Q.read(this,r,!1,23,4)},m.prototype.readDoubleLE=function(r,i){return r>>>=0,i||te(r,8,this.length),Q.read(this,r,!0,52,8)},m.prototype.readDoubleBE=function(r,i){return r>>>=0,i||te(r,8,this.length),Q.read(this,r,!1,52,8)},m.prototype.writeUintLE=m.prototype.writeUIntLE=function(r,i,l,d){r=+r,i>>>=0,l>>>=0,d||ie(this,r,i,l,Math.pow(2,8*l)-1,0);let b=1,v=0;for(this[i]=255&r;++v<l&&(b*=256);)this[i+v]=r/b&255;return i+l},m.prototype.writeUintBE=m.prototype.writeUIntBE=function(r,i,l,d){r=+r,i>>>=0,l>>>=0,d||ie(this,r,i,l,Math.pow(2,8*l)-1,0);let b=l-1,v=1;for(this[i+b]=255&r;--b>=0&&(v*=256);)this[i+b]=r/v&255;return i+l},m.prototype.writeUint8=m.prototype.writeUInt8=function(r,i,l){return r=+r,i>>>=0,l||ie(this,r,i,1,255,0),this[i]=255&r,i+1},m.prototype.writeUint16LE=m.prototype.writeUInt16LE=function(r,i,l){return r=+r,i>>>=0,l||ie(this,r,i,2,65535,0),this[i]=255&r,this[i+1]=r>>>8,i+2},m.prototype.writeUint16BE=m.prototype.writeUInt16BE=function(r,i,l){return r=+r,i>>>=0,l||ie(this,r,i,2,65535,0),this[i]=r>>>8,this[i+1]=255&r,i+2},m.prototype.writeUint32LE=m.prototype.writeUInt32LE=function(r,i,l){return r=+r,i>>>=0,l||ie(this,r,i,4,4294967295,0),this[i+3]=r>>>24,this[i+2]=r>>>16,this[i+1]=r>>>8,this[i]=255&r,i+4},m.prototype.writeUint32BE=m.prototype.writeUInt32BE=function(r,i,l){return r=+r,i>>>=0,l||ie(this,r,i,4,4294967295,0),this[i]=r>>>24,this[i+1]=r>>>16,this[i+2]=r>>>8,this[i+3]=255&r,i+4},m.prototype.writeBigUInt64LE=ge(function(r,i=0){return tt(this,r,i,BigInt(0),BigInt("0xffffffffffffffff"))}),m.prototype.writeBigUInt64BE=ge(function(r,i=0){return ke(this,r,i,BigInt(0),BigInt("0xffffffffffffffff"))}),m.prototype.writeIntLE=function(r,i,l,d){if(r=+r,i>>>=0,!d){const ne=Math.pow(2,8*l-1);ie(this,r,i,l,ne-1,-ne)}let b=0,v=1,q=0;for(this[i]=255&r;++b<l&&(v*=256);)r<0&&0===q&&0!==this[i+b-1]&&(q=1),this[i+b]=(r/v>>0)-q&255;return i+l},m.prototype.writeIntBE=function(r,i,l,d){if(r=+r,i>>>=0,!d){const ne=Math.pow(2,8*l-1);ie(this,r,i,l,ne-1,-ne)}let b=l-1,v=1,q=0;for(this[i+b]=255&r;--b>=0&&(v*=256);)r<0&&0===q&&0!==this[i+b+1]&&(q=1),this[i+b]=(r/v>>0)-q&255;return i+l},m.prototype.writeInt8=function(r,i,l){return r=+r,i>>>=0,l||ie(this,r,i,1,127,-128),r<0&&(r=255+r+1),this[i]=255&r,i+1},m.prototype.writeInt16LE=function(r,i,l){return r=+r,i>>>=0,l||ie(this,r,i,2,32767,-32768),this[i]=255&r,this[i+1]=r>>>8,i+2},m.prototype.writeInt16BE=function(r,i,l){return r=+r,i>>>=0,l||ie(this,r,i,2,32767,-32768),this[i]=r>>>8,this[i+1]=255&r,i+2},m.prototype.writeInt32LE=function(r,i,l){return r=+r,i>>>=0,l||ie(this,r,i,4,2147483647,-2147483648),this[i]=255&r,this[i+1]=r>>>8,this[i+2]=r>>>16,this[i+3]=r>>>24,i+4},m.prototype.writeInt32BE=function(r,i,l){return r=+r,i>>>=0,l||ie(this,r,i,4,2147483647,-2147483648),r<0&&(r=4294967295+r+1),this[i]=r>>>24,this[i+1]=r>>>16,this[i+2]=r>>>8,this[i+3]=255&r,i+4},m.prototype.writeBigInt64LE=ge(function(r,i=0){return tt(this,r,i,-BigInt("0x8000000000000000"),BigInt("0x7fffffffffffffff"))}),m.prototype.writeBigInt64BE=ge(function(r,i=0){return ke(this,r,i,-BigInt("0x8000000000000000"),BigInt("0x7fffffffffffffff"))}),m.prototype.writeFloatLE=function(r,i,l){return mt(this,r,i,!0,l)},m.prototype.writeFloatBE=function(r,i,l){return mt(this,r,i,!1,l)},m.prototype.writeDoubleLE=function(r,i,l){return Kt(this,r,i,!0,l)},m.prototype.writeDoubleBE=function(r,i,l){return Kt(this,r,i,!1,l)},m.prototype.copy=function(r,i,l,d){if(!m.isBuffer(r))throw new TypeError("argument should be a Buffer");if(l||(l=0),!d&&0!==d&&(d=this.length),i>=r.length&&(i=r.length),i||(i=0),d>0&&d<l&&(d=l),d===l||0===r.length||0===this.length)return 0;if(i<0)throw new RangeError("targetStart out of bounds");if(l<0||l>=this.length)throw new RangeError("Index out of range");if(d<0)throw new RangeError("sourceEnd out of bounds");d>this.length&&(d=this.length),r.length-i<d-l&&(d=r.length-i+l);const b=d-l;return this===r&&"function"==typeof Uint8Array.prototype.copyWithin?this.copyWithin(i,l,d):Uint8Array.prototype.set.call(r,this.subarray(l,d),i),b},m.prototype.fill=function(r,i,l,d){if("string"==typeof r){if("string"==typeof i?(d=i,i=0,l=this.length):"string"==typeof l&&(d=l,l=this.length),void 0!==d&&"string"!=typeof d)throw new TypeError("encoding must be a string");if("string"==typeof d&&!m.isEncoding(d))throw new TypeError("Unknown encoding: "+d);if(1===r.length){const v=r.charCodeAt(0);("utf8"===d&&v<128||"latin1"===d)&&(r=v)}}else"number"==typeof r?r&=255:"boolean"==typeof r&&(r=Number(r));if(i<0||this.length<i||this.length<l)throw new RangeError("Out of range index");if(l<=i)return this;let b;if(i>>>=0,l=void 0===l?this.length:l>>>0,r||(r=0),"number"==typeof r)for(b=i;b<l;++b)this[b]=r;else{const v=m.isBuffer(r)?r:m.from(r,d),q=v.length;if(0===q)throw new TypeError('The value "'+r+'" is invalid for argument "value"');for(b=0;b<l-i;++b)this[b+i]=v[b%q]}return this};const xe={};function ze(a,r,i){xe[a]=class extends i{constructor(){super(),Object.defineProperty(this,"message",{value:r.apply(this,arguments),writable:!0,configurable:!0}),this.name=`${this.name} [${a}]`,delete this.name}get code(){return a}set code(d){Object.defineProperty(this,"code",{configurable:!0,enumerable:!0,value:d,writable:!0})}toString(){return`${this.name} [${a}]: ${this.message}`}}}function gt(a){let r="",i=a.length;const l="-"===a[0]?1:0;for(;i>=l+4;i-=3)r=`_${a.slice(i-3,i)}${r}`;return`${a.slice(0,i)}${r}`}function Dt(a,r,i,l,d,b){if(a>i||a<r){const v="bigint"==typeof r?"n":"";let q;throw q=b>3?0===r||r===BigInt(0)?`>= 0${v} and < 2${v} ** ${8*(b+1)}${v}`:`>= -(2${v} ** ${8*(b+1)-1}${v}) and < 2 ** ${8*(b+1)-1}${v}`:`>= ${r}${v} and <= ${i}${v}`,new xe.ERR_OUT_OF_RANGE("value",q,a)}!function wt(a,r,i){Ie(r,"offset"),(void 0===a[r]||void 0===a[r+i])&&Me(r,a.length-(i+1))}(l,d,b)}function Ie(a,r){if("number"!=typeof a)throw new xe.ERR_INVALID_ARG_TYPE(r,"number",a)}function Me(a,r,i){throw Math.floor(a)!==a?(Ie(a,i),new xe.ERR_OUT_OF_RANGE(i||"offset","an integer",a)):r<0?new xe.ERR_BUFFER_OUT_OF_BOUNDS:new xe.ERR_OUT_OF_RANGE(i||"offset",`>= ${i?1:0} and <= ${r}`,a)}ze("ERR_BUFFER_OUT_OF_BOUNDS",function(a){return a?`${a} is outside of buffer bounds`:"Attempt to access memory outside buffer bounds"},RangeError),ze("ERR_INVALID_ARG_TYPE",function(a,r){return`The "${a}" argument must be of type number. Received type ${typeof r}`},TypeError),ze("ERR_OUT_OF_RANGE",function(a,r,i){let l=`The value of "${a}" is out of range.`,d=i;return Number.isInteger(i)&&Math.abs(i)>2**32?d=gt(String(i)):"bigint"==typeof i&&(d=String(i),(i>BigInt(2)**BigInt(32)||i<-(BigInt(2)**BigInt(32)))&&(d=gt(d)),d+="n"),l+=` It must be ${r}. Received ${d}`,l},RangeError);const nt=/[^+/0-9A-Za-z-_]/g;function Ge(a,r){let i;r=r||1/0;const l=a.length;let d=null;const b=[];for(let v=0;v<l;++v){if(i=a.charCodeAt(v),i>55295&&i<57344){if(!d){if(i>56319){(r-=3)>-1&&b.push(239,191,189);continue}if(v+1===l){(r-=3)>-1&&b.push(239,191,189);continue}d=i;continue}if(i<56320){(r-=3)>-1&&b.push(239,191,189),d=i;continue}i=65536+(d-55296<<10|i-56320)}else d&&(r-=3)>-1&&b.push(239,191,189);if(d=null,i<128){if((r-=1)<0)break;b.push(i)}else if(i<2048){if((r-=2)<0)break;b.push(i>>6|192,63&i|128)}else if(i<65536){if((r-=3)<0)break;b.push(i>>12|224,i>>6&63|128,63&i|128)}else{if(!(i<1114112))throw new Error("Invalid code point");if((r-=4)<0)break;b.push(i>>18|240,i>>12&63|128,i>>6&63|128,63&i|128)}}return b}function bt(a){return ce.toByteArray(function Ye(a){if((a=(a=a.split("=")[0]).trim().replace(nt,"")).length<2)return"";for(;a.length%4!=0;)a+="=";return a}(a))}function Oe(a,r,i,l){let d;for(d=0;d<l&&!(d+i>=r.length||d>=a.length);++d)r[d+i]=a[d];return d}function z(a,r){return a instanceof r||null!=a&&null!=a.constructor&&null!=a.constructor.name&&a.constructor.name===r.name}function Re(a){return a!=a}const an=function(){const a="0123456789abcdef",r=new Array(256);for(let i=0;i<16;++i){const l=16*i;for(let d=0;d<16;++d)r[l+d]=a[i]+a[d]}return r}();function ge(a){return typeof BigInt>"u"?un:a}function un(){throw new Error("BigInt not supported")}},8461:(lt,me)=>{me.read=function(Y,D,ce,Q,G){var T,O,j=8*G-Q-1,m=(1<<j)-1,re=m>>1,J=-7,W=ce?G-1:0,le=ce?-1:1,M=Y[D+W];for(W+=le,T=M&(1<<-J)-1,M>>=-J,J+=j;J>0;T=256*T+Y[D+W],W+=le,J-=8);for(O=T&(1<<-J)-1,T>>=-J,J+=Q;J>0;O=256*O+Y[D+W],W+=le,J-=8);if(0===T)T=1-re;else{if(T===m)return O?NaN:1/0*(M?-1:1);O+=Math.pow(2,Q),T-=re}return(M?-1:1)*O*Math.pow(2,T-Q)},me.write=function(Y,D,ce,Q,G,T){var O,j,m,re=8*T-G-1,J=(1<<re)-1,W=J>>1,le=23===G?Math.pow(2,-24)-Math.pow(2,-77):0,M=Q?0:T-1,$=Q?1:-1,V=D<0||0===D&&1/D<0?1:0;for(D=Math.abs(D),isNaN(D)||D===1/0?(j=isNaN(D)?1:0,O=J):(O=Math.floor(Math.log(D)/Math.LN2),D*(m=Math.pow(2,-O))<1&&(O--,m*=2),(D+=O+W>=1?le/m:le*Math.pow(2,1-W))*m>=2&&(O++,m/=2),O+W>=J?(j=0,O=J):O+W>=1?(j=(D*m-1)*Math.pow(2,G),O+=W):(j=D*Math.pow(2,W-1)*Math.pow(2,G),O=0));G>=8;Y[ce+M]=255&j,M+=$,j/=256,G-=8);for(O=O<<G|j,re+=G;re>0;Y[ce+M]=255&O,M+=$,O/=256,re-=8);Y[ce+M-$]|=128*V}},5861:(lt,me,Y)=>{"use strict";function D(Q,G,T,O,j,m,re){try{var J=Q[m](re),W=J.value}catch(le){return void T(le)}J.done?G(W):Promise.resolve(W).then(O,j)}function ce(Q){return function(){var G=this,T=arguments;return new Promise(function(O,j){var m=Q.apply(G,T);function re(W){D(m,O,j,re,J,"next",W)}function J(W){D(m,O,j,re,J,"throw",W)}re(void 0)})}}Y.d(me,{Z:()=>ce})}}]);